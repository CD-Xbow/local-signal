!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="ed7c1d92-4627-4f19-a8f7-d215aa6fd695",e._sentryDebugIdIdentifier="sentry-dbid-ed7c1d92-4627-4f19-a8f7-d215aa6fd695")}catch(e){}}(),(()=>{"use strict";var e,t,n,r={92770:(e,t,n)=>{n.d(t,{De:()=>s,PE:()=>r,a2:()=>o});const r={pixelsPerTick:.1,keyHeight:12,keyWidth:64,blackKeyWidthRatio:.64,rulerHeight:32},o=127,s=1/120},20910:(e,t,n)=>{n.d(t,{DA:()=>j,Fl:()=>y,IA:()=>g,PT:()=>b,fX:()=>p,hM:()=>v,j$:()=>x,s0:()=>w,vi:()=>k});var r=n(9680),o=n.n(r),s=n(15883),i=n(71229),a=n(95949),l=n(30876),c=n(20604),d=n(51046),u=n(59061),h=n(15738),m=n(68464);const g=()=>{const{song:{tracks:e},arrangeViewStore:t,arrangeViewStore:{quantizer:n}}=(0,u.g)();return(r,o)=>{t.selection=a.p.fromPoints(r,o,n,e.length)}},p=()=>{const{arrangeViewStore:e,song:{tracks:t}}=(0,u.g)();return()=>{const{selection:n}=e;n&&(e.selectedEventIds=function(e,t){const n={};for(let r=t.fromTrackIndex;r<t.toTrackIndex;r++){const o=e[r].events.filter((0,d.F)(i.Q.create(t.fromTick,t.toTick)));n[r]=o.map((e=>e.id))}return n}(t,n))}},x=()=>{const{arrangeViewStore:e,arrangeViewStore:{quantizer:t},song:{tracks:n}}=(0,u.g)(),r=f();return o=>{const{selection:s}=e;if(null===s)return;o={tick:t.round(o.tick),trackIndex:Math.round(o.trackIndex)},o=l.n.clamp(o,n.length-(s.toTrackIndex-s.fromTrackIndex));const i=l.n.sub(o,a.p.start(s));r(i)}},f=()=>{const{arrangeViewStore:e,song:{tracks:t}}=(0,u.g)();return n=>{if(null===e.selection)return;if(0===n.tick&&0===n.trackIndex)return;const r=a.p.moved(e.selection,n);e.selection=r;const o=[];for(const[r,s]of Object.entries(e.selectedEventIds)){const e=parseInt(r,10),i=t[e],a=s.map((e=>i.getEventById(e))).filter(c.EA);0===n.trackIndex?i.updateEvents(a.map((e=>({id:e.id,tick:e.tick+n.tick})))):o.push({sourceTrackIndex:e,destinationTrackIndex:e+n.trackIndex,events:a.map((e=>({...e,tick:e.tick+n.tick})))})}if(0!==n.trackIndex){const n={};for(const e of o){t[e.sourceTrackIndex].removeEvents(e.events.map((e=>e.id)));const r=t[e.destinationTrackIndex].addEvents(e.events);n[e.destinationTrackIndex]=r.map((e=>e.id))}e.selectedEventIds=n}}},v=()=>{const{arrangeViewStore:{selection:e,selectedEventIds:t},song:{tracks:n}}=(0,u.g)();return()=>{if(null===e)return;const r={type:"arrange_notes",notes:o()(t,((t,r)=>{const o=n[parseInt(r,10)];return t.map((e=>o.getEventById(e))).filter(c.EA).map((t=>({...t,tick:t.tick-e.fromTick})))})),selectedTrackIndex:e.fromTrackIndex};h.A.writeText(JSON.stringify(r))}},y=()=>{const{song:{tracks:e},player:t,arrangeViewStore:{selectedTrackIndex:n},pushHistory:r}=(0,u.g)();return()=>{const o=h.A.readText();if(!o||0===o.length)return;const i=JSON.parse(o);if((0,s.eF)(i)){r();for(const r in i.notes){const o=i.notes[r].map((e=>({...e,tick:e.tick+t.position}))),s=n<0?0:-i.selectedTrackIndex+n,a=parseInt(r)+s;a<e.length&&e[a].addEvents(o)}}}},j=()=>{const{arrangeViewStore:e,song:{tracks:t},pushHistory:n}=(0,u.g)();return()=>{n();for(const n in e.selectedEventIds)t[n].removeEvents(e.selectedEventIds[n]);e.selection=null,e.selectedEventIds=[]}},k=()=>{const{song:e,pushHistory:t,arrangeViewStore:{selectedEventIds:n}}=(0,u.g)();return r=>{t(),e.transposeNotes(r,n)}},b=()=>{const{song:{tracks:e},arrangeViewStore:t,arrangeViewStore:{selection:n,selectedEventIds:r},pushHistory:o}=(0,u.g)();return()=>{if(null===n)return;o();const s=n.toTick-n.fromTick,i={};for(const[t,n]of Object.entries(r)){const r=parseInt(t,10),o=e[r],a=n.map((e=>o.getEventById(e))).filter(c.EA),l=o.addEvents(a.map((e=>({...e,tick:e.tick+s}))));i[r]=l.map((e=>e.id))}t.selection={fromTick:n.fromTick+s,fromTrackIndex:n.fromTrackIndex,toTick:n.toTick+s,toTrackIndex:n.toTrackIndex},t.selectedEventIds=i}},w=()=>{const{arrangeViewStore:e,song:{tracks:t},pushHistory:n}=(0,u.g)();return r=>{const{selectedEventIds:o}=e;n();for(const[e,n]of Object.entries(o)){const o=parseInt(e,10),s=t[o];(0,m.a8)(s,n,r)}}}},11735:(e,t,n)=>{n.d(t,{GB:()=>d,Hd:()=>i,JN:()=>u,cx:()=>l,ps:()=>a,r3:()=>c});var r=n(92390),o=n(59061),s=n(96684);const i=()=>{const{cloudSongDataRepository:e}=(0,o.g)();return async t=>{const n=await e.get(t.songDataId),r=(0,s.fp)(n);return r.name=t.name,r.cloudSongId=t.id,r.cloudSongDataId=t.songDataId,r.isSaved=!0,r}},a=()=>{const{cloudSongRepository:e,cloudSongDataRepository:t}=(0,o.g)();return async n=>{const r=(0,s.KO)(n),o=await t.create({data:r}),i=await e.create({name:n.name,songDataId:o});n.cloudSongDataId=o,n.cloudSongId=i,n.isSaved=!0}},l=()=>{const{cloudSongRepository:e,cloudSongDataRepository:t}=(0,o.g)();return async n=>{if(null===n.cloudSongId||null===n.cloudSongDataId)throw new Error("This song is not loaded from the cloud");const r=(0,s.KO)(n);await e.update(n.cloudSongId,{name:n.name}),await t.update(n.cloudSongDataId,{data:r}),n.isSaved=!0}},c=()=>{const{cloudMidiRepository:e}=(0,o.g)();return async t=>{const n=await e.storeMidiFile(t),o=await e.get(n),i=(0,s.fp)(o);return i.name=(0,r.P)(t)??"",i.isSaved=!0,i}},d=()=>{const{cloudSongRepository:e,cloudSongDataRepository:t}=(0,o.g)();return async(n,r)=>{if(null===n.cloudSongId||null===n.cloudSongDataId)throw new Error("This song is not saved in the cloud");await t.publish(n.cloudSongDataId),await e.publish(n.cloudSongId,r)}},u=()=>{const{cloudSongRepository:e,cloudSongDataRepository:t}=(0,o.g)();return async n=>{if(null===n.cloudSongId||null===n.cloudSongDataId)throw new Error("This song is not loaded from the cloud");await t.unpublish(n.cloudSongDataId),await e.unpublish(n.cloudSongId)}}},68278:(e,t,n)=>{n.d(t,{$H:()=>l,AT:()=>m,Ay:()=>c,SR:()=>d,mj:()=>h,yw:()=>u});var r=n(17243),o=n(15883),s=n(20604),i=n(59061),a=n(15738);const l=()=>{const{controlStore:{selectedEventIds:e,selectedTrack:t},player:n,pushHistory:r}=(0,i.g)();return o=>{if(void 0===t)return;r();const i=e.map((e=>t.getEventById(e))).filter(s.EA);i.length>0?i.forEach((e=>t.updateEvent(e.id,{value:o.value}))):t.createOrUpdate({...o,tick:n.position})}},c=()=>{const{controlStore:e,controlStore:{selectedEventIds:t,selectedTrack:n},pushHistory:r}=(0,i.g)();return()=>{void 0!==n&&0!==t.length&&(r(),n.removeEvents(t),e.selection=null)}},d=()=>{const{controlStore:e}=(0,i.g)();return()=>{e.selection=null,e.selectedEventIds=[]}},u=()=>{const{controlStore:{selectedEventIds:e,selectedTrack:t}}=(0,i.g)();return()=>{if(void 0===t||0===e.length)return;const n=e.map((e=>t.getEventById(e))).filter(s.EA),o=(0,r.min)(n.map((e=>e.tick)));if(void 0===o)return;const i={type:"control_events",events:n.map((e=>({...e,tick:e.tick-o})))};a.A.writeText(JSON.stringify(i))}},h=()=>{const{pianoRollStore:{selectedTrack:e},player:t,pushHistory:n}=(0,i.g)();return()=>{if(void 0===e)return;const r=a.A.readText();if(!r||0===r.length)return;const s=JSON.parse(r);if(!(0,o.Np)(s))return;n();const i=s.events.map((e=>({...e,tick:e.tick+t.position})));e.transaction((e=>i.forEach((t=>e.createOrUpdate(t)))))}},m=()=>{const{controlStore:e,controlStore:{selectedEventIds:t,selectedTrack:n},pushHistory:o}=(0,i.g)();return()=>{if(void 0===n||0===t.length)return;o();const i=t.map((e=>n.getEventById(e))).filter(s.EA);let a=((0,r.maxBy)(i,(e=>e.tick))?.tick??0)-((0,r.minBy)(i,(e=>e.tick))?.tick??0);const l=i.map((e=>({...e,tick:e.tick+a}))),c=n.transaction((e=>l.map((t=>e.createOrUpdate(t)))));e.selectedEventIds=c.map((e=>e.id))}}},30201:(e,t,n)=>{n.d(t,{Id:()=>c,j8:()=>l,pp:()=>d});var r=n(1902),o=n(80406),s=n(30013),i=n(59061);const a=()=>new Promise((e=>window.requestAnimationFrame((()=>e())))),l=()=>{const{song:e,synth:t,exportStore:n}=(0,i.g)();return async()=>{const s=t.loadedSoundFontData;if(null!==s){n.isCanceled=!1,n.openExportProgressDialog=!0,n.progress=0;try{const t=await(0,r.b7)(s,e.allEvents,e.timebase,44100,{bufferSize:128,cancel:()=>n.isCanceled,waitForEventLoop:a,onProgress:(e,t)=>n.progress=e/t});n.progress=1;const i=u(n.exportMode),l=await i.encode(t),c=new Blob([l],{type:i.mimeType});n.openExportProgressDialog=!1,(0,o.W)(c,"song."+i.ext)}catch(e){console.warn(e)}}}},c=()=>{const{exportStore:e}=(0,i.g)();return()=>{e.isCanceled=!0}},d=e=>e.allEvents.some((e=>e.tick>=120)),u=e=>{switch(e){case"WAV":return{encode:s.l,ext:"wav",mimeType:"audio/wav"};case"MP3":return{encode:s.X,ext:"mp3",mimeType:"audio/mp3"}}}},13917:(e,t,n)=>{n.d(t,{OJ:()=>h,Ye:()=>l,c6:()=>m,mZ:()=>d,q5:()=>c,z6:()=>u});var r=n(92390),o=n(96684),s=n(94398),i=n(9034);const a="true"===new URL(window.location.href).searchParams.get("disableFileSystem"),l=("chooseFileSystemEntries"in window||"showOpenFilePicker"in window)&&!a,c=()=>{const e=(0,i.pC)();return async()=>{let t;try{t=(await window.showOpenFilePicker({types:[{description:"MIDI file",accept:{"audio/midi":[".mid"]}}]}))[0]}catch(e){if("AbortError"===e.name)return;const t="An error occured trying to open the file.";return console.error(t,e),void alert(t)}const n=await t.getFile(),r=await d(n);r.fileHandle=t,e(r)}},d=async e=>u(await e.arrayBuffer(),"path"in e?e.path:void 0,e.name),u=(e,t,n)=>{const s=(0,o.fp)(new Uint8Array(e)),i=t??n;return 0===s.name.length&&i&&(s.name=(0,r.P)(i)?.replace(/\.[^/.]+$/,"")??""),t&&(s.filepath=t),s.isSaved=!0,s},h=async e=>{const t=e.fileHandle;if(null===t)return void await m(e);const n=(0,o.KO)(e).buffer;try{await(0,s._)(t,n),e.isSaved=!0}catch(e){console.error(e),alert("unable to save file")}},m=async e=>{let t;try{t=await window.showSaveFilePicker({types:[{description:"MIDI file",accept:{"audio/midi":[".mid"]}}]})}catch(e){if("AbortError"===e.name)return;const t="An error occured trying to open the file.";return console.error(t,e),void alert(t)}try{const n=(0,o.KO)(e).buffer;await(0,s._)(t,n),e.isSaved=!0,e.fileHandle=t}catch(e){const t="Unable to save file.";return console.error(t,e),void alert(t)}}},72083:(e,t,n)=>{n.d(t,{Yw:()=>s,cN:()=>i,kT:()=>o});var r=n(59061);const o=()=>{const{historyStore:e}=(0,r.g)();return()=>e.push()},s=()=>{const{historyStore:e}=(0,r.g)();return()=>e.undo()},i=()=>{const{historyStore:e}=(0,r.g)();return()=>e.redo()}},57925:(e,t,n)=>{n.d(t,{i5:()=>d,iW:()=>h,vB:()=>u});var r=n(50119),o=n(68278),s=n(15883),i=n(59061),a=n(15738),l=n(20910),c=n(87188);const d=()=>{const{router:e,pianoRollStore:t,controlStore:n}=(0,i.g)(),s=(0,r.ti)(),a=(0,l.hM)(),d=(0,c.av)(),u=(0,o.yw)();return()=>{switch(e.path){case"/track":t.selectedNoteIds.length>0?s():n.selectedEventIds.length>0&&u();break;case"/arrange":a();break;case"/tempo":d()}}},u=()=>{const{router:e,pianoRollStore:t,controlStore:n}=(0,i.g)(),s=(0,r.ti)(),a=(0,r.Rb)(),d=(0,l.hM)(),u=(0,l.DA)(),h=(0,c.av)(),m=(0,c._C)(),g=(0,o.yw)(),p=(0,o.Ay)();return()=>{switch(e.path){case"/track":t.selectedNoteIds.length>0?(s(),a()):n.selectedEventIds.length>0&&(g(),p());break;case"/arrange":d(),u();break;case"/tempo":h(),m()}}},h=()=>{const{router:e}=(0,i.g)(),t=(0,r.Nl)(),n=(0,l.Fl)(),d=(0,c.e)(),u=(0,o.mj)();return()=>{switch(e.path){case"/track":const e=a.A.readText();if(!e||0===e.length)return;const r=JSON.parse(e);(0,s.dn)(r)?t():(0,s.Np)(r)&&u();break;case"/arrange":n();break;case"/tempo":d()}}}},50119:(e,t,n)=>{n.d(t,{$8:()=>c.$8,AF:()=>a.AF,Ay:()=>d.A,C4:()=>c.C4,DA:()=>r.DA,Fl:()=>r.Fl,Fv:()=>s.Fv,IA:()=>r.IA,Id:()=>o.Id,J1:()=>a.J1,J2:()=>c.J2,L$:()=>a.L$,LR:()=>a.LR,Mv:()=>l.Mv,Nl:()=>a.Nl,PT:()=>r.PT,Qm:()=>c.Qm,R8:()=>a.R8,Rb:()=>a.Rb,Sf:()=>c.Sf,Te:()=>c.Te,UI:()=>c.UI,Ut:()=>s.Ut,Vd:()=>l.Vd,W0:()=>c.W0,W3:()=>c.W3,XA:()=>a.XA,Yp:()=>s.Yp,Yr:()=>s.Yr,bO:()=>i.b,bS:()=>l.bS,cY:()=>c.cY,d0:()=>s.d0,eE:()=>a.eE,ed:()=>c.ed,fX:()=>r.fX,fm:()=>a.fm,gg:()=>l.gg,hM:()=>r.hM,i:()=>l.i,i5:()=>c.i5,j$:()=>r.j$,jX:()=>l.jX,k9:()=>l.k9,m$:()=>s.m$,mG:()=>s.mG,mg:()=>d.m,mv:()=>c.mv,pC:()=>l.pC,pp:()=>o.pp,ps:()=>l.ps,qo:()=>s.qo,rm:()=>c.rm,s0:()=>r.s0,sQ:()=>s.sQ,t3:()=>s.t3,ti:()=>a.ti,vi:()=>r.vi,z7:()=>a.z7});var r=n(20910),o=n(30201),s=n(21738),i=n(56400),a=n(14589),l=n(9034),c=n(68464),d=n(55753)},21738:(e,t,n)=>{n.d(t,{Fv:()=>m,Ut:()=>d,Yp:()=>c,Yr:()=>p,d0:()=>h,m$:()=>l,mG:()=>g,qo:()=>i,sQ:()=>a,t3:()=>u});var r=n(52188),o=n(59061),s=n(6358);const i=()=>{const{player:e,pianoRollStore:t}=(0,o.g)();return()=>{e.stop(),e.position=0,t.setScrollLeftInTicks(0)}},a=()=>{const{song:e,player:t,pianoRollStore:n}=(0,o.g)();return()=>{const o=r.t.getPreviousMeasureTick(e.measures,t.position,e.timebase);t.position=o,t.position<n.scrollLeftTicks&&n.setScrollLeftInTicks(t.position)}},l=()=>{const{song:e,player:t,pianoRollStore:n}=(0,o.g)();return()=>{const o=r.t.getNextMeasureTick(e.measures,t.position,e.timebase);t.position=o;const{transform:s,scrollLeft:i}=n,a=s.getX(t.position);a-i>.7*n.canvasWidth&&n.setScrollLeftInPixels(a-.7*n.canvasWidth)}},c=()=>{const{pianoRollStore:e,song:t}=(0,o.g)();return()=>{e.selectedTrackIndex=Math.min(e.selectedTrackIndex+1,t.tracks.length-1)}},d=()=>{const{pianoRollStore:e}=(0,o.g)();return()=>{e.selectedTrackIndex=Math.max(e.selectedTrackIndex-1,1)}},u=()=>{const{pianoRollStore:{selectedTrackId:e},trackMute:t}=(0,o.g)();return()=>{t.isSolo(e)?t.unsolo(e):t.solo(e)}},h=()=>{const{pianoRollStore:{selectedTrackId:e},trackMute:t}=(0,o.g)();return()=>{t.isMuted(e)?t.unmute(e):t.mute(e)}},m=()=>{const{pianoRollStore:{selectedTrackId:e},pianoRollStore:t}=(0,o.g)();return()=>{t.notGhostTrackIds.has(e)?t.notGhostTrackIds.delete(e):t.notGhostTrackIds.add(e)}},g=()=>{const{player:e,synthGroup:t}=(0,o.g)();return function(n){let{channel:r,noteNumber:o,velocity:i}=n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t.activate(),e.sendEvent((0,s.d1)(0,r,o,i),a)}},p=()=>{const{player:e}=(0,o.g)();return function(t){let{channel:n,noteNumber:r}=t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.sendEvent((0,s.dG)(0,n,r,0),o)}}},56400:(e,t,n)=>{n.d(t,{b:()=>o});var r=n(59061);const o=()=>{const{midiRecorder:e,player:t}=(0,r.g)();return()=>{e.isRecording?(e.isRecording=!1,t.stop()):(e.isRecording=!0,t.play())}}},14589:(e,t,n)=>{n.d(t,{AF:()=>T,J1:()=>C,L$:()=>y,LR:()=>w,Nl:()=>v,R8:()=>p,Rb:()=>f,XA:()=>m,eE:()=>j,fm:()=>g,ti:()=>x,z7:()=>S});var r=n(17243),o=n(15883),s=n(70480),i=n(40540),a=n(20604),l=n(26556),c=n(59061),d=n(15738),u=n(22095),h=n(21738);function m(e,t){const n={x:t.fromTick,width:t.toTick-t.fromTick,y:t.toNoteNumber,height:t.fromNoteNumber-t.toNoteNumber};return e.filter(u.Fb).filter((e=>s.r.intersects({x:e.tick,width:e.duration,y:e.noteNumber-1,height:1},n)))}const g=()=>{const{song:e,pianoRollStore:t,pianoRollStore:{selectedTrackIndex:n,selection:r,selectedNoteIds:o},pushHistory:s}=(0,c.g)();return a=>{if(s(),null!==r){const e=i.L.moved(r,0,a);t.selection=e}e.transposeNotes(a,{[n]:o})}},p=()=>{const{pianoRollStore:e,pianoRollStore:{selection:t,selectedNoteIds:n,selectedTrack:r}}=(0,c.g)();return()=>{if(void 0===r||null===t)return;const o=n.map((e=>r.getEventById(e))).filter(a.EA).map((e=>({...e})));r.addEvents(o),e.selectedNoteIds=o.map((e=>e.id))}},x=()=>{const{pianoRollStore:{selection:e,selectedNoteIds:t,selectedTrack:n}}=(0,c.g)();return()=>{if(void 0===n||0===t.length)return;const o=t.map((e=>n.getEventById(e))).filter(a.EA).filter(u.Fb),s=e?.fromTick??(0,r.min)(o.map((e=>e.tick))),i={type:"piano_notes",notes:o.map((e=>({...e,tick:e.tick-s})))};d.A.writeText(JSON.stringify(i))}},f=()=>{const{pianoRollStore:e,pianoRollStore:{selection:t,selectedNoteIds:n,selectedTrack:r},pushHistory:o}=(0,c.g)();return()=>{void 0===r||0===n.length&&null===t||(o(),r.removeEvents(n),e.selection=null,e.selectedNoteIds=[])}},v=()=>{const{player:{position:e},pianoRollStore:{selectedTrack:t},pushHistory:n}=(0,c.g)();return()=>{if(void 0===t)return;const r=d.A.readText();if(!r||0===r.length)return;const s=JSON.parse(r);if(!(0,o.dn)(s))return;n();const i=s.notes.map((t=>({...t,tick:Math.max(0,t.tick+e)})));t.addEvents(i)}},y=()=>{const{pianoRollStore:e,pianoRollStore:{selection:t,selectedNoteIds:n,selectedTrack:o},pushHistory:s}=(0,c.g)();return()=>{if(void 0===o||null===t||0===n.length)return;s();let l=t.toTick-t.fromTick;const c=n.map((e=>o.getEventById(e))).filter(a.EA).filter(u.Fb);if(0===l){const e=(0,r.min)(c.map((e=>e.tick)))??0,t=(0,r.max)(c.map((e=>e.tick+e.duration)))??0;l=t-e}const d=c.map((e=>({...e,tick:e.tick+l}))),h=o.addEvents(d);e.selection=i.L.moved(t,l,0),e.selectedNoteIds=h.map((e=>e.id))}},j=()=>{const{pianoRollStore:e,pianoRollStore:{selectedTrack:t},controlStore:n}=(0,c.g)();return r=>{void 0!==t&&(n.selectedEventIds=[],e.selectedNoteIds=[r])}},k=e=>e.filter(u.Fb).sort(((e,t)=>e.tick<t.tick?-1:e.tick>t.tick?1:e.noteNumber<t.noteNumber?-1:e.noteNumber>t.noteNumber?1:0)),b=()=>{const{pianoRollStore:{selectedTrack:e,selectedNoteIds:t},song:n}=(0,c.g)(),r=j(),o=(0,h.mG)(),s=(0,h.Yr)();return i=>{if(void 0===e||0===t.length)return;const c=e.events.filter(u.Fb),d=k(t.map((e=>c.find((t=>t.id===e)))).filter(a.EA));if(0===d.length)return;const h=e?.channel??0,m=k(d)[0],g=k(c),p=g.findIndex((e=>e.id===m.id)),x=g[p],f=g[p+i];void 0!==f&&(r(f.id),s({...x,channel:h}),o({...f,channel:h}),s({...f,channel:h},(0,l.bU)(f.duration,120,n.timebase)/1e3))}},w=()=>{const e=b();return()=>e(1)},S=()=>{const e=b();return()=>e(-1)},C=()=>{const{pianoRollStore:{selectedTrack:e,selectedNoteIds:t,enabledQuantizer:n},pushHistory:r}=(0,c.g)();return()=>{if(void 0===e||0===t.length)return;r();const o=t.map((t=>e.getEventById(t))).filter(a.EA).filter(u.Fb).map((e=>({...e,tick:n.round(e.tick)})));e.updateEvents(o)}},T=()=>{const{pianoRollStore:e,pianoRollStore:{selectedTrack:t}}=(0,c.g)();return()=>{t&&(e.selectedNoteIds=t.events.filter(u.Fb).map((e=>e.id)))}}},9034:(e,t,n)=>{n.d(t,{Mv:()=>x,Vd:()=>m,bS:()=>g,gg:()=>h,i:()=>p,jX:()=>u,k9:()=>d,pC:()=>l,ps:()=>c});var r=n(59061),o=n(96684),s=n(35521),i=n(22095),a=n(13917);const l=()=>{const{songStore:e,trackMute:t,pianoRollStore:n,player:o,historyStore:s,arrangeViewStore:a}=(0,r.g)();return r=>{e.song=r,t.reset(),n.setScrollLeftInPixels(0),n.notGhostTrackIds=new Set,n.showTrackList=!0,n.selection=null,n.selectedNoteIds=[],n.selectedTrackId=r.tracks.find((e=>!e.isConductorTrack))?.id??i.ql,a.selection=null,a.selectedEventIds=[],s.clear(),o.stop(),o.reset(),o.position=0}},c=()=>{const e=l();return()=>e((0,s.p)())},d=()=>{const{song:e}=(0,r.g)();return()=>{e.isSaved=!0,(0,o.FI)(e)}},u=()=>{const e=l();return async t=>{const n=await(async e=>{if(null===e.files||0===e.files.length)return Promise.resolve(null);const t=e.files[0];return await(0,a.mZ)(t)})(t);null!==n&&e(n)}},h=()=>{const{song:e,pushHistory:t}=(0,r.g)();return()=>{t(),e.addTrack((0,i.BQ)(Math.min(e.tracks.length-1,15)))}},m=()=>{const{song:e,pianoRollStore:t,arrangeViewStore:n,pushHistory:o}=(0,r.g)();return r=>{if(e.tracks.filter((e=>!e.isConductorTrack)).length<=1)return;o();const s=t.selectedTrackIndex,i=n.selectedTrackIndex;e.removeTrack(r),t.selectedTrackIndex=Math.min(s,e.tracks.length-1),n.selectedTrackIndex=Math.min(i,e.tracks.length-1)}},g=()=>{const{pianoRollStore:e}=(0,r.g)();return t=>{e.selectedTrackId=t}},p=()=>{const{song:e,pushHistory:t}=(0,r.g)();return n=>{t(),e.insertTrack((0,i.BQ)(e.tracks.length-1),n)}},x=()=>{const{song:e,pushHistory:t}=(0,r.g)();return n=>{const r=e.getTrack(n);if(void 0===r)throw new Error("No track found");const o=e.tracks.findIndex((e=>e.id===n)),s=r.clone();s.channel=void 0,t(),e.insertTrack(s,o+1)}}},87188:(e,t,n)=>{n.d(t,{GZ:()=>m,Gm:()=>d,_C:()=>c,av:()=>u,e:()=>h});var r=n(17243),o=n(15883),s=n(20604),i=n(59061),a=n(15738),l=n(22095);const c=()=>{const{song:{conductorTrack:e},tempoEditorStore:t,tempoEditorStore:{selectedEventIds:n},pushHistory:r}=(0,i.g)();return()=>{void 0!==e&&0!==n.length&&(r(),e.removeEvents(n),t.selection=null)}},d=()=>{const{tempoEditorStore:e}=(0,i.g)();return()=>{e.selection=null,e.selectedEventIds=[]}},u=()=>{const{song:{conductorTrack:e},tempoEditorStore:{selectedEventIds:t}}=(0,i.g)();return()=>{if(void 0===e||0===t.length)return;const n=t.map((t=>e.getEventById(t))).filter(s.EA).filter(l.u3),o=(0,r.min)(n.map((e=>e.tick)));if(void 0===o)return;const i={type:"tempo_events",events:n.map((e=>({...e,tick:e.tick-o})))};a.A.writeText(JSON.stringify(i))}},h=()=>{const{song:{conductorTrack:e},player:t,pushHistory:n}=(0,i.g)();return()=>{if(void 0===e)return;const r=a.A.readText();if(!r||0===r.length)return;const s=JSON.parse(r);if(!(0,o.dQ)(s))return;n();const i=s.events.map((e=>({...e,tick:e.tick+t.position})));e.transaction((e=>{i.forEach((t=>e.createOrUpdate(t)))}))}},m=()=>{const{song:{conductorTrack:e},tempoEditorStore:t,tempoEditorStore:{selectedEventIds:n},pushHistory:o}=(0,i.g)();return()=>{if(void 0===e||0===n.length)return;o();const i=n.map((t=>e.getEventById(t))).filter(s.EA);let a=((0,r.maxBy)(i,(e=>e.tick))?.tick??0)-((0,r.minBy)(i,(e=>e.tick))?.tick??0);const l=i.map((e=>({...e,tick:e.tick+a}))),c=e.transaction((e=>l.map((t=>e.createOrUpdate(t)))));t.selectedEventIds=c.map((e=>e.id))}}},68464:(e,t,n)=>{n.d(t,{$8:()=>f,C4:()=>w,J2:()=>v,Qm:()=>T,Sf:()=>m,Te:()=>h,UI:()=>S,W0:()=>g,W3:()=>k,a8:()=>C,cY:()=>p,ed:()=>y,i5:()=>b,mv:()=>j,rm:()=>x});var r=n(17243),o=n(29909),s=n(71229),i=n(52188),a=n(20604),l=n(51046),c=n(59061),d=n(6358),u=n(22095);n(21738);const h=()=>{const{song:e,pushHistory:t}=(0,c.g)();return(n,r)=>{const o=e.conductorTrack;void 0!==o&&(t(),o.updateEvent(n,{microsecondsPerBeat:r}))}},m=()=>{const{pianoRollStore:e,pushHistory:t}=(0,c.g)();return(n,r)=>{const{selectedTrack:o}=e;void 0!==o&&(t(),o.updateEvents(n.map((e=>({id:e,velocity:r})))),e.newNoteVelocity=r)}},g=()=>{const{player:e,pianoRollStore:t,pushHistory:n}=(0,c.g)(),{quantizer:r,selectedTrack:o}=t;return(t,s)=>{if(void 0===o)throw new Error("selected track is undefined");n();const i=o.createOrUpdate({...t,tick:r.round(s??e.position)}).id;return void 0!==s&&e.sendEvent(t),i}},p=()=>{const{pianoRollStore:e}=(0,c.g)();return(t,n,r,o)=>{const{selectedTrack:i,selectedNoteIds:a}=e;if(void 0===i)return;const c=Math.min(t,r),d=Math.max(t,r),h=Math.min(n,o),m=Math.max(n,o),g=(a.length>0?a.map((e=>i.getEventById(e))):i.events.filter(u.Fb)).filter((0,l.F)(s.Q.create(c,d)));i.transaction((e=>{e.updateEvents(g.map((e=>{return{id:e.id,velocity:(s=e.tick,Math.floor(Math.min(m,Math.max(h,(s-t)/(r-t)*(o-n)+n))))};var s})))}))}},x=(e,t,n,r)=>(o,s,i,l)=>{if(void 0===e)throw new Error("track is undefined");const c=Math.min(i,l),d=Math.max(i,l),u=t.floor(Math.max(0,c)),h=t.floor(Math.max(0,d)),m=Math.min(o,s),g=Math.max(o,s),p=l===i?e=>s:e=>Math.floor(Math.min(g,Math.max(m,(e-i)/(l-i)*(s-o)+o))),x=e.events.filter(n).filter((e=>e.tick!==i&&e.tick>=Math.min(c,u)&&e.tick<=Math.max(d,h)));e.transaction((e=>{e.removeEvents(x.map((e=>e.id)));const n=(0,a.Q6)(u,h,t.unit).map((e=>({...r(p(e)),tick:e})));e.addEvents(n)}))},f=()=>{const{pianoRollStore:e}=(0,c.g)();return t=>x(e.selectedTrack,e.quantizer,o.a.getEventPredicate(t),o.a.getEventFactory(t))},v=()=>{const{song:e,player:t,pushHistory:n}=(0,c.g)();return(r,o)=>{n();const s=e.getTrack(r);void 0!==s&&(s.setVolume(o,t.position),void 0!==s.channel&&t.sendEvent((0,d.E0)(0,s.channel,o)))}},y=()=>{const{song:e,player:t,pushHistory:n}=(0,c.g)();return(r,o)=>{n();const s=e.getTrack(r);void 0!==s&&(s.setPan(o,t.position),void 0!==s.channel&&t.sendEvent((0,d.t3)(0,s.channel,o)))}},j=()=>{const{song:e,player:t,pushHistory:n}=(0,c.g)();return(r,o)=>{n();const s=e.getTrack(r);void 0!==s&&(s.setProgramNumber(o),void 0!==s.channel&&t.sendEvent((0,d.Ch)(0,s.channel,o)))}},k=()=>{const{pianoRollStore:e,pushHistory:t}=(0,c.g)();return n=>{t(),e.notGhostTrackIds.has(n)?e.notGhostTrackIds.delete(n):e.notGhostTrackIds.add(n)}},b=()=>{const{song:e,pianoRollStore:t,pushHistory:n}=(0,c.g)();return()=>{if(n(),t.notGhostTrackIds.size>Math.floor(e.tracks.length/2))t.notGhostTrackIds=new Set;else for(const n of e.tracks)t.notGhostTrackIds.add(n.id)}},w=()=>{const{song:e,pushHistory:t}=(0,c.g)();return(n,r,o)=>{const s=i.t.getMeasureStart(e.measures,n,e.timebase).tick;e.timeSignatures?.some((e=>e.tick===s))||(t(),e.conductorTrack?.addEvent({...(0,d.BQ)(0,r,o),tick:s}))}},S=()=>{const{song:e,pushHistory:t}=(0,c.g)();return(n,r,o)=>{t(),e.conductorTrack?.updateEvent(n,{numerator:r,denominator:o})}},C=(e,t,n)=>{const o=t.map((t=>e.getEventById(t))).filter(a.EA).filter(u.Fb);e.updateEvents(o.map((e=>({id:e.id,velocity:(0,r.clamp)(Math.floor(A(n,e.velocity)),0,127)}))))},T=()=>{const{pianoRollStore:e,pushHistory:t}=(0,c.g)(),{selectedTrack:n,selectedNoteIds:r}=e;return e=>{void 0!==n&&(t(),C(n,r,e))}},A=(e,t)=>{switch(e.type){case"set":return e.value;case"add":return t+e.value;case"multiply":return t*e.value}}},55753:(e,t,n)=>{n.d(t,{A:()=>s,m:()=>o});var r=n(59061);const o=()=>{const{song:e,trackMute:t,player:n}=(0,r.g)();return r=>{const o=e.getTrack(r)?.channel;void 0!==o&&(t.isMuted(r)?t.unmute(r):(t.mute(r),n.allSoundsOffChannel(o)))}},s=()=>{const{song:e,trackMute:t,player:n}=(0,r.g)();return r=>{const o=e.getTrack(r)?.channel;void 0!==o&&(t.isSolo(r)?(t.unsolo(r),n.allSoundsOffChannel(o)):(t.solo(r),n.allSoundsOffExclude(o)))}}},15883:(e,t,n)=>{n.d(t,{Np:()=>s,dQ:()=>i,dn:()=>r,eF:()=>o});const r=e=>"piano_notes"===e.type&&"notes"in e,o=e=>"arrange_notes"===e.type&&"notes"in e&&"selectedTrackIndex"in e,s=e=>"control_events"===e.type&&"events"in e,i=e=>"tempo_events"===e.type&&"events"in e},46685:(e,t,n)=>{n.d(t,{q:()=>k});var r=n(20994),o=n(63696),s=n(98914),i=n(87393),a=n(92234),l=n(59061),c=n(9111),d=n(21579),u=n(13546),h=n(73061),m=n(36020),g=n(59797),p=n(19144),x=n(77684),f=n(23945),v=n(30906),y=n(62540);const j=new c.A;function k(){return(0,y.jsx)(o.StrictMode,{children:(0,y.jsx)(l.P.Provider,{value:j,children:(0,y.jsx)(d.N,{children:(0,y.jsx)(s.vd,{children:(0,y.jsx)(r.tE,{component:x.y,children:(0,y.jsx)(r.sk,{component:h.X,children:(0,y.jsx)(r.Co,{component:i.n,children:(0,y.jsx)(r.Vx,{component:u.k,children:(0,y.jsxs)(v.$,{children:[(0,y.jsx)(m.n,{}),(0,y.jsx)(p.r,{}),(0,a.r)()&&(0,y.jsx)(f.q,{}),(0,y.jsx)(g.K,{})]})})})})})})})})})}},23945:(e,t,n)=>{n.d(t,{q:()=>v});var r=n(20994),o=n(17354),s=n(69229),i=n(63696),a=n(52932),l=n(50119),c=n(13917),d=n(72083),u=n(57925),h=n(2316),m=n(53416),g=n(59061),p=n(97233),x=n(96684),f=n(62540);const v=(0,s.PA)((()=>{const{songStore:e,authStore:t,exportStore:n,rootViewStore:s}=(0,g.g)(),v=(0,p.B2)(),y=(0,m.P)(),j=(0,h.R)(),k=(0,r.dj)(),b=(0,u.vB)(),w=(0,u.i5)(),S=(0,u.iW)(),C=(0,d.Yw)(),T=(0,d.cN)(),[A,E]=(0,i.useState)(!1),I=(0,l.pC)(),M=async()=>{const{song:t}=e;try{const e=await window.electronAPI.showSaveDialog();if(null===e)return;const{path:n}=e,r=(0,x.KO)(t).buffer;t.filepath=n,t.isSaved=!0,await window.electronAPI.saveFile(n,r),window.electronAPI.addRecentDocument(n)}catch(e){alert(e.message)}};return(0,i.useEffect)((()=>{const r=[window.electronAPI.onNewFile((async()=>{const{isLoggedIn:e}=t;e?await j.createNewSong():await y.createNewSong()})),window.electronAPI.onClickOpenFile((async()=>{const{isLoggedIn:n}=t;if(n)await j.openSong();else{const{song:t}=e;try{if(t.isSaved||confirm(v["confirm-open"])){const e=await window.electronAPI.showOpenDialog();if(null===e)return;const{path:t,content:n}=e,r=(0,c.z6)(n,t);I(r),window.electronAPI.addRecentDocument(t)}}catch(e){alert(e.message)}}})),window.electronAPI.onOpenFile((async t=>{let{filePath:n}=t;const{song:r}=e;try{if(r.isSaved||confirm(v["confirm-open"])){const e=await window.electronAPI.readFile(n),t=(0,c.z6)(e,n);I(t),window.electronAPI.addRecentDocument(n)}}catch(e){alert(e.message)}})),window.electronAPI.onSaveFile((async()=>{const{isLoggedIn:n}=t,{song:r}=e;if(n)await j.saveSong();else try{if(r.filepath){const t=(0,x.KO)(e.song).buffer;await window.electronAPI.saveFile(r.filepath,t),r.isSaved=!0}else await M()}catch(e){alert(e.message)}})),window.electronAPI.onSaveFileAs((async()=>{const{isLoggedIn:e}=t;e?await j.saveAsSong():await M()})),window.electronAPI.onRename((async()=>{await j.renameSong()})),window.electronAPI.onImport((async()=>{await j.importSong()})),window.electronAPI.onExportWav((()=>{n.openExportDialog=!0})),window.electronAPI.onUndo((()=>{C()})),window.electronAPI.onRedo((()=>{T()})),window.electronAPI.onCut((()=>{b()})),window.electronAPI.onCopy((()=>{w()})),window.electronAPI.onPaste((()=>{S()})),window.electronAPI.onOpenSetting((()=>{s.openSettingDialog=!0})),window.electronAPI.onOpenHelp((()=>{s.openHelp=!0})),window.electronAPI.onBrowserSignInCompleted((async e=>{let{credential:t}=e;const n=function(e){switch(e.providerId){case"google.com":return o.HF.credential(e.idToken,e.accessToken);case"github.com":return o.Dt.credential(e.accessToken);case"apple.com":return new o.LD("apple.com").credential({idToken:e.idToken,accessToken:e.accessToken});default:throw new Error("Invalid provider")}}(t);try{await(0,o.eN)(a.j2,n)}catch(e){k.error("Failed to sign in")}}))];return A||(E(!0),window.electronAPI.ready()),()=>{r.forEach((e=>e()))}}),[A,b,w,S,T,C]),(0,f.jsx)(f.Fragment,{})}))},30906:(e,t,n)=>{n.d(t,{$:()=>a});var r=n(69229),o=n(59061),s=n(97233),i=n(62540);const a=(0,r.PA)((e=>{let{children:t}=e;const{settingStore:n}=(0,o.g)();return(0,i.jsx)(s.xt.Provider,{value:{language:n.language},children:t})}))},14908:(e,t,n)=>{n.d(t,{p:()=>l});var r=n(69229),o=n(63696),s=n(59061),i=n(76600),a=n(62540);const l=(0,r.PA)((()=>{const{arrangeViewStore:e}=(0,s.g)(),{autoScroll:t}=e,n=(0,o.useCallback)((()=>e.autoScroll=!e.autoScroll),[e]);return(0,a.jsx)(i.X,{onClick:n,selected:t})}))},91936:(e,t,n)=>{n.d(t,{t:()=>l});var r=n(69229),o=n(63696),s=n(59061),i=n(16051),a=n(62540);const l=(0,r.PA)((()=>{const{arrangeViewStore:e}=(0,s.g)(),{quantize:t}=e,n=(0,o.useCallback)((t=>e.quantize=t),[e]);return(0,a.jsx)(i.A,{value:t,enabled:!0,onSelect:n,onClickSwitch:()=>{}})}))},93185:(e,t,n)=>{n.d(t,{Y:()=>u});var r=n(46287),o=n(97233),s=n(99677),i=n(14908),a=n(91936),l=n(62540);const c=(0,r.A)("div",{target:"ek8cff31"})({name:"o5zuj0",styles:"font-weight:bold;font-size:1rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:14rem;min-width:3em;margin-left:0.5rem"}),d=(0,r.A)("div",{target:"ek8cff30"})({name:"1ff36h2",styles:"flex-grow:1"}),u=()=>(0,l.jsxs)(s.M,{children:[(0,l.jsx)(c,{children:(0,l.jsx)(o.Oj,{name:"arrangement-view"})}),(0,l.jsx)(d,{}),(0,l.jsx)(a.t,{}),(0,l.jsx)(i.p,{})]})},58124:(e,t,n)=>{n.d(t,{z:()=>h});var r=n(69229),o=n(63696),s=n(50119),i=n(59061),a=n(69673),l=n(97233),c=n(5909),d=n(94724),u=n(62540);const h=(0,r.PA)((e=>{const{handleClose:t}=e,{arrangeViewStore:n}=(0,i.g)(),r=(0,s.hM)(),h=(0,s.DA)(),m=(0,s.Fl)(),g=(0,s.PT)(),p=(0,s.vi)(),x=Object.values(n.selectedEventIds).some((e=>e.length>0)),f=(0,o.useCallback)((()=>{n.openVelocityDialog=!0,t()}),[n]);return(0,u.jsxs)(c.t,{...e,children:[(0,u.jsxs)(d.Dr,{onClick:e=>{e.stopPropagation(),t(),r(),h()},disabled:!x,children:[(0,u.jsx)(l.Oj,{name:"cut"}),(0,u.jsxs)(c.Z,{children:[a.t.cmdOrCtrl,"+X"]})]}),(0,u.jsxs)(d.Dr,{onClick:e=>{e.stopPropagation(),t(),r()},disabled:!x,children:[(0,u.jsx)(l.Oj,{name:"copy"}),(0,u.jsxs)(c.Z,{children:[a.t.cmdOrCtrl,"+C"]})]}),(0,u.jsxs)(d.Dr,{onClick:e=>{e.stopPropagation(),t(),m()},children:[(0,u.jsx)(l.Oj,{name:"paste"}),(0,u.jsxs)(c.Z,{children:[a.t.cmdOrCtrl,"+V"]})]}),(0,u.jsxs)(d.Dr,{onClick:e=>{e.stopPropagation(),t(),g()},disabled:null===n.selection,children:[(0,u.jsx)(l.Oj,{name:"duplicate"}),(0,u.jsxs)(c.Z,{children:[a.t.cmdOrCtrl,"+D"]})]}),(0,u.jsxs)(d.Dr,{onClick:e=>{e.stopPropagation(),t(),h()},disabled:!x,children:[(0,u.jsx)(l.Oj,{name:"delete"}),(0,u.jsx)(c.Z,{children:"Del"})]}),(0,u.jsx)(d.Nj,{}),(0,u.jsx)(d.Dr,{onClick:e=>{e.stopPropagation(),t(),p(12)},disabled:!x,children:(0,u.jsx)(l.Oj,{name:"one-octave-up"})}),(0,u.jsx)(d.Dr,{onClick:e=>{e.stopPropagation(),t(),p(-12)},disabled:!x,children:(0,u.jsx)(l.Oj,{name:"one-octave-down"})}),(0,u.jsxs)(d.Dr,{onClick:e=>{e.stopPropagation(),t(),n.openTransposeDialog=!0},disabled:!x,children:[(0,u.jsx)(l.Oj,{name:"transpose"}),(0,u.jsx)(c.Z,{children:"T"})]}),(0,u.jsx)(d.Dr,{onClick:f,disabled:!x,children:(0,u.jsx)(l.Oj,{name:"velocity"})})]})}))},22573:(e,t,n)=>{n.d(t,{y:()=>u});var r=n(46287),o=n(93185),s=n(69552),i=n(71751),a=n(8567),l=n(31421),c=n(62540);const d=(0,r.A)("div",{target:"eujt7tr0"})({name:"9itxi",styles:"overflow:hidden;display:flex;flex-direction:column;flex-grow:1;position:relative"}),u=()=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(d,{children:[(0,c.jsx)(s.X,{}),(0,c.jsx)(o.Y,{}),(0,c.jsx)(l.y,{})]}),(0,c.jsx)(i.C,{}),(0,c.jsx)(a.I,{})]})},86881:(e,t,n)=>{n.d(t,{A:()=>d});var r=n(69229),o=n(50119),s=n(59061),i=n(97233),a=n(5909),l=n(94724),c=n(62540);const d=(0,r.PA)((e=>{const{handleClose:t}=e,{song:{tracks:n},arrangeViewStore:{selectedTrackIndex:r,selectedTrackId:d}}=(0,s.g)(),u=(0,o.i)(),h=(0,o.Vd)(),m=(0,o.Mv)();return(0,c.jsxs)(a.t,{...e,children:[(0,c.jsx)(l.Dr,{onClick:e=>{e.stopPropagation(),u(r+1),t()},children:(0,c.jsx)(i.Oj,{name:"add-track"})}),r>0&&n.length>2&&(0,c.jsx)(l.Dr,{onClick:e=>{e.stopPropagation(),h(d),t()},children:(0,c.jsx)(i.Oj,{name:"delete-track"})}),r>0&&(0,c.jsx)(l.Dr,{onClick:e=>{e.stopPropagation(),m(d),t()},children:(0,c.jsx)(i.Oj,{name:"duplicate-track"})})]})}))},31421:(e,t,n)=>{n.d(t,{y:()=>I});var r=n(46287),o=n(83785),s=n(96604),i=n.n(s),a=n(17243),l=n(69229),c=n(63696),d=n(92770),u=n(50119),h=n(25649),m=n(78439),g=n(59061),p=n(75710),x=n(8008),f=n(49422),v=n(20038),y=n(58124),j=n(86881),k=n(93975),b=n(43748),w=n(62540);const S=(0,r.A)("div",{target:"eyapa1q4"})("flex-grow:1;display:flex;flex-direction:row;position:relative;background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";overflow:hidden;"),C=(0,r.A)("div",{target:"eyapa1q3"})("position:absolute;left:0;top:0;width:100%;box-sizing:border-box;border-bottom:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";"),T=(0,r.A)("div",{target:"eyapa1q2"})("position:absolute;left:0;bottom:0;width:100%;background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";"),A=(0,r.A)("div",{target:"eyapa1q1"})("width:8rem;padding:0 0.5rem;box-sizing:border-box;display:flex;border-bottom:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";align-items:center;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;background-color:",(e=>{let{isSelected:t,theme:n}=e;return t?n.secondaryBackgroundColor:n.backgroundColor}),";"),E=(0,r.A)("div",{target:"eyapa1q0"})("position:relative;border-right:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";"),I=(0,l.PA)((()=>{const{arrangeViewStore:e,arrangeViewStore:{trackHeight:t,contentWidth:n,contentHeight:r,transform:s,scrollLeft:l,scrollTop:I,scrollBy:M,selectedTrackIndex:O},player:P,router:D,song:{tracks:N}}=(0,g.g)(),R=(0,u.bS)(),z=(0,b.T)(),L=(0,c.useRef)(null),B=i()(L),F=(0,c.useCallback)((t=>{e.setScrollLeftInPixels(t),e.autoScroll=!1}),[]),H=(0,c.useCallback)((t=>e.setScrollTop(t)),[]),W=B.width,_=(0,o.u)();(0,c.useEffect)((()=>{e.canvasWidth=B.width}),[B.width]),(0,c.useEffect)((()=>{e.canvasHeight=B.height}),[B.height]);const K=(0,c.useCallback)((()=>e.scaleAroundPointX(.2,0)),[e]),V=(0,c.useCallback)((()=>e.scaleAroundPointX(-.2,0)),[e]),X=(0,c.useCallback)((()=>e.scaleX=1),[e]),Y=(0,c.useCallback)((()=>e.setScaleY(1.2*e.scaleY)),[e]),q=(0,c.useCallback)((()=>e.setScaleY(.8*e.scaleY)),[e]),G=(0,c.useCallback)((()=>e.setScaleY(1)),[e]),{onContextMenu:U,menuProps:$}=(0,m.E)(),{onContextMenu:Z,menuProps:Q}=(0,m.E)(),J=(0,c.useCallback)((t=>{if(t.shiftKey&&(t.altKey||t.ctrlKey)){let n=(0,h.T)(t.nativeEvent)?.02*t.deltaY:.01*t.deltaX;n=(0,a.clamp)(n,-.15,.15),e.setScaleY(e.scaleY*(1+n))}else if(t.altKey||t.ctrlKey){const n=(0,h.T)(t.nativeEvent)?.01:-.01,r=(0,a.clamp)(t.deltaY*n,-.15,.15);e.scaleAroundPointX(r,t.nativeEvent.offsetX)}else{const n=(0,h.T)(t.nativeEvent)?1:20*s.pixelsPerKey*d.De,r=t.deltaY*n;e.scrollBy(-t.deltaX,-r)}}),[e,M]);return(0,w.jsxs)(S,{children:[(0,w.jsxs)(E,{children:[(0,w.jsx)("div",{style:{marginTop:d.PE.rulerHeight,transform:`translateY(${-I}px)`},children:N.map(((n,r)=>(0,w.jsx)(A,{style:{height:t},isSelected:r===O,onClick:()=>e.selectedTrackIndex=r,onDoubleClick:()=>{return e=n.id,D.pushTrack(),void R(e);var e},onContextMenu:t=>{e.selectedTrackIndex=r,Z(t)},children:(0,w.jsx)(x.x,{track:n})},r)))}),(0,w.jsx)(T,{style:{height:v.ZW}})]}),(0,w.jsx)(C,{style:{height:d.PE.rulerHeight}}),(0,w.jsxs)("div",{style:{display:"flex",flexGrow:1,flexDirection:"column",position:"relative",overflow:"hidden"},children:[(0,w.jsxs)("div",{ref:L,onWheel:J,style:{display:"flex",flexGrow:1,flexDirection:"column",position:"relative",overflow:"hidden",background:_.darkBackgroundColor},children:[(0,w.jsx)(p.A,{rulerStore:e.rulerStore,...z,style:{background:_.backgroundColor,borderBottom:`1px solid ${_.dividerColor}`,boxSizing:"border-box"}}),(0,w.jsx)(k.G,{width:W,onContextMenu:U})]}),(0,w.jsx)("div",{style:{width:`calc(100% - ${v.ZW}px)`,position:"absolute",bottom:0},children:(0,w.jsx)(f.j,{scrollOffset:l,contentLength:n,onScroll:F,onClickScaleUp:K,onClickScaleDown:V,onClickScaleReset:X})})]}),(0,w.jsx)("div",{style:{height:`calc(100% - ${v.ZW}px)`,position:"absolute",top:0,right:0},children:(0,w.jsx)(f.J,{scrollOffset:I,contentLength:r+d.PE.rulerHeight,onScroll:H,onClickScaleUp:Y,onClickScaleDown:q,onClickScaleReset:G})}),(0,w.jsx)("div",{style:{width:v.ZW,height:v.ZW,position:"absolute",bottom:0,right:0,background:_.backgroundColor}}),(0,w.jsx)(y.z,{...$}),(0,w.jsx)(j.A,{...Q})]})}))},93975:(e,t,n)=>{n.d(t,{G:()=>f});var r=n(83785),o=n(47547),s=n(69229),i=n(63696),a=n(28632),l=n(59061),c=n(51618),d=n(98423),u=n(31563),h=n(2697),m=n(70351),g=n(91394),p=n(35487),x=n(62540);const f=(0,s.PA)((e=>{let{width:t,onContextMenu:n}=e;const{arrangeViewStore:{scrollLeft:s,scrollTop:f,contentHeight:v,rulerStore:{beats:y},cursorX:j,selectionRect:k}}=(0,l.g)(),b=(0,r.u)(),w=(0,p.n)(),S=(0,g.c)(),C=(0,i.useMemo)((()=>(0,a.L)(-s,0)),[s]),T=(0,i.useMemo)((()=>(0,a.L)(0,-f)),[f]),A=(0,i.useMemo)((()=>(0,a.L)(-s,-f)),[s,f]),E=(0,i.useCallback)((e=>{switch(e.button){case 0:w.onMouseDown(e);break;case 1:S.onMouseDown(e);break;case 2:n(e)}}),[w,S,n]);return(0,x.jsxs)(o.om,{width:t,height:v,onMouseDown:E,onContextMenu:(0,i.useCallback)((e=>e.preventDefault()),[]),style:{backgroundColor:b.editorBackgroundColor},children:[(0,x.jsx)(o.dL,{matrix:T,children:(0,x.jsx)(h.q,{width:t,zIndex:0})}),(0,x.jsxs)(o.dL,{matrix:C,children:[(0,x.jsx)(c.g,{height:v,beats:y,zIndex:1}),(0,x.jsx)(d.b,{x:j,height:v,zIndex:4})]}),(0,x.jsxs)(o.dL,{matrix:A,children:[(0,x.jsx)(m.u,{zIndex:2}),(0,x.jsx)(u.L,{rect:k,zIndex:3})]})]})}))},2697:(e,t,n)=>{n.d(t,{q:()=>h});var r=n(83785),o=n(47547),s=n(44308),i=n.n(s),a=n(69229),l=n(63696),c=n(72343),d=n(59061),u=n(62540);const h=(0,a.PA)((e=>{let{width:t,zIndex:n}=e;const{song:{tracks:s},arrangeViewStore:{trackTransform:a}}=(0,d.g)(),h=(0,r.u)(),m=e=>({x:0,y:e,width:t,height:1}),g=(0,l.useMemo)((()=>s.map(((e,t)=>a.getY(t+1)-1)).map(m)),[s.length,t,a]),p=(0,c.B)(i()(h.dividerColor));return(0,u.jsx)(o.FX,{rects:g,color:p,zIndex:n})}))},70351:(e,t,n)=>{n.d(t,{u:()=>u});var r=n(83785),o=n(47547),s=n(44308),i=n.n(s),a=n(69229),l=n(72343),c=n(59061),d=n(62540);const u=(0,a.PA)((e=>{let{zIndex:t}=e;const{arrangeViewStore:{notes:n}}=(0,c.g)(),s=(0,r.u)();return(0,d.jsx)(o.FX,{rects:n,color:(0,l.B)(i()(s.themeColor)),zIndex:t})}))},99503:(e,t,n)=>{n.d(t,{r:()=>l});var r=n(50119),o=n(51382),s=n(12968),i=n(54015),a=n(59061);const l=()=>{const{player:e,arrangeViewStore:t,arrangeViewStore:{trackTransform:n}}=(0,a.g)(),l=(0,r.fX)(),c=(0,r.IA)();return{onMouseDown(r,a,d){const u=n.getArrangePoint(d);t.resetSelection(),e.isPlaying||(e.position=t.quantizer.round(u.tick)),t.selectedTrackIndex=Math.floor(u.trackIndex),(0,i.b)({onMouseMove:e=>{const t=o.b.sub((0,s.i)(e),a),r=o.b.add(d,t);c(u,n.getArrangePoint(r))},onMouseUp:e=>{l()}})}}}},91394:(e,t,n)=>{n.d(t,{c:()=>a});var r=n(63696),o=n(51382),s=n(54015),i=n(59061);const a=()=>{const{arrangeViewStore:e,arrangeViewStore:{scrollLeft:t,scrollTop:n}}=(0,i.g)(),a=(0,r.useCallback)((t=>{e.setScrollLeftInPixels(t),e.autoScroll=!1}),[]),l=(0,r.useCallback)((t=>e.setScrollTop(t)),[]);return{onMouseDown:(0,r.useCallback)((e=>{function r(e){return{x:e.clientX,y:e.clientY}}const i=r(e.nativeEvent);(0,s.b)({onMouseMove(e){const s=r(e),c=o.b.sub(s,i);a(Math.max(0,t-c.x)),l(Math.max(0,n-c.y))}})}),[t,n,a,l])}}},36782:(e,t,n)=>{n.d(t,{C:()=>l});var r=n(50119),o=n(51382),s=n(12968),i=n(54015),a=n(59061);const l=()=>{const{pushHistory:e,arrangeViewStore:{trackTransform:t}}=(0,a.g)(),n=(0,r.j$)();return{onMouseDown(r,a,l){let c=!1;(0,i.b)({onMouseMove:r=>{const i=o.b.sub((0,s.i)(r),a),d=o.b.add(i,l);0===i.x&&0===i.y||c||(c=!0,e()),n(t.getArrangePoint(d))}})}}}},35487:(e,t,n)=>{n.d(t,{n:()=>c});var r=n(63696),o=n(70480),s=n(12968),i=n(59061),a=n(99503),l=n(36782);const c=()=>{const{arrangeViewStore:{scrollLeft:e,scrollTop:t,selectionRect:n}}=(0,i.g)(),c=(0,l.C)(),d=(0,a.r)();return{onMouseDown:(0,r.useCallback)((r=>{const i={x:r.nativeEvent.offsetX+e,y:r.nativeEvent.offsetY+t},a=(0,s.i)(r.nativeEvent);null!=n&&o.r.containsPoint(n,i)?c.onMouseDown(r,a,n):d.onMouseDown(r,a,i)}),[n,e,t,c,d])}}},43748:(e,t,n)=>{n.d(t,{T:()=>c});var r=n(63696),o=n(50119),s=n(51382),i=n(12968),a=n(54015),l=n(59061);const c=()=>{const{arrangeViewStore:e,song:{tracks:t}}=(0,l.g)(),n=(0,o.IA)(),c=(0,o.fX)();return{onMouseDown:(0,r.useCallback)((r=>{if(0!==r.button||r.ctrlKey||r.altKey)return;const{scrollLeft:o,scrollTop:l,trackTransform:d}=e,u={x:r.nativeEvent.offsetX+o,y:r.nativeEvent.offsetY+l},h=(0,i.i)(r.nativeEvent),m={tick:d.getTick(u.x),trackIndex:0};e.resetSelection(),(0,a.b)({onMouseMove:e=>{const r=s.b.sub((0,i.i)(e),h),o=s.b.add(u,r),a={tick:d.getTick(o.x),trackIndex:t.length};n(m,a)},onMouseUp:()=>{c()}})}),[e,n,c,t])}}},18976:(e,t,n)=>{n.d(t,{j:()=>o}),n(46287),n(63696);var r=n(62540);const o=()=>(0,r.jsx)(r.Fragment,{})},73245:(e,t,n)=>{n.d(t,{Y:()=>u});var r=n(69229),o=n(63696),s=n(59061),i=n(97233),a=n(66459),l=n(5513),c=n(43185),d=n(62540);const u=(0,r.PA)((()=>{const{rootViewStore:e,rootViewStore:{openCloudFileDialog:t}}=(0,s.g)(),n=(0,o.useCallback)((()=>e.openCloudFileDialog=!1),[e]);return(0,d.jsxs)(a.lG,{open:t,onOpenChange:n,style:{minWidth:"30rem"},children:[(0,d.jsx)(a.L3,{children:(0,d.jsx)(i.Oj,{name:"files"})}),(0,d.jsx)(a.Cf,{children:(0,d.jsx)(c.o,{})}),(0,d.jsx)(a.ii,{children:(0,d.jsx)(l.$,{onClick:n,children:(0,d.jsx)(i.Oj,{name:"close"})})})]})}))},43185:(e,t,n)=>{n.d(t,{o:()=>D});var r=n(46287),o=n(83785),s=n(20994),i=n(599),a=n.n(i),l=n(10716),c=n.n(l),d=n(64122),u=n.n(d),h=n(69229),m=n(63696),g=n(50119),p=n(11735),x=n(59061),f=n(97233),v=n(571),y=n(13906),j=n(94724),k=n(44201),b=n(62540);const w=(0,r.A)(u(),{target:"eyexlqs8"})({name:"10s1w75",styles:"width:1.1rem;height:1.1rem"}),S=(0,r.A)(a(),{target:"eyexlqs7"})({name:"10s1w75",styles:"width:1.1rem;height:1.1rem"}),C=(0,r.A)("div",{target:"eyexlqs6"})("display:flex;align-items:center;background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";font-weight:",(e=>{let{isSelected:t}=e;return t?"bold":"normal"}),";cursor:pointer;padding:0 1rem;box-sizing:border-box;&:hover{background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";}"),T=(0,r.A)(C,{target:"eyexlqs5"})({name:"1ff36h2",styles:"flex-grow:1"}),A=(0,r.A)(C,{target:"eyexlqs4"})({name:"1qnyavj",styles:"width:12rem"}),E=(0,r.A)(C,{target:"eyexlqs3"})({name:"kf9j8v",styles:"width:4rem"}),I=(0,r.A)("div",{target:"eyexlqs2"})("max-height:20rem;overflow-y:auto;tr:hover td{background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";}"),M=e=>{let{sortAscending:t}=e;return t?(0,b.jsx)(S,{}):(0,b.jsx)(w,{})},O=(0,r.A)("div",{target:"eyexlqs1"})(""),P=(0,r.A)("div",{target:"eyexlqs0"})({name:"71ye7u",styles:"display:flex;height:2.5rem"}),D=(0,h.PA)((()=>{const{cloudFileStore:e,rootViewStore:t}=(0,x.g)(),n=(0,g.pC)(),r=(0,p.Hd)(),i=(0,s.dj)(),a=(0,o.u)(),l=(0,f.B2)(),{isLoading:d,dateType:u,files:h,selectedColumn:w,sortAscending:S}=e;if((0,m.useEffect)((()=>{e.load()}),[]),d)return(0,b.jsx)(v.P,{});if(0===h.length)return(0,b.jsx)(f.Oj,{name:"no-files"});const C=(()=>{switch(u){case"created":return l["created-date"];case"updated":return l["modified-date"]}})();return(0,b.jsxs)(O,{children:[(0,b.jsxs)(P,{children:[(0,b.jsxs)(T,{onClick:()=>{"name"===e.selectedColumn?e.sortAscending=!e.sortAscending:e.selectedColumn="name"},isSelected:"name"===w,children:[(0,b.jsx)(f.Oj,{name:"name"}),(0,b.jsx)("div",{style:{width:"0.5rem"}}),"name"===w&&(0,b.jsx)(M,{sortAscending:S})]}),(0,b.jsxs)(A,{onClick:()=>{"date"===e.selectedColumn?e.sortAscending=!e.sortAscending:e.selectedColumn="date"},isSelected:"date"===w,children:[C,(0,b.jsxs)(j.W1,{trigger:(0,b.jsx)(y.K,{style:{marginLeft:"0.2em"},children:(0,b.jsx)(c(),{style:{fill:a.secondaryTextColor}})}),children:[(0,b.jsx)(j.Dr,{onClick:()=>e.dateType="created",children:(0,b.jsx)(f.Oj,{name:"created-date"})}),(0,b.jsx)(j.Dr,{onClick:()=>e.dateType="updated",children:(0,b.jsx)(f.Oj,{name:"modified-date"})})]}),"date"===w&&(0,b.jsx)(M,{sortAscending:S})]}),(0,b.jsx)(E,{})]}),(0,b.jsx)(I,{children:h.map((e=>(0,b.jsx)(k.W,{song:e,dateType:u,onClick:()=>(async e=>{try{const o=await r(e);n(o),t.openCloudFileDialog=!1}catch(e){i.error(e.message)}})(e)})))})]})}))},44201:(e,t,n)=>{n.d(t,{W:()=>j});var r=n(46287),o=n(83785),s=n(20994),i=n(66760),a=n.n(i),l=n(69229),c=n(59061),d=n(97233),u=n(13906),h=n(94724),m=n(62540);const g=(0,r.A)("div",{target:"evrkgu25"})("display:flex;cursor:pointer;height:2.5rem;overflow:hidden;&:hover{background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";}"),p=(0,r.A)("div",{target:"evrkgu24"})({name:"mlkjcc",styles:"display:flex;align-items:center;padding:0 1rem;box-sizing:border-box"}),x=(0,r.A)(p,{target:"evrkgu23"})({name:"1b3zlvp",styles:"overflow:hidden;flex-grow:1"}),f=(0,r.A)(p,{target:"evrkgu22"})({name:"s3dr32",styles:"width:12rem;flex-shrink:0"}),v=(0,r.A)(p,{target:"evrkgu21"})({name:"1l04w2j",styles:"width:4rem;flex-shrink:0"}),y=(0,r.A)("span",{target:"evrkgu20"})({name:"aj4kza",styles:"white-space:nowrap;text-overflow:ellipsis;overflow:hidden"}),j=(0,l.PA)((e=>{let{song:t,onClick:n,dateType:r}=e;const i=(0,o.u)(),l=(0,s.dj)(),p=(0,d.B2)(),{cloudFileStore:j}=(0,c.g)(),k=(()=>{switch(r){case"created":return t.createdAt;case"updated":return t.updatedAt}})(),b=t.name.length>0?t.name:p["untitled-song"],w=k.toLocaleDateString()+" "+k.toLocaleTimeString();return(0,m.jsxs)(g,{onClick:n,children:[(0,m.jsx)(x,{children:(0,m.jsx)(y,{children:b})}),(0,m.jsx)(f,{children:w}),(0,m.jsx)(v,{children:(0,m.jsx)(h.W1,{trigger:(0,m.jsx)(u.K,{style:{marginLeft:"0.2em"},children:(0,m.jsx)(a(),{style:{fill:i.secondaryTextColor}})}),children:(0,m.jsx)(h.Dr,{onClick:async e=>{e.stopPropagation();try{await j.deleteSong(t),l.info(p["song-deleted"])}catch(e){console.error(e),l.error(p["song-delete-failed"])}},children:(0,m.jsx)(d.Oj,{name:"delete"})})})})]})}))},89017:(e,t,n)=>{n.d(t,{s:()=>h});var r=n(46287),o=n(53649),s=n.n(o),i=n(97233),a=n(66459),l=n(5513),c=n(62540);const d=(0,r.A)("div",{target:"e1t7ob9n1"})("background-color:",(e=>{let{color:t}=e;return t}),";height:2rem;&:hover{z-index:2;box-shadow:0 0 0 2px white;}"),u=(0,r.A)("div",{target:"e1t7ob9n0"})("display:grid;padding:2px;grid-template-columns:repeat(",8,", 2rem);"),h=e=>{let{open:t,onSelect:n,onClose:r}=e;const o=e=>{n(e),r()},h=[-5,25,45,155,190,230,260,335],m=[65,55,39],g=s()(0,m.length).flatMap((e=>s()(0,h.length).map((t=>`hsl(\n          ${h[t].toFixed()}deg\n          70%\n          ${m[e].toFixed()}%\n        )`))));return(0,c.jsxs)(a.lG,{open:t,onOpenChange:r,children:[(0,c.jsx)(a.Cf,{children:(0,c.jsx)(u,{children:g.map((e=>(0,c.jsx)(d,{color:e,onClick:()=>o(e)},e)))})}),(0,c.jsxs)(a.ii,{children:[(0,c.jsx)(l.$,{onClick:()=>o(null),children:(0,c.jsx)(i.Oj,{name:"reset"})}),(0,c.jsx)(l.$,{onClick:r,children:(0,c.jsx)(i.Oj,{name:"close"})})]})]})}},5909:(e,t,n)=>{n.d(t,{Z:()=>a,t:()=>u});var r=n(46287),o=n(22538),s=n(63696),i=n(62540);const a=(0,r.A)("div",{target:"erver1d3"})("font-size:0.9em;flex-grow:1;text-align:right;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";margin-left:2em;"),l=(0,r.A)("div",{target:"erver1d2"})({name:"1a1cy4u",styles:"position:fixed;left:0;top:0;right:0;bottom:0"}),c=(0,r.A)("div",{target:"erver1d1"})("position:absolute;background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";border-radius:0.5rem;box-shadow:0 1rem 3rem ",(e=>{let{theme:t}=e;return t.shadowColor}),";border:1px solid ",(e=>{let{theme:t}=e;return t.popupBorderColor}),";padding:0.5rem 0;"),d=(0,r.A)("ul",{target:"erver1d0"})({name:"v5al3",styles:"list-style:none;padding:0;margin:0"}),u=e=>{let{isOpen:t,handleClose:n,position:r,children:a}=e;if((0,s.useEffect)((()=>{const e=e=>{t&&"Escape"===e.key&&n()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[t]),!t)return(0,i.jsx)(i.Fragment,{});const u=Math.min(r.x,window.innerWidth-200);return(0,i.jsx)(o.b,{children:(0,i.jsx)(l,{onClick:n,children:(0,i.jsx)(c,{style:{left:u,top:r.y},onClick:e=>e.stopPropagation(),children:(0,i.jsx)(d,{children:a})})})})}},9414:(e,t,n)=>{n.d(t,{N:()=>i});var r=n(10962),o=n(97233),s=n(62540);const i=e=>{let{mode:t}=e;switch(t.type){case"velocity":return(0,s.jsx)(o.Oj,{name:"velocity"});case"pitchBend":return(0,s.jsx)(o.Oj,{name:"pitch-bend"});case"controller":switch(t.controllerType){case r.M$.MSB_MAIN_VOLUME:return(0,s.jsx)(o.Oj,{name:"volume"});case r.M$.MSB_PAN:return(0,s.jsx)(o.Oj,{name:"panpot"});case r.M$.MSB_EXPRESSION:return(0,s.jsx)(o.Oj,{name:"expression"});case r.M$.SUSTAIN:return(0,s.jsx)(o.Oj,{name:"hold-pedal"});default:return(0,s.jsx)(s.Fragment,{children:"Undefined"===r.ZG[t.controllerType]?`CC${t.controllerType}`:r.ZG[t.controllerType]})}}}},54773:(e,t,n)=>{n.d(t,{A:()=>S});var r=n(46287),o=n(96604),s=n.n(o),i=n(66760),a=n.n(i),l=n(69229),c=n(63696),d=n(92770),u=n(59061),h=n(60790),m=n(9414),g=n(68306),p=n(58573),x=n(62540);const f=(0,r.A)("div",{target:"e1q3u1dm5"})("background:transparent;-webkit-appearance:none;padding:0.5em 0.8em;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";outline:none;font-size:0.75rem;cursor:default;display:flex;align-items:center;justify-content:center;flex-shrink:0;&:hover{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}"),v=(0,r.A)(f,{target:"e1q3u1dm4"})("width:8em;overflow:hidden;border-bottom:1px solid;border-color:",(e=>{let{theme:t,selected:n}=e;return n?t.themeColor:"transparent"}),";color:",(e=>{let{theme:t,selected:n}=e;return n?t.textColor:t.secondaryTextColor}),";"),y=(0,r.A)("span",{target:"e1q3u1dm3"})({name:"12wal98",styles:"text-overflow:ellipsis;overflow:hidden;white-space:nowrap"}),j=(0,r.A)("div",{target:"e1q3u1dm2"})("box-sizing:border-box;display:flex;margin-left:",d.PE.keyWidth,"px;height:2rem;flex-shrink:0;overflow-x:auto;&::-webkit-scrollbar{display:none;}"),k=c.memo((0,l.PA)((e=>{let{onSelect:t,selectedMode:n}=e;const{controlStore:r,rootViewStore:o}=(0,u.g)(),{controlModes:s}=r;return(0,x.jsxs)(j,{children:[s.map(((e,r)=>(0,x.jsx)(v,{selected:(0,h.Tk)(n,e),onMouseDown:()=>t(e),children:(0,x.jsx)(y,{children:(0,x.jsx)(m.N,{mode:e})})},r))),(0,x.jsx)(f,{onClick:()=>o.openControlSettingDialog=!0,children:(0,x.jsx)(a(),{style:{width:"1rem"}})})]})}))),b=(0,r.A)("div",{target:"e1q3u1dm1"})("width:100%;height:100%;display:flex;flex-direction:column;background:",(e=>{let{theme:t}=e;return t.darkBackgroundColor}),";"),w=(0,r.A)("div",{target:"e1q3u1dm0"})({name:"uqc6kb",styles:"flex-grow:1;position:relative;>canvas,>.LineGraph{position:absolute;top:0;left:0;}"}),S=(0,l.PA)((()=>{const e=(0,c.useRef)(null),t=s()(e),{controlStore:n}=(0,u.g)(),{controlMode:r}=n,o=(0,c.useCallback)((e=>n.controlMode=e),[]),i={width:t.width-d.PE.keyWidth-1,height:t.height-30},a="velocity"===r.type?(0,x.jsx)(p.A,{...i}):(0,x.jsx)(g.W,{...i,type:r});return(0,x.jsxs)(b,{ref:e,children:[(0,x.jsx)(k,{onSelect:o,selectedMode:r}),(0,x.jsx)(w,{children:a})]})}))},24381:(e,t,n)=>{n.d(t,{u:()=>h});var r=n(69229),o=n(63696),s=n(68278),i=n(59061),a=n(69673),l=n(97233),c=n(5909),d=n(94724),u=n(62540);const h=(0,r.PA)((e=>{const{handleClose:t}=e,{controlStore:n}=(0,i.g)(),r=n.selectedEventIds.length>0,h=(0,s.yw)(),m=(0,s.Ay)(),g=(0,s.AT)(),p=(0,s.mj)(),x=(0,o.useCallback)((()=>{h(),m(),t()}),[h,m]),f=(0,o.useCallback)((()=>{h(),t()}),[h]),v=(0,o.useCallback)((()=>{p(),t()}),[p]),y=(0,o.useCallback)((()=>{g(),t()}),[g]),j=(0,o.useCallback)((()=>{m(),t()}),[m]);return(0,u.jsxs)(c.t,{...e,children:[(0,u.jsxs)(d.Dr,{onClick:x,disabled:!r,children:[(0,u.jsx)(l.Oj,{name:"cut"}),(0,u.jsxs)(c.Z,{children:[a.t.cmdOrCtrl,"+X"]})]}),(0,u.jsxs)(d.Dr,{onClick:f,disabled:!r,children:[(0,u.jsx)(l.Oj,{name:"copy"}),(0,u.jsxs)(c.Z,{children:[a.t.cmdOrCtrl,"+C"]})]}),(0,u.jsxs)(d.Dr,{onClick:v,children:[(0,u.jsx)(l.Oj,{name:"paste"}),(0,u.jsxs)(c.Z,{children:[a.t.cmdOrCtrl,"+V"]})]}),(0,u.jsxs)(d.Dr,{onClick:y,disabled:!r,children:[(0,u.jsx)(l.Oj,{name:"duplicate"}),(0,u.jsxs)(c.Z,{children:[a.t.cmdOrCtrl,"+D"]})]}),(0,u.jsxs)(d.Dr,{onClick:j,disabled:!r,children:[(0,u.jsx)(l.Oj,{name:"delete"}),(0,u.jsx)(c.Z,{children:"Del"})]})]})}))},44723:(e,t,n)=>{n.d(t,{r:()=>i});var r=n(51382),o=n(54015),s=n(59061);const i=()=>{const{pianoRollStore:e,controlStore:t,controlStore:{quantizer:n},player:i}=(0,s.g)();return{onMouseDown(s,a,l,c){t.selectedEventIds=[];const d=n.round(l.getTick(a.x));e.selection=null,e.selectedNoteIds=[],i.isPlaying||(i.position=d),t.selection={fromTick:d,toTick:d},(0,o.R)(s,{onMouseMove:(e,o)=>{const s=r.b.add(a,o),i=n.round(l.getTick(s.x));t.selection={fromTick:Math.min(d,i),toTick:Math.max(d,i)}},onMouseUp:e=>{const{selection:n}=t;null!==n&&(t.selectedEventIds=c(n),t.selection=null)}})}}}},97637:(e,t,n)=>{n.d(t,{d:()=>s});var r=n(54015),o=n(59061);const s=()=>{const{controlStore:e,controlStore:{selectedTrack:t},pushHistory:n}=(0,o.g)();return{onMouseDown(o,s,i,a,l){if(void 0===t)return;n(),e.selectedEventIds.includes(s)||(e.selectedEventIds=[s]);const c=t.events.filter((t=>e.selectedEventIds.includes(t.id))).map((e=>({...e}))),d=c.find((e=>e.id===s));if(void 0===d)return;const u=a.getValue(i.y);(0,r.R)(o,{onMouseMove:(n,r)=>{const o=a.getTick(r.x),s=o-(d.tick+o-e.quantizer.round(d.tick+o)),l=a.getValue(i.y+r.y)-u;t.updateEvents(c.map((e=>({id:e.id,tick:Math.max(0,Math.floor(e.tick+s)),value:Math.min(a.maxValue,Math.max(0,Math.floor(e.value+l)))}))))},onMouseUp:n=>{const r=t.events.filter((t=>e.selectedEventIds.includes(t.id)));t.transaction((e=>r.forEach((t=>e.removeRedundantEvents(t)))))}})}}}},49464:(e,t,n)=>{n.d(t,{_:()=>d});var r=n(50119),o=n(72083),s=n(29909),i=n(51382),a=n(12968),l=n(54015),c=n(59061);const d=()=>{const{controlStore:e,pianoRollStore:t}=(0,c.g)(),n=(0,r.W0)(),d=(0,r.$8)(),u=(0,o.kT)();return{onMouseDown(r,o,c,h){u(),e.selectedEventIds=[],e.selection=null,t.selection=null,t.selectedNoteIds=[];const m=(0,a.i)(r),g=c.fromPosition(o),p=s.a.getEventFactory(h)(g.value);n(p,g.tick);let x=g.tick,f=g.value;(0,l.b)({onMouseMove:e=>{const t=(0,a.i)(e),n=i.b.sub(t,m),r=i.b.add(o,n),s=Math.max(0,Math.min(c.maxValue,c.fromPosition(r).value)),l=c.getTick(r.x);d(h)(f,s,x,l),x=l,f=s}})}}}},68306:(e,t,n)=>{n.d(t,{W:()=>c});var r=n(10962),o=n(69229),s=n(63696),i=n(59061),a=n(79625),l=n(62540);const c=s.memo((0,o.PA)((e=>{let{width:t,height:n,type:o}=e;const{controlStore:{controlValueEvents:c}}=(0,i.g)(),d=(0,s.useMemo)((()=>(e=>{switch(e.type){case"controller":return[0,32,64,96,127];case"pitchBend":return[0,4096,8192,12288,16383]}})(o)),[o]),u=(0,s.useMemo)((()=>(e=>{switch(e.type){case"controller":return 127;case"pitchBend":return 16384}})(o)),[o]),h=(0,s.useMemo)((()=>(e=>{switch(e.type){case"controller":return e.controllerType===r.M$.MSB_PAN?e=>(e-64).toString():e=>e.toString();case"pitchBend":return e=>(e-8192).toString();default:return e=>e.toString()}})(o)),[o]);return(0,l.jsx)(a.A,{width:t,height:n,maxValue:u,events:c,axis:d,eventType:o,axisLabelFormatter:h})})))},29980:(e,t,n)=>{n.d(t,{i:()=>d});var r=n(46287),o=n(63696),s=n(92770),i=n(62540);const a=(0,r.A)("div",{target:"eyj16ty2"})("text-align:right;width:",s.PE.keyWidth,"px;padding-right:0.3em;box-sizing:border-box;"),l=(0,r.A)("div",{target:"eyj16ty1"})({name:"m5cun2",styles:"position:relative;height:100%;display:flex;flex-direction:column;justify-content:space-between"}),c=(0,r.A)("div",{target:"eyj16ty0"})("padding:0.3em;font-size:90%;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";&:hover{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";cursor:default;}"),d=o.memo((e=>{let{values:t,valueFormatter:n=(e=>e.toString()),onClick:r}=e;return(0,i.jsx)(a,{children:(0,i.jsx)(l,{children:t.slice().reverse().map((e=>(0,i.jsx)(c,{className:"AxisValue",onClick:()=>r(e),children:n(e)},e)))})})}))},79625:(e,t,n)=>{n.d(t,{A:()=>w});var r=n(83785),o=n(69229),s=n(63696),i=n(68278),a=n(29909),l=n(71229),c=n(70480),d=n(67178),u=n(51046),h=n(78439),m=n(59061),g=n(53603),p=n(24381),x=n(44723),f=n(97637),v=n(49464),y=n(29980),j=n(53093),k=n(62540);const b=(0,o.PA)((e=>{let{maxValue:t,events:n,eventType:o,width:b,height:w,lineWidth:S=2,circleRadius:C=4,axis:T,axisLabelFormatter:A=(e=>e.toString())}=e;const{controlStore:{scrollLeft:E,transform:I,cursor:M,mouseMode:O}}=(0,m.g)(),P=(0,r.u)(),D=(0,i.$H)(),N=(0,v._)(),R=(0,f.d)(),z=(0,x.r)(),L=(0,s.useMemo)((()=>new d.d(I,t,w,S)),[I.horizontalId,t,w,S]),B=n.map((e=>({id:e.id,...L.toPosition(e.tick,e.value)}))),F=B.map((e=>({...(0,g.o)(e,C),id:e.id}))),H=(0,s.useCallback)((e=>F.find((t=>c.r.containsPoint(t,e)))?.id),[F]),W=e=>({x:e.offsetX+E,y:e.offsetY}),_=(0,s.useCallback)((e=>{const t=W(e.nativeEvent);N.onMouseDown(e.nativeEvent,t,L,o)}),[E,L,o,N]),K=(0,s.useCallback)((e=>{const t=W(e.nativeEvent),r=H(t);void 0!==r?R.onMouseDown(e.nativeEvent,r,t,L,o):z.onMouseDown(e.nativeEvent,t,L,(e=>n.filter((0,u.F)(l.Q.create(e.fromTick,e.toTick))).map((e=>e.id))))}),[L,E,n,o,H,R,z]),V="pencil"===O?_:K,X=(0,s.useCallback)((e=>{const t=a.a.getEventFactory(o)(e);D(t)}),[o,D]),{onContextMenu:Y,menuProps:q}=(0,h.E)();return(0,k.jsxs)("div",{style:{display:"flex"},children:[(0,k.jsx)(y.i,{values:T,valueFormatter:A,onClick:X}),(0,k.jsx)(j.z,{style:{cursor:M,backgroundColor:P.editorBackgroundColor},onMouseDown:V,onContextMenu:Y,width:b,height:w,maxValue:t,controlPoints:F,items:B}),(0,k.jsx)(p.u,{...q})]})})),w=s.memo(b)},53093:(e,t,n)=>{n.d(t,{z:()=>g});var r=n(47547),o=n(69229),s=n(63696),i=n(67178),a=n(28632),l=n(59061),c=n(51618),d=n(98423),u=n(31563),h=n(8957),m=n(62540);const g=(0,o.PA)((e=>{let{items:t,width:n,height:o,style:g,maxValue:p,controlPoints:x,onMouseDown:f,onContextMenu:v}=e;const{controlStore:{selection:y,scrollLeft:j,selectedEventIds:k,cursorX:b,transform:w,rulerStore:{beats:S}}}=(0,l.g)(),C=(0,s.useMemo)((()=>new i.d(w,p,o,2)),[w.horizontalId,p,o]),T=null!==y?C.transformSelection(y):null,A=(0,s.useMemo)((()=>(0,a.L)(-Math.floor(j),0)),[j]);return(0,m.jsx)(r.om,{width:n,height:o,onMouseDown:f,onContextMenu:v,style:g,children:(0,m.jsxs)(r.dL,{matrix:A,children:[(0,m.jsx)(c.g,{height:o,beats:S,zIndex:0}),(0,m.jsx)(h.B,{scrollLeft:j,width:n,items:t,selectedEventIds:k,controlPoints:x,lineWidth:2,zIndex:1}),(0,m.jsx)(u.L,{rect:T,zIndex:2}),(0,m.jsx)(d.b,{x:b,height:o,zIndex:3})]})})}))},8957:(e,t,n)=>{n.d(t,{B:()=>u});var r=n(83785),o=n(47547),s=n(44308),i=n.n(s),a=n(17243),l=n(72343),c=n(20604),d=n(62540);const u=e=>{let{width:t,scrollLeft:n,items:s,selectedEventIds:c,controlPoints:u,lineWidth:m,zIndex:g}=e;const p=(0,r.u)(),x=n+t,f=s.map((e=>({...e,id:e.id}))),v=h(f,m,x),[y,j]=(0,a.partition)(u,(e=>c.includes(e.id)));return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(o.FX,{rects:v,color:(0,l.B)(i()(p.themeColor)),zIndex:g}),(0,d.jsx)(o.rE,{rects:j,zIndex:g+.1,strokeColor:(0,l.B)(i()(p.themeColor)),fillColor:(0,l.B)(i()(p.themeColor))}),(0,d.jsx)(o.rE,{rects:y,zIndex:g+.2,strokeColor:(0,l.B)(i()(p.themeColor)),fillColor:(0,l.B)(i()(p.textColor))})]})},h=(e,t,n)=>{const r=e.map(((r,o)=>{let{x:s,y:i}=r;const a=e[o+1],l=a?a.x:n;return{x:s,y:i-t/2,width:l-s,height:t}}));return(0,c.F9)(r,((e,n)=>{const r=Math.min(e.y,n.y),o=Math.abs(e.y-n.y)+t;return{x:n.x-t/2,y:r,width:t,height:o}}))}},58573:(e,t,n)=>{n.d(t,{A:()=>h});var r=n(46287),o=n(69229),s=n(63696),i=n(29980),a=n(95577),l=n(62540);const c=(0,r.A)("div",{target:"es96sm00"})({name:"exvagw",styles:"display:flex;position:absolute;top:0;left:0"}),d=(0,o.PA)((e=>{let{width:t,height:n}=e;return(0,l.jsxs)(c,{children:[(0,l.jsx)(i.i,{values:[0,32,64,96,128],onClick:()=>{}}),(0,l.jsx)(a.R,{width:t,height:n})]})}));function u(e,t){return e.width===t.width&&e.height===t.height}const h=s.memo(d,u)},95577:(e,t,n)=>{n.d(t,{R:()=>k});var r=n(83785),o=n(47547),s=n(44308),i=n.n(s),a=n(69229),l=n(63696),c=n(50119),d=n(51382),u=n(70480),h=n(72343),m=n(28632),g=n(54015),p=n(59061),x=n(22095),f=n(51618),v=n(98423),y=n(85562),j=n(62540);const k=(0,a.PA)((e=>{let{width:t,height:n}=e;const{pianoRollStore:{transform:s,scrollLeft:a,windowedEvents:k,rulerStore:{beats:b},selectedNoteIds:w,cursorX:S}}=(0,p.g)(),C=(0,c.cY)(),T=(0,c.Sf)(),A=(0,r.u)(),E=(0,l.useMemo)((()=>k.filter(x.Fb).map((e=>{const{x:t}=s.getRect(e),r=e.velocity/127*n;return{id:e.id,x:t,y:n-r,width:5,height:r,isSelected:w.includes(e.id),hitArea:{x:t,y:0,width:5,height:n}}}))),[k,n,s,w]),I=(0,l.useCallback)((e=>{const t=e.nativeEvent,r={x:t.offsetX+a,y:t.offsetY};let o=(i=r,E.filter((e=>u.r.containsPoint(e.hitArea,i))));var i;w.length>0&&(o=o.filter((e=>e.isSelected)));const l=t.clientY-t.offsetY,c=e=>{const t=e.clientY-l;return Math.round(127*Math.max(0,Math.min(1,1-t/n)))};0===o.length?function(){let e=s.getTick(r.x),n=c(t);(0,g.R)(t,{onMouseMove:(t,o)=>{const i=d.b.add(r,o),a=s.getTick(i.x),l=c(t);C(e,n,a,l),e=a,n=l}})}():function(){const e=o.map((e=>e.id));T(e,c(t)),(0,g.b)({onMouseMove:t=>T(e,c(t))})}()}),[n,E,w,a,C,T]),M=(0,l.useMemo)((()=>(0,m.L)(-a,0)),[a]),O=i()(A.themeColor),P=(0,h.B)((0,h.N)(O,A.isLightContent,.3)),D=(0,l.useMemo)((()=>(0,h.B)(O)),[A]),N=(0,l.useMemo)((()=>(0,h.B)(O.lighten(.7))),[A]);return(0,j.jsx)(o.om,{width:t,height:n,style:{backgroundColor:A.editorBackgroundColor},onMouseDown:I,children:(0,j.jsxs)(o.dL,{matrix:M,children:[(0,j.jsx)(y.y,{rects:E,strokeColor:P,activeColor:D,selectedColor:N,zIndex:1}),(0,j.jsx)(f.g,{height:n,beats:b,zIndex:2}),(0,j.jsx)(v.b,{x:S,height:n,zIndex:4})]})})}))},85562:(e,t,n)=>{n.d(t,{y:()=>i});var r=n(47547),o=n(20665),s=n(62540);const i=e=>{let{rects:t,strokeColor:n,activeColor:i,selectedColor:a,zIndex:l}=e;const c=(0,r.I1)();return(0,s.jsx)(r.oW,{createShader:o.t,createBuffer:e=>new o.E(e),uniforms:{projectionMatrix:c,strokeColor:n,activeColor:i,selectedColor:a},buffer:t,zIndex:l})}},20665:(e,t,n)=>{n.d(t,{E:()=>o,t:()=>s});var r=n(47547);class o{_instanceCount=0;boundsBuffer=(()=>new Float32Array(0))();stateBuffer=(()=>new Float32Array(0))();constructor(e){this.vertexArray=e,this.vertexArray.updateBuffer("position",new Float32Array((0,r.pl)({x:0,y:0,width:1,height:1})))}update(e){(this.boundsBuffer.length<4*e.length||this.stateBuffer.length<2*e.length)&&(this.boundsBuffer=new Float32Array(4*e.length),this.stateBuffer=new Float32Array(2*e.length));for(let t=0;t<e.length;t++){const n=e[t];this.boundsBuffer[4*t+0]=n.x,this.boundsBuffer[4*t+1]=n.y,this.boundsBuffer[4*t+2]=n.width,this.boundsBuffer[4*t+3]=n.height,this.stateBuffer[2*t+0]=n.isSelected?1:0}this.vertexArray.updateBuffer("bounds",this.boundsBuffer.subarray(0,4*e.length)),this.vertexArray.updateBuffer("state",this.stateBuffer.subarray(0,2*e.length)),this._instanceCount=e.length}get vertexCount(){return 6}get instanceCount(){return this._instanceCount}}const s=e=>new r.Mt(e,"#version 300 es\n      precision lowp float;\n\n      uniform mat4 projectionMatrix;\n\n      in vec4 position;\n      in vec4 bounds;  // [x, y, width, height]\n      in vec2 state; // [isSelected, <not used>]\n\n      out vec4 vBounds;\n      out vec2 vPosition;\n      out vec2 vState;\n\n      void main() {\n        vec4 transformedPosition = vec4((position.xy * bounds.zw + bounds.xy), position.zw);\n        gl_Position = projectionMatrix * transformedPosition;\n        vBounds = bounds;\n        vPosition = transformedPosition.xy;\n        vState = state;\n      }\n    ","#version 300 es\n      precision lowp float;\n\n      uniform vec4 strokeColor;\n      uniform vec4 selectedColor;\n      uniform vec4 activeColor;\n\n      in vec4 vBounds;\n      in vec2 vPosition;\n      in vec2 vState;\n\n      out vec4 outColor;\n\n      void main() {\n        float border = 1.0;\n        float localX = vPosition.x - vBounds.x;\n        float localY = vPosition.y - vBounds.y;\n\n        float outlineTop = step(border, localY);\n        float outlineBottom = step(localY, vBounds.w - border);\n        float outlineLeft = step(border, localX);\n        float outlineRight = step(localX, vBounds.z - border);\n        \n        float isOutline = outlineTop * outlineBottom * outlineLeft * outlineRight;\n    \n        if (isOutline < 1.0) {\n          // draw outline\n          outColor = strokeColor;\n        } else {\n          // if selected, draw selected color\n          outColor = mix(activeColor, selectedColor, vState.x);\n        }\n      }\n    ",{position:{size:2,type:e.FLOAT},bounds:{size:4,type:e.FLOAT,divisor:1},state:{size:2,type:e.FLOAT,divisor:1}},{projectionMatrix:(0,r.z$)(),strokeColor:(0,r.fz)(),activeColor:(0,r.fz)(),selectedColor:(0,r.fz)()})},94025:(e,t,n)=>{n.d(t,{K:()=>T});var r=n(46287),o=n(68775),s=n(17243),i=n(57631),a=n.n(i),l=n(65272),c=n.n(l),d=n(69229),u=n(63696),h=n(59061),m=n(97233),g=n(60790),p=n(9414),x=n(66459),f=n(5513),v=n(71527),y=n(62540);const j=[{type:"velocity"},{type:"pitchBend"}],k=(0,r.A)("div",{target:"eu8b6d34"})("padding:0.5rem 1rem;background:",(e=>{let{theme:t,isSelected:n}=e;return n?t.themeColor:"transparent"}),";white-space:nowrap;"),b=(0,r.A)("div",{target:"eu8b6d33"})({name:"1l29xw",styles:"max-height:30rem;display:flex"}),w=(0,r.A)("div",{target:"eu8b6d32"})("flex-grow:1;flex-basis:0;overflow:auto;background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";"),S=(0,r.A)("div",{target:"eu8b6d31"})({name:"h06y6y",styles:"display:flex;flex-direction:column;align-items:center;justify-content:center;padding:1rem"}),C=(0,r.A)(f.$,{target:"eu8b6d30"})("background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";display:flex;align-items:center;margin-bottom:1rem;min-width:7rem;justify-content:center;"),T=(0,d.PA)((()=>{const{rootViewStore:e,controlStore:t}=(0,h.g)(),{openControlSettingDialog:n}=e,[r,i]=(0,u.useState)(null),[l,d]=(0,u.useState)(null),T=t.controlModes,A=j.concat((0,s.range)(0,128).map((e=>({type:"controller",controllerType:e})))).filter((e=>!t.controlModes.some((t=>(0,g.Tk)(t,e))))),E=T.map((e=>({mode:e,isSelected:null!==r&&(0,g.Tk)(e,r)}))),I=A.map((e=>({mode:e,isSelected:null!==l&&(0,g.Tk)(e,l)}))),M=(0,u.useCallback)((()=>e.openControlSettingDialog=!1),[e]);return(0,y.jsxs)(x.lG,{open:n,onOpenChange:M,style:{maxWidth:"40rem"},children:[(0,y.jsx)(x.L3,{children:(0,y.jsx)(m.Oj,{name:"control-settings"})}),(0,y.jsx)(x.Cf,{children:(0,y.jsxs)(b,{children:[(0,y.jsx)(w,{children:(0,y.jsx)(v.q,{items:E,getItemId:e=>(0,g.qw)(e.mode),onItemMoved:(e,n)=>{const r=E.findIndex((t=>(0,g.qw)(t.mode)===e)),s=E.findIndex((e=>(0,g.qw)(e.mode)===n));-1!==r&&-1!==s&&(t.controlModes=(0,o.be)(t.controlModes,r,s))},render:e=>(0,y.jsx)(k,{isSelected:e.isSelected,onClick:()=>{i(e.mode),d(null)},children:(0,y.jsx)(p.N,{mode:e.mode})},(0,g.qw)(e.mode))})}),(0,y.jsxs)(S,{children:[(0,y.jsxs)(C,{onClick:()=>{l&&(t.controlModes.push(l),d(null))},children:[(0,y.jsx)(a(),{style:{width:"1.25rem"}})," Add"]}),(0,y.jsxs)(C,{onClick:()=>{r&&(t.controlModes=t.controlModes.filter((e=>!(0,g.Tk)(e,r))),i(null))},children:["Remove ",(0,y.jsx)(c(),{style:{width:"1.25rem"}})]})]}),(0,y.jsx)(w,{children:I.map((e=>(0,y.jsx)(k,{isSelected:e.isSelected,onClick:()=>{i(null),d(e.mode)},children:(0,y.jsx)(p.N,{mode:e.mode})},(0,g.qw)(e.mode))))})]})}),(0,y.jsxs)(x.ii,{children:[(0,y.jsx)(f.$,{onClick:()=>{t.controlModes=g.jL},children:(0,y.jsx)(m.Oj,{name:"restore-defaults"})}),(0,y.jsx)("div",{style:{flex:1}}),(0,y.jsx)(f.$,{onClick:M,children:(0,y.jsx)(m.Oj,{name:"close"})})]})]})}))},71527:(e,t,n)=>{n.d(t,{q:()=>c});var r=n(93275),o=n(87211),s=n(68775),i=n(39391),a=n(62540);const l=e=>{const{attributes:t,listeners:n,setNodeRef:r,transform:o,transition:l}=(0,s.gl)({id:e.id}),c={transform:i.Ks.Transform.toString(o),transition:l};return(0,a.jsx)("div",{ref:r,style:c,...t,...n,tabIndex:-1,children:e.children})},c=e=>{let{items:t,render:n,getItemId:i,onItemMoved:c}=e;const d=t.map((e=>({id:i(e),item:e}))),u=(0,r.FR)((0,r.MS)(r.AN,{activationConstraint:{distance:5}}),(0,r.MS)(r.uN,{coordinateGetter:s.JR}));return(0,a.jsx)(r.Mp,{sensors:u,collisionDetection:r.fp,onDragEnd:e=>{const{active:t,over:n}=e;null!==n&&t.id!==n.id&&c(t.id,n.id)},modifiers:[o.FN],children:(0,a.jsx)(s.gB,{items:d,strategy:s._G,children:d.map(((e,t)=>(0,a.jsx)(l,{id:e.id,children:n(e.item)},e.id)))})})}},87393:(e,t,n)=>{n.d(t,{n:()=>l});var r=n(20994),o=n(63696),s=n(5513),i=n(66459),a=n(62540);const l=e=>{const{setDialog:t}=(0,o.useContext)(r.MV),n=n=>{e.callback(n),t(null)};return(0,a.jsxs)(i.lG,{open:!0,onOpenChange:()=>n(null),style:{minWidth:"20rem"},children:[(0,a.jsx)(i.L3,{children:e.title}),e.message&&(0,a.jsx)(i.Cf,{children:e.message}),(0,a.jsx)(i.ii,{children:e.actions.map((e=>(0,a.jsx)(s.$,{onClick:()=>n(e.key),children:e.title})))})]})}},66459:(e,t,n)=>{n.d(t,{Cf:()=>m,L3:()=>h,ii:()=>g,lG:()=>u});var r=n(46287),o=n(91785),s=n(13600),i=n(62540);const a=o.i7`
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
`,l=o.i7`
  from {
    opacity: 0;
    transform: translate(-50%, -48%) scale(0.96);
  }
  to {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
`,c=(0,r.A)(s.hJ,{target:"e1t9d94t4"})("background-color:rgba(0, 0, 0, 0.3);position:fixed;inset:0;animation:",a," 150ms cubic-bezier(0.16, 1, 0.3, 1);"),d=(0,r.A)(s.UC,{target:"e1t9d94t3"})("background-color:",(e=>{let{theme:t}=e;return t.backgroundColor}),";border-radius:0.5rem;box-shadow:0 0.5rem 3rem ",(e=>{let{theme:t}=e;return t.shadowColor}),";position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);margin-bottom:1rem;max-width:30rem;max-height:85vh;padding:1rem;animation:",l," 150ms cubic-bezier(0.16, 1, 0.3, 1);display:flex;flex-direction:column;pointer-events:auto;overflow:hidden;&:focus{outline:none;}"),u=e=>{let{children:t,style:n,...r}=e;return(0,i.jsx)(s.bL,{...r,children:(0,i.jsxs)(s.ZL,{children:[(0,i.jsx)(c,{}),(0,i.jsx)(d,{style:n,children:t})]})})},h=(0,r.A)("div",{target:"e1t9d94t2"})("font-size:1.25rem;color:",(e=>{let{theme:t}=e;return t.textColor}),";margin-bottom:1.5rem;"),m=(0,r.A)("div",{target:"e1t9d94t1"})({name:"4v81tc",styles:"overflow-x:hidden;overflow-y:auto;margin-bottom:1rem"}),g=(0,r.A)("div",{target:"e1t9d94t0"})({name:"1mcgwxs",styles:"display:flex;justify-content:flex-end;&>*:not(:last-child){margin-right:1rem;}"})},47759:(e,t,n)=>{n.d(t,{T:()=>l});var r=n(46287),o=n(571),s=n(66459),i=n(62540);const a=(0,r.A)("div",{target:"e1o8lja0"})("color:",(e=>{let{theme:t}=e;return t.textColor}),";margin-left:1rem;display:flex;align-items:center;font-size:0.8rem;"),l=e=>{let{open:t,children:n}=e;return(0,i.jsx)(s.lG,{open:t,style:{minWidth:"20rem"},children:(0,i.jsxs)(s.Cf,{style:{display:"flex",marginBottom:"0"},children:[(0,i.jsx)(o.P,{}),(0,i.jsx)(a,{children:n})]})})}},13546:(e,t,n)=>{n.d(t,{k:()=>s});var r=n(47759),o=n(62540);const s=e=>{let{open:t,message:n}=e;return(0,o.jsx)(r.T,{open:t,children:n})}},73061:(e,t,n)=>{n.d(t,{X:()=>c});var r=n(20994),o=n(63696),s=n(66459),i=n(5513),a=n(4830),l=n(62540);const c=e=>{const[t,n]=(0,o.useState)(e.initialText),{setPrompt:c}=(0,o.useContext)(r.QI),d=()=>{c(null)},u=()=>{e.callback(null),d()},h=()=>{e.callback(t??null),d()};return(0,l.jsxs)(s.lG,{open:!0,onOpenChange:u,style:{width:"20rem"},children:[(0,l.jsx)(s.L3,{children:e.title}),(0,l.jsx)(s.Cf,{children:(0,l.jsx)(a.A,{type:"text",value:t,onChange:e=>n(e.target.value),autoFocus:!0,onKeyPress:e=>{"Enter"===e.key&&h()},style:{width:"100%"}})}),(0,l.jsxs)(s.ii,{children:[(0,l.jsx)(i.$,{onClick:h,children:e.okText??"OK"}),(0,l.jsx)(i.$,{onClick:u,children:e.cancelText??"Cancel"})]})]})}},61508:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(17243),o=n(63696),s=n(62540);class i extends o.Component{canvas;ctx;componentDidMount(){const e=this.canvas?.getContext("2d");if(null===e)throw new Error("failed to getContext 2d");this.ctx=e,this.drawCanvas()}componentDidUpdate(){this.drawCanvas()}drawCanvas(){this.props.draw&&this.ctx&&(this.ctx.save(),this.ctx.scale(window.devicePixelRatio,window.devicePixelRatio),this.props.draw(this.ctx),this.ctx.restore())}render(){const{width:e,height:t,draw:n,style:o,...i}=this.props;return(0,s.jsx)("canvas",{ref:e=>e&&(this.canvas=e),...i,width:(0,r.isNumber)(e)?e*window.devicePixelRatio:void 0,height:(0,r.isNumber)(t)?t*window.devicePixelRatio:void 0,style:{...o,width:e,height:t}})}}},77582:(e,t,n)=>{n.d(t,{T:()=>i});var r=n(17243),o=n(26556),s=n(44569);function i(e){switch(e.type){case"channel":switch(e.subtype){case"controller":return{name:(0,s.mi)(e.controllerType)??`CC${e.controllerType}`,value:{type:"number",value:e.value.toFixed(0),update:d(0,127,(e=>({value:e})))}};case"note":return{name:"Note",value:{type:"number",value:e.velocity.toFixed(0),update:d(0,127,(e=>({velocity:e})))},gate:{type:"number",value:e.duration.toFixed(0),update:d(0,1/0,(e=>({duration:e})))}};case"programChange":return{name:"Program Change",value:{type:"number",value:e.value.toFixed(0),update:d(0,127,(e=>({value:e})))}};case"pitchBend":return{name:"Pitch Bend",value:{type:"number",value:e.value.toFixed(0),update:d(0,16384,(e=>({value:e})))}};default:return{name:e.subtype}}case"meta":switch(e.subtype){case"trackName":return{name:"Track Name",value:{type:"text",value:e.text,update:e=>({text:e})}};case"midiChannelPrefix":return{name:"MIDI Channel Prefix",value:{type:"number",value:e.value.toFixed(0),update:d(0,127,(e=>({channel:e})))}};case"setTempo":return{name:"Tempo",value:{type:"number",value:(0,o.M)(e.microsecondsPerBeat).toFixed(3),update:(0,r.flow)(parseInt,l(1,512),o.w4,Math.floor,a,c((e=>({microsecondsPerBeat:e}))))}};default:return{name:e.subtype}}case"dividedSysEx":case"sysEx":return{name:e.type}}}const a=e=>Number.isNaN(e)?null:e,l=(e,t)=>n=>(0,r.clamp)(n,e,t),c=e=>t=>null===t?null:e(t),d=(e,t,n)=>(0,r.flow)(parseInt,l(e,t),a,c(n))},55782:(e,t,n)=>{n.d(t,{Ay:()=>j,fI:()=>x,fh:()=>f});var r=n(46287),o=n(96604),s=n.n(o),i=n(69229),a=n(63696),l=n(97329),c=n(92770),d=n(59061),u=n(97233),h=n(59255),m=n(62540);const g=(0,r.A)("div",{target:"e12qnnra3"})({name:"w1atjl",styles:"width:100%;height:100%"}),p=(0,r.A)("div",{target:"e12qnnra2"})("height:",c.PE.rulerHeight,";border-bottom:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";padding-right:14px;"),x=(0,r.A)("div",{target:"e12qnnra1"})("display:grid;outline:none;grid-template-columns:5em 1fr 5em 5em;&:focus{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}"),f=(0,r.A)("div",{target:"e12qnnra0"})("padding:0.5rem;&:focus-within{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}"),v=(0,i.PA)((()=>{const{pianoRollStore:{selectedTrack:e,selectedNoteIds:t=[]}}=(0,d.g)(),n=(0,a.useMemo)((()=>{const{events:n=[]}=e||{};return t.length>0?n.filter((e=>t.indexOf(e.id)>=0)):n}),[e?.events,t]),r=(0,a.useRef)(null),o=s()(r);return(0,m.jsxs)(g,{ref:r,children:[(0,m.jsx)(p,{children:(0,m.jsxs)(x,{children:[(0,m.jsx)(f,{children:(0,m.jsx)(u.Oj,{name:"tick"})}),(0,m.jsx)(f,{children:(0,m.jsx)(u.Oj,{name:"event"})}),(0,m.jsx)(f,{children:(0,m.jsx)(u.Oj,{name:"duration"})}),(0,m.jsx)(f,{children:(0,m.jsx)(u.Oj,{name:"value"})})]})}),(0,m.jsx)(l.Y1,{height:o.height-c.PE.rulerHeight,itemCount:n.length,itemSize:35,width:o.width,itemData:{events:n},itemKey:e=>n[e].id,children:y})]})})),y=e=>{let{index:t,style:n,data:r}=e;const{events:o,selectedEventIds:s=[],setSelectedEventIds:i}=r,l=o[t],c=(0,a.useCallback)(((e,t)=>{e.ctrlKey||e.metaKey?i?.((e=>[...e,t.id])):i?.([t.id])}),[]);return(0,m.jsx)(h.E,{style:n,item:l,onClick:c},l.id)},j=v},73152:(e,t,n)=>{n.d(t,{R:()=>a});var r=n(46287),o=n(63696),s=n(62540);const i=(0,r.A)("input",{target:"eef2gy00"})("width:100%;display:block;background:transparent;border:none;color:inherit;-webkit-appearance:none;font-size:inherit;font-family:",(e=>{let{theme:t}=e;return t.monoFont}),";outline:none;-moz-appearance:textfield;&::-webkit-inner-spin-button{-webkit-appearance:none;margin:0;}"),a=e=>{let{value:t,type:n,onChange:r}=e;const[a,l]=(0,o.useState)(!1),[c,d]=(0,o.useState)(""),u=(0,o.useCallback)((()=>{r(c)}),[c]),h=(0,o.useCallback)((e=>{if("Enter"===e.key){const t=Array.from(e.currentTarget?.parentElement?.parentElement?.parentElement?.querySelectorAll("input")??[]).filter((e=>!e.disabled)),n=t.indexOf(e.currentTarget),r=t[n+1];r?.focus(),r?.select(),e.preventDefault()}"Escape"===e.key&&e.currentTarget.blur(),"Enter"!==e.key&&"Tab"!==e.key||u()}),[u,t]);return(0,s.jsx)(i,{type:n,value:a?c:t,onFocus:(0,o.useCallback)((()=>{l(!0),d(t)}),[t]),onBlur:(0,o.useCallback)((()=>{l(!1),u()}),[u]),onChange:(0,o.useCallback)((e=>{a&&d(e.target.value)}),[a]),disabled:null===t,onKeyDown:h})}},59255:(e,t,n)=>{n.d(t,{E:()=>h});var r=n(18264),o=n.n(r),s=n(63696),i=n(59061),a=n(77582),l=n(55782),c=n(73152),d=n(62540);const u=(e,t)=>o()(e.item,t.item)&&o()(e.style,t.style)&&e.onClick===t.onClick,h=s.memo((e=>{let{item:t,style:n,onClick:r}=e;const{pianoRollStore:{selectedTrack:o}}=(0,i.g)(),u=(0,a.T)(t),h=(0,s.useCallback)((e=>{o?.removeEvent(e.id)}),[o]),m=(0,s.useCallback)((e=>{const n=parseInt(e);isNaN(n)||o?.updateEvent(t.id,{tick:Math.max(0,n)})}),[o,t]),g=(0,s.useCallback)((e=>{if(void 0===u.gate)return;const n=u.gate.update(e);null!==n&&o?.updateEvent(t.id,n)}),[u,o,t]),p=(0,s.useCallback)((e=>{if(void 0===u.value)return;const n=u.value.update(e);null!==n&&o?.updateEvent(t.id,n)}),[u,o,t]);return(0,d.jsxs)(l.fI,{style:n,onClick:(0,s.useCallback)((e=>r(e,t)),[t]),onKeyDown:(0,s.useCallback)((e=>{e.target!==e.currentTarget||"Delete"!==e.key&&"Backspace"!==e.key||(h(t),e.stopPropagation())}),[t]),tabIndex:-1,children:[(0,d.jsx)(l.fh,{children:(0,d.jsx)(c.R,{value:t.tick.toFixed(0),type:"number",onChange:m})}),(0,d.jsx)(l.fh,{style:{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},children:u.name}),(0,d.jsx)(l.fh,{children:void 0!==u.gate&&(0,d.jsx)(c.R,{...u.gate,onChange:g})}),(0,d.jsx)(l.fh,{children:void 0!==u.value&&(0,d.jsx)(c.R,{...u.value,onChange:p})})]})}),u)},52767:(e,t,n)=>{n.d(t,{V:()=>g});var r=n(69229),o=n(63696),s=n(50119),i=n(30201),a=n(59061),l=n(97233),c=n(66459),d=n(55747),u=n(5513),h=n(3908),m=n(62540);const g=(0,r.PA)((()=>{const e=(0,a.g)(),{exportStore:t,song:n}=e,{openExportDialog:r,exportMode:g}=t,p=(0,i.j8)(),x=(0,o.useCallback)((()=>t.openExportDialog=!1),[t]),f=(0,o.useCallback)((()=>{t.openExportDialog=!1,p()}),[t,p]),v=(0,o.useCallback)((e=>t.exportMode=e),[t]),[y,j]=(0,o.useState)(!1);return(0,o.useEffect)((()=>{r&&j((0,s.pp)(n))}),[r]),(0,m.jsxs)(c.lG,{open:r,onOpenChange:x,style:{minWidth:"20rem"},children:[(0,m.jsx)(c.L3,{children:(0,m.jsx)(l.Oj,{name:"export-audio"})}),(0,m.jsxs)(c.Cf,{children:[(0,m.jsx)(h.W,{value:g,onChange:v}),!y&&(0,m.jsx)(d.F,{severity:"warning",children:(0,m.jsx)(l.Oj,{name:"export-error-too-short"})})]}),(0,m.jsxs)(c.ii,{children:[(0,m.jsx)(u.$,{onClick:x,children:(0,m.jsx)(l.Oj,{name:"close"})}),y&&(0,m.jsx)(u.j,{onClick:f,children:(0,m.jsx)(l.Oj,{name:"export"})})]})]})}))},74390:(e,t,n)=>{n.d(t,{u:()=>h});var r=n(69229),o=n(63696),s=n(50119),i=n(59061),a=n(97233),l=n(66459),c=n(5513),d=n(24343),u=n(62540);const h=(0,r.PA)((()=>{const{exportStore:e}=(0,i.g)(),t=(0,s.Id)(),{openExportProgressDialog:n,progress:r}=e,h=(0,o.useCallback)((()=>{e.openExportProgressDialog=!1,t()}),[e,t]);return(0,u.jsxs)(l.lG,{open:n,style:{minWidth:"20rem"},children:[(0,u.jsx)(l.L3,{children:(0,u.jsx)(a.Oj,{name:"exporting-audio"})}),(0,u.jsx)(l.Cf,{children:(0,u.jsx)(d.h,{value:r,max:1})}),(0,u.jsx)(l.ii,{children:(0,u.jsx)(c.$,{onClick:h,children:(0,u.jsx)(a.Oj,{name:"cancel"})})})]})}))},3908:(e,t,n)=>{n.d(t,{W:()=>l});var r=n(46287),o=n(97233),s=n(20928),i=n(62540);const a=(0,r.A)(s.$,{target:"ejh86c00"})({name:"1780w32",styles:"background-color:transparent;margin:0.65rem 0 0.65rem 0"}),l=e=>{let{value:t,onChange:n}=e;return(0,i.jsxs)("div",{children:[(0,i.jsx)(o.Oj,{name:"file-type"}),":",(0,i.jsxs)(a,{children:[(0,i.jsx)(s.A,{selected:"WAV"===t,onMouseDown:()=>n("WAV"),children:(0,i.jsx)("span",{children:"WAV"})}),(0,i.jsx)(s.A,{selected:"MP3"===t,onMouseDown:()=>n("MP3"),children:(0,i.jsx)("span",{children:"MP3"})})]})]})}},51618:(e,t,n)=>{n.d(t,{g:()=>u});var r=n(83785),o=n(44308),s=n.n(o),i=n(17243),a=n(63696),l=n(72343),c=n(8178),d=n(62540);const u=e=>{let{height:t,beats:n,zIndex:o}=e;const u=(0,r.u)(),[h,m]=(0,i.partition)(n,(e=>0===e.beat)),g=m.map((e=>e.x)),p=h.map((e=>e.x)),x=(0,a.useMemo)((()=>(0,l.B)(s()(u.editorSecondaryGridColor))),[u]),f=(0,a.useMemo)((()=>(0,l.B)(s()(u.editorGridColor))),[u]);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(c.a,{xArray:g,color:x,height:t,lineWidth:1,zIndex:o}),(0,d.jsx)(c.a,{xArray:p,color:f,height:t,lineWidth:1,zIndex:o+.1})]})}},98423:(e,t,n)=>{n.d(t,{b:()=>i});var r=n(47547),o=n(51080),s=n(62540);const i=e=>{let{x:t,height:n,zIndex:i}=e;const a=o.fA(1,0,0,1);return(0,s.jsx)(r.FX,{rects:[{x:t,y:0,width:1,height:n}],color:a,zIndex:i})}},31563:(e,t,n)=>{n.d(t,{L:()=>d});var r=n(83785),o=n(47547),s=n(44308),i=n.n(s),a=n(51080),l=n(72343),c=n(62540);const d=e=>{let{rect:t,zIndex:n}=e;const s=(0,r.u)();return null===t?(0,c.jsx)(c.Fragment,{}):(0,c.jsx)(o.QB,{rects:[t],fillColor:a.vt(),strokeColor:(0,l.B)(i()(s.themeColor)),zIndex:n})}},8178:(e,t,n)=>{n.d(t,{a:()=>i});var r=n(47547),o=n(68971),s=n(62540);const i=e=>{let{xArray:t,color:n,height:i,lineWidth:a,zIndex:l}=e;const c=(0,r.I1)();return(0,s.jsx)(r.oW,{createShader:o.R,createBuffer:e=>new o.K(e),uniforms:{projectionMatrix:c,color:n,height:i,lineWidth:a},buffer:t,zIndex:l})}},68971:(e,t,n)=>{n.d(t,{K:()=>o,R:()=>s});var r=n(47547);class o{_instanceCount=0;constructor(e){this.vertexArray=e,this.vertexArray.updateBuffer("position",new Float32Array((0,r.pl)({x:0,y:0,width:1,height:1})))}update(e){this.vertexArray.updateBuffer("x",new Float32Array(e)),this._instanceCount=e.length}get vertexCount(){return 6}get instanceCount(){return this._instanceCount}}const s=e=>new r.Mt(e,"#version 300 es\n    precision lowp float;\n    layout (location = 0) in vec4 position;\n    layout (location = 1) in float x;\n    uniform mat4 projectionMatrix;\n    uniform float height;\n    uniform float lineWidth;\n\n    void main() {\n      vec4 screenPosition = vec4(position.xy * vec2(lineWidth, height) + vec2(x, 0.0), position.zw);\n      gl_Position = projectionMatrix * screenPosition;\n    }\n    ","#version 300 es\n    precision lowp float;\n    uniform vec4 color;\n    out vec4 outColor;\n\n    void main() {\n      outColor = color;\n    }\n    ",{position:{size:2,type:e.FLOAT},x:{size:1,type:e.FLOAT,divisor:1}},{projectionMatrix:(0,r.z$)(),color:(0,r.fz)(),height:(0,r.Z7)(),lineWidth:(0,r.Z7)()})},35679:(e,t,n)=>{n.d(t,{p:()=>a});var r=n(69229),o=n(98914),s=n(59061),i=n(62540);const a=(0,r.PA)((()=>{const{song:e}=(0,s.g)();return(0,i.jsx)(o.mg,{children:(0,i.jsxs)("title",{children:[l(e),e.isSaved?"":" *"," - signal"]})})}));function l(e){return e.filepath.length>0?e.filepath:e.name.length>0?e.name:"New song"}},10713:(e,t,n)=>{n.d(t,{Q:()=>p});var r=n(46287),o=n(69229),s=n(59061),i=n(69673),a=n(97233),l=n(66459),c=n(5513),d=n(62540);const u=(0,r.A)("div",{target:"e166zqyl2"})({name:"1ny64b3",styles:"display:flex;align-items:center;margin-bottom:0.5rem;span{margin:0 0.3em;}"}),h=(0,r.A)("div",{target:"e166zqyl1"})("display:inline-block;border:1px solid white;border-radius:4px;padding:0.1em 0.5em 0.2em 0.5em;background:",(e=>{let{theme:t}=e;return t.textColor}),";color:",(e=>{let{theme:t}=e;return t.backgroundColor}),";box-shadow:inset 0 -2px 0 0px #0000006b;"),m=(0,r.A)("div",{target:"e166zqyl0"})({name:"1mwkkc",styles:"margin-left:1em"}),g=e=>{let{hotKeys:t,text:n}=e;return(0,d.jsxs)(u,{children:[t.map(((e,t)=>e.map(((e,n)=>(0,d.jsx)(h,{children:e},1e4*t+n))).reduce(((e,t)=>[e,(0,d.jsx)("span",{children:"+"},"plus"),t])))).reduce(((e,t)=>[e,(0,d.jsx)("span",{children:"/"},"slash"),t])),(0,d.jsx)(m,{children:n})]})},p=(0,o.PA)((()=>{const{rootViewStore:e}=(0,s.g)(),t=e.openHelp,n=()=>e.openHelp=!1;return(0,d.jsxs)(l.lG,{open:t,onOpenChange:n,children:[(0,d.jsx)(l.L3,{children:(0,d.jsx)(a.Oj,{name:"help"})}),(0,d.jsxs)(l.Cf,{children:[(0,d.jsx)("h3",{children:(0,d.jsx)(a.Oj,{name:"keyboard-shortcut"})}),(0,d.jsx)(g,{hotKeys:[["Space"]],text:(0,d.jsx)(a.Oj,{name:"play-pause"})}),(0,d.jsx)(g,{hotKeys:[["Enter"]],text:(0,d.jsx)(a.Oj,{name:"stop"})}),(0,d.jsx)(g,{hotKeys:[["A"],["D"]],text:(0,d.jsx)(a.Oj,{name:"forward-rewind"})}),(0,d.jsx)(g,{hotKeys:[["R"]],text:(0,d.jsx)(a.Oj,{name:"start-stop-recording"})}),(0,d.jsx)(g,{hotKeys:[["S"],["W"]],text:(0,d.jsx)(a.Oj,{name:"next-previous-track"})}),(0,d.jsx)(g,{hotKeys:[["N"],["M"],[","]],text:(0,d.jsx)(a.Oj,{name:"solo-mute-ghost"})}),(0,d.jsx)(g,{hotKeys:[["T"]],text:(0,d.jsx)(a.Oj,{name:"transpose"})}),(0,d.jsx)(g,{hotKeys:[["1"]],text:(0,d.jsx)(a.Oj,{name:"pencil-tool"})}),(0,d.jsx)(g,{hotKeys:[["2"]],text:(0,d.jsx)(a.Oj,{name:"selection-tool"})}),(0,d.jsx)(g,{hotKeys:[["↑"],["↓"]],text:(0,d.jsx)(a.Oj,{name:"move-selection"})}),(0,d.jsx)(g,{hotKeys:[["←"],["→"]],text:(0,d.jsx)(a.Oj,{name:"select-note"})}),(0,d.jsx)(g,{hotKeys:[[i.t.cmdOrCtrl,"1"],[i.t.cmdOrCtrl,"2"],[i.t.cmdOrCtrl,"3"]],text:(0,d.jsx)(a.Oj,{name:"switch-tab"})}),(0,d.jsx)(g,{hotKeys:[[i.t.cmdOrCtrl,"↑"],[i.t.cmdOrCtrl,"↓"]],text:(0,d.jsx)(a.Oj,{name:"scroll-vertically"})}),(0,d.jsx)(g,{hotKeys:[[i.t.cmdOrCtrl,"←"],[i.t.cmdOrCtrl,"→"]],text:(0,d.jsx)(a.Oj,{name:"scroll-horizontally"})}),(0,d.jsx)(g,{hotKeys:[[i.t.cmdOrCtrl,"Z"]],text:(0,d.jsx)(a.Oj,{name:"undo"})}),(0,d.jsx)(g,{hotKeys:[[i.t.cmdOrCtrl,"Y"],[i.t.cmdOrCtrl,"Shift","Z"]],text:(0,d.jsx)(a.Oj,{name:"redo"})}),(0,d.jsx)(g,{hotKeys:[[i.t.cmdOrCtrl,"C"]],text:(0,d.jsx)(a.Oj,{name:"copy-selection"})}),(0,d.jsx)(g,{hotKeys:[["Delete"],["Backspace"]],text:(0,d.jsx)(a.Oj,{name:"delete-selection"})}),(0,d.jsx)(g,{hotKeys:[[i.t.cmdOrCtrl,"X"]],text:(0,d.jsx)(a.Oj,{name:"cut-selection"})}),(0,d.jsx)(g,{hotKeys:[[i.t.cmdOrCtrl,"V"]],text:(0,d.jsx)(a.Oj,{name:"paste-selection"})}),(0,d.jsx)(g,{hotKeys:[[i.t.cmdOrCtrl,"A"]],text:(0,d.jsx)(a.Oj,{name:"select-all"})}),(0,d.jsx)(g,{hotKeys:[["?"]],text:(0,d.jsx)(a.Oj,{name:"open-help"})})]}),(0,d.jsx)(l.ii,{children:(0,d.jsx)(c.$,{onClick:n,children:(0,d.jsx)(a.Oj,{name:"close"})})})]})}))},90829:(e,t,n)=>{n.d(t,{A:()=>M});var r=n(46287),o=n(17243),s=n(15841),i=n.n(s),a=n(53649),l=n.n(a),c=n(69229),d=n(63696),u=n(50119),h=n(20604),m=n(59061),g=n(97233),p=n(16053),x=n(6358),f=n(66459),v=n(41479),y=n(6980),j=n(5513),k=n(16066),b=n(15467),w=n(57459),S=n(62540);const C=(0,r.A)("div",{target:"eka714a3"})({name:"lcj4t6",styles:"display:flex;&.disabled{opacity:0.5;pointer-events:none;}"}),T=(0,r.A)("div",{target:"eka714a2"})({name:"jy2zty",styles:"width:15rem;display:flex;flex-direction:column"}),A=(0,r.A)("div",{target:"eka714a1"})({name:"155188o",styles:"width:21rem;display:flex;flex-direction:column;overflow:hidden"}),E=(0,r.A)("div",{target:"eka714a0"})({name:"akdqam",styles:"margin-top:1rem"}),I=e=>{let{onClickCancel:t,onClickOK:n,isOpen:r,presetCategories:o,onChange:s,setting:{programNumber:i,isRhythmTrack:a}}=e;const l=(0,p.h)(i),c=o.length>l?o[l].presets:[],d=o.map(((e,t)=>({value:t,label:(0,S.jsx)(v.F,{programNumber:e.presets[0].programNumber})}))),u=c.map((e=>({value:e.programNumber,label:(0,S.jsx)(y.Z,{programNumber:e.programNumber})})));return(0,S.jsxs)(f.lG,{open:r,onOpenChange:t,children:[(0,S.jsxs)(f.Cf,{className:"InstrumentBrowser",children:[(0,S.jsxs)(C,{className:a?"disabled":"",children:[(0,S.jsxs)(T,{children:[(0,S.jsx)(b.J,{style:{marginBottom:"0.5rem"},children:(0,S.jsx)(g.Oj,{name:"categories"})}),(0,S.jsx)(w.a,{items:d,selectedValue:l,onChange:e=>s({programNumber:8*e,isRhythmTrack:a})})]}),(0,S.jsxs)(A,{children:[(0,S.jsx)(b.J,{style:{marginBottom:"0.5rem"},children:(0,S.jsx)(g.Oj,{name:"instruments"})}),(0,S.jsx)(w.a,{items:u,selectedValue:i,onChange:e=>s({programNumber:e,isRhythmTrack:a})})]})]}),(0,S.jsx)(E,{children:(0,S.jsx)(k.S,{checked:a,onCheckedChange:e=>{s({programNumber:i,isRhythmTrack:!0===e})},label:(0,S.jsx)(g.Oj,{name:"rhythm-track"})})})]}),(0,S.jsxs)(f.ii,{children:[(0,S.jsx)(j.$,{onClick:t,children:(0,S.jsx)(g.Oj,{name:"cancel"})}),(0,S.jsx)(j.j,{onClick:n,children:(0,S.jsx)(g.Oj,{name:"ok"})})]})]})},M=(0,c.PA)((()=>{const{pianoRollStore:{selectedTrack:e,instrumentBrowserSetting:t,openInstrumentBrowser:n},pianoRollStore:r,player:s,song:a}=(0,m.g)(),c=(0,u.mG)(),g=(0,u.Yr)(),f=(0,u.mv)(),[v,j]=(0,d.useState)(null);if(void 0===e)return(0,S.jsx)(S.Fragment,{});const k=()=>r.openInstrumentBrowser=!1,b=t=>f(e.id,t),w=l()(0,128).map((e=>({programNumber:e,name:(0,S.jsx)(y.Z,{programNumber:e})}))),C=(0,o.map)((0,o.groupBy)(w,(e=>(0,p.h)(e.programNumber))),(e=>({presets:e})));return(0,S.jsx)(I,{isOpen:n,setting:t,onChange:t=>{const n=e.channel;if(void 0!==n){if(s.sendEvent((0,x.Ch)(0,n,t.programNumber)),!s.isPlaying){const e=64;null!==v&&(clearTimeout(v),g({noteNumber:e,channel:n})),c({noteNumber:e,velocity:100,channel:n});const t=setTimeout((()=>{g({noteNumber:e,channel:n}),j(null)}),500);j(t)}r.instrumentBrowserSetting=t}},onClickCancel:()=>{k()},onClickOK:()=>{if(t.isRhythmTrack)e.channel=9,b(0);else{if(e.isRhythmTrack){const t=l()(16),n=a.tracks.filter((t=>t!==e)).map((e=>e.channel)),r=Math.min(...i()(t,n).filter(h.EA))||0;e.channel=r}b(t.programNumber)}k()},presetCategories:C})}))},57459:(e,t,n)=>{n.d(t,{a:()=>l});var r=n(46287),o=n(62540);const s=(0,r.A)("div",{target:"e1vpk4yn1"})("overflow:auto;background-color:",(e=>{let{theme:t}=e;return t.darkBackgroundColor}),";border:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";max-height:22rem;flex-grow:1;display:flex;flex-direction:column;&:focus{outline:",(e=>{let{theme:t}=e;return t.themeColor})," 1px solid;}"),i=(0,r.A)("div",{target:"e1vpk4yn0"})("padding:0.5em 1em;flex-shrink:0;font-size:0.9rem;height:2rem;box-sizing:border-box;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;user-select:none;&.checked{background:",(e=>{let{theme:t}=e;return t.themeColor}),";}"),a=e=>{let{checked:t,onClick:n,children:r}=e;return(0,o.jsx)(i,{className:t?"checked":"",onClick:n,children:r})},l=e=>{let{items:t,selectedValue:n,onChange:r}=e;return(0,o.jsx)(s,{onKeyDown:e=>{const o=t.findIndex((e=>e.value===n));switch(e.key){case"ArrowUp":o>0&&r(t[o-1].value),e.preventDefault(),e.stopPropagation();break;case"ArrowDown":o<t.length-1&&r(t[o+1].value),e.preventDefault(),e.stopPropagation()}},tabIndex:0,children:t.map(((e,t)=>(0,o.jsx)(a,{checked:e.value===n,onClick:()=>r(e.value),children:e.label},t)))})}},95229:(e,t,n)=>{n.d(t,{C:()=>v});var r=n(46287),o=n(69229),s=n(63696),i=n(54164),a=n(59061),l=n(97233),c=n(66459),d=n(5513),u=n(15467),h=n(95881),m=n(5723),g=n(62540);const p=Array.from({length:12},((e,t)=>["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][t])),x=(0,r.A)("div",{target:"e4i23ze1"})({name:"ho1qnd",styles:"display:flex;flex-direction:row"}),f=(0,r.A)("div",{target:"e4i23ze0"})({name:"1fttcpj",styles:"display:flex;flex-direction:column"}),v=(0,o.PA)((e=>{let{open:t,onOpenChange:n}=e;const{pianoRollStore:r}=(0,a.g)(),o=()=>n(!1);return(0,s.useEffect)((()=>{}),[t]),(0,g.jsxs)(c.lG,{open:t,onOpenChange:o,style:{minWidth:"20rem"},children:[(0,g.jsx)(c.L3,{children:(0,g.jsx)(l.Oj,{name:"scale"})}),(0,g.jsx)(c.Cf,{children:(0,g.jsxs)(x,{style:{gap:"1rem"},children:[(0,g.jsxs)(f,{style:{gap:"0.5rem",minWidth:"5rem"},children:[(0,g.jsx)(u.J,{children:(0,g.jsx)(l.Oj,{name:"key"})}),(0,g.jsx)(h.l,{value:r.keySignature?.key,onChange:e=>{const t=parseInt(e.target.value);r.keySignature={scale:r.keySignature?.scale??"major",key:t}},children:p.map(((e,t)=>(0,g.jsx)("option",{value:t,children:e},t)))})]}),(0,g.jsxs)(f,{style:{gap:"0.5rem",minWidth:"5rem"},children:[(0,g.jsx)(u.J,{children:(0,g.jsx)(l.Oj,{name:"scale"})}),(0,g.jsx)(h.l,{value:r.keySignature?.scale,onChange:e=>{const t=e.target.value;r.keySignature={key:r.keySignature?.key??0,scale:t}},children:i.F.values.map(((e,t)=>(0,g.jsx)("option",{value:e,children:(0,g.jsx)(m.g,{scale:e})},t)))})]})]})}),(0,g.jsx)(c.ii,{children:(0,g.jsx)(d.$,{onClick:o,children:(0,g.jsx)(l.Oj,{name:"close"})})})]})}))},5723:(e,t,n)=>{n.d(t,{g:()=>o});var r=n(97233);const o=e=>{let{scale:t}=e;const n=(0,r.B2)();switch(t){case"major":return n["scale-major"];case"minor":return n["scale-minor"];case"harmonicMinor":return n["scale-harmonic-minor"];case"harmonicMajor":return n["scale-harmonic-major"];case"melodicMinor":return n["scale-melodic-minor"];case"ionian":return n["scale-ionian"];case"dorian":return n["scale-dorian"];case"phrygian":return n["scale-phrygian"];case"lydian":return n["scale-lydian"];case"mixolydian":return n["scale-mixolydian"];case"aeolian":return n["scale-aeolian"];case"locrian":return n["scale-locrian"];case"majorPentatonic":return n["scale-major-pentatonic"];case"minorPentatonic":return n["scale-minor-pentatonic"];case"majorBlues":return n["scale-major-blues"];case"minorBlues":return n["scale-minor-blues"];case"halfWholeDiminished":return n["scale-half-whole-diminished"];case"wholeHalfDiminished":return n["scale-whole-half-diminished"];case"wholeTone":return n["scale-whole-tone"]}}},69552:(e,t,n)=>{n.d(t,{X:()=>l});var r=n(69229),o=n(50119),s=n(59061),i=n(95089),a=n(62540);const l=(0,r.PA)((()=>{const{arrangeViewStore:e}=(0,s.g)(),t=(0,o.DA)(),n=(0,o.hM)(),r=(0,o.Fl)(),l=(0,o.PT)();return(0,a.jsx)(i.S,{actions:[{code:"Escape",run:()=>e.resetSelection()},{code:"Delete",run:()=>t()},{code:"Backspace",run:()=>t()},{code:"ArrowUp",metaKey:!0,run:()=>e.scrollBy(0,24)},{code:"ArrowDown",metaKey:!0,run:()=>e.scrollBy(0,-24)},{code:"KeyT",run:()=>e.openTransposeDialog=!0},{code:"KeyD",metaKey:!0,run:()=>l()}],onCut:()=>{n(),t()},onCopy:()=>n(),onPaste:()=>r()})}))},36020:(e,t,n)=>{n.d(t,{n:()=>d});var r=n(69229),o=n(63696),s=n(50119),i=n(72083),a=n(59061),l=n(95089),c=n(62540);const d=(0,r.PA)((()=>{const{rootViewStore:e,router:t,player:n}=(0,a.g)(),r=(0,s.sQ)(),d=(0,s.m$)(),u=(0,s.qo)(),h=(0,s.Yp)(),m=(0,s.Ut)(),g=(0,s.t3)(),p=(0,s.d0)(),x=(0,s.Fv)(),f=(0,s.bO)(),v=(0,i.Yw)(),y=(0,i.cN)();return(0,o.useEffect)((()=>{const e=e=>{e.ctrlKey&&e.preventDefault()};document.addEventListener("wheel",e,{passive:!1});const t=e=>{e.preventDefault};return document.addEventListener("touchmove",t,{passive:!1}),document.oncontextmenu=e=>e.preventDefault(),()=>{document.removeEventListener("wheel",e),document.removeEventListener("touchmove",t),document.oncontextmenu=null}}),[]),(0,c.jsx)(l.S,{actions:[{code:"Space",run:()=>n.playOrPause()},{code:"KeyZ",metaKey:!0,shiftKey:!0,run:y},{code:"KeyZ",metaKey:!0,shiftKey:!1,run:v},{code:"KeyY",metaKey:!0,run:y},{code:"Slash",shiftKey:!0,run:()=>e.openHelp=!0},{code:"Enter",run:u},{code:"KeyA",run:r},{code:"KeyD",run:d},{code:"KeyS",run:h},{code:"KeyW",run:m},{code:"KeyN",run:g},{code:"KeyM",run:p},{code:"KeyR",run:f},{code:"Comma",run:x},{code:"Digit1",metaKey:!0,run:()=>t.path="/track"},{code:"Digit2",metaKey:!0,run:()=>t.path="/arrange"},{code:"Digit3",metaKey:!0,run:()=>t.path="/tempo"}]})}))},95089:(e,t,n)=>{n.d(t,{S:()=>i});var r=n(63696),o=n(10322),s=n(62540);const i=e=>{let{actions:t,onCut:n,onCopy:i,onPaste:a}=e;return(0,r.useEffect)((()=>{const e=e=>{if(null!==e.target&&(0,o.t)(e.target))return;const n=t.find((t=>(t.enabled?.()??!0)&&e.code===t.code&&e.shiftKey===(t.shiftKey??!1)&&(e.ctrlKey||e.metaKey)===(t.metaKey??!1)));void 0!==n&&(n.run(e),e.preventDefault(),e.stopPropagation())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}),[t]),(0,r.useEffect)((()=>(document.oncut=n??null,()=>{document.oncut=null})),[n]),(0,r.useEffect)((()=>(document.oncopy=i??null,()=>{document.oncopy=null})),[i]),(0,r.useEffect)((()=>(document.onpaste=a??null,()=>{document.onpaste=null})),[a]),(0,s.jsx)(s.Fragment,{})}},73853:(e,t,n)=>{n.d(t,{y:()=>g});var r=n(69229),o=n(50119),s=n(68278),i=n(15883),a=n(59061),l=n(15738),c=n(95089),d=n(31937),u=n(10322),h=n(64142),m=n(62540);const g=(0,r.PA)((()=>{const{pianoRollStore:e,controlStore:t}=(0,a.g)(),n=(0,h._)(),r=(0,d.T)(),g=(0,o.Nl)(),p=(0,s.mj)();return(0,m.jsx)(c.S,{actions:[...e.selectedNoteIds.length>0?n():[],...t.selectedEventIds.length>0?r():[],{code:"ArrowUp",metaKey:!0,run:()=>e.scrollBy(0,24)},{code:"ArrowDown",metaKey:!0,run:()=>e.scrollBy(0,-24)},{code:"ArrowRight",metaKey:!0,run:()=>e.scrollBy(-24,0)},{code:"ArrowLeft",metaKey:!0,run:()=>e.scrollBy(24,0)},{code:"Digit1",run:()=>e.mouseMode="pencil"},{code:"Digit2",run:()=>e.mouseMode="selection"}],onPaste:e=>{if(null!==e.target&&(0,u.t)(e.target))return;const t=l.A.readText();if(!t||0===t.length)return;const n=JSON.parse(t);(0,i.dn)(n)?g():(0,i.Np)(n)&&p()}})}))},64741:(e,t,n)=>{n.d(t,{g:()=>u});var r=n(69229),o=n(87188),s=n(15883),i=n(59061),a=n(15738),l=n(95089),c=n(10322),d=n(62540);const u=(0,r.PA)((()=>{const{tempoEditorStore:e}=(0,i.g)(),t=(0,o.Gm)(),n=(0,o._C)(),r=(0,o.av)(),u=(0,o.GZ)(),h=(0,o.e)();return(0,d.jsx)(l.S,{actions:[{code:"Digit1",run:()=>e.mouseMode="pencil"},{code:"Digit2",run:()=>e.mouseMode="selection"},{code:"Escape",run:t},{code:"Backspace",run:n},{code:"Delete",run:n},{code:"KeyC",metaKey:!0,run:()=>r()},{code:"KeyX",metaKey:!0,run:()=>{r(),n()}},{code:"KeyD",metaKey:!0,run:u}],onPaste:e=>{if(null!==e.target&&(0,c.t)(e.target))return;const t=a.A.readText();if(!t||0===t.length)return;const n=JSON.parse(t);(0,s.dQ)(n)&&h()}})}))},31937:(e,t,n)=>{n.d(t,{T:()=>o});var r=n(68278);const o=()=>{const e=(0,r.SR)(),t=(0,r.Ay)(),n=(0,r.yw)(),o=(0,r.AT)();return()=>[{code:"Escape",run:()=>e()},{code:"Backspace",run:()=>t()},{code:"Delete",run:()=>t()},{code:"KeyC",metaKey:!0,run:()=>n()},{code:"KeyX",metaKey:!0,run:()=>{n(),t()}},{code:"KeyD",metaKey:!0,run:()=>o()}]}},10322:(e,t,n)=>{n.d(t,{t:()=>r});const r=e=>e instanceof HTMLAnchorElement||e instanceof HTMLAreaElement||e instanceof HTMLInputElement||e instanceof HTMLSelectElement||e instanceof HTMLTextAreaElement||e instanceof HTMLButtonElement||e instanceof HTMLIFrameElement},64142:(e,t,n)=>{n.d(t,{_:()=>s});var r=n(50119),o=n(59061);const s=()=>{const e=(0,r.LR)(),t=(0,r.z7)(),n=(0,r.ti)(),s=(0,r.Rb)(),i=(0,r.Nl)(),a=(0,r.L$)(),l=(0,r.AF)(),c=(0,r.J1)(),d=(0,r.fm)(),{pianoRollStore:u}=(0,o.g)();return()=>[{code:"KeyC",metaKey:!0,run:n},{code:"KeyX",metaKey:!0,run:()=>{n(),s()}},{code:"KeyV",metaKey:!0,run:i},{code:"KeyD",metaKey:!0,run:a},{code:"KeyA",metaKey:!0,run:l},{code:"KeyQ",run:c},{code:"KeyT",run:()=>u.openTransposeDialog=!0},{code:"Delete",run:s},{code:"Backspace",run:s},{code:"ArrowUp",shiftKey:!0,run:()=>d(12)},{code:"ArrowUp",run:()=>d(1)},{code:"ArrowDown",shiftKey:!0,run:()=>d(-12)},{code:"ArrowDown",run:()=>d(-1)},{code:"ArrowRight",run:e,enabled:()=>"pencil"==u.mouseMode},{code:"ArrowLeft",run:t,enabled:()=>"pencil"==u.mouseMode},{code:"Escape",run:()=>u.resetSelection()}]}},161:(e,t,n)=>{n.d(t,{r:()=>u});var r=n(69229),o=n(13917),s=n(2316),i=n(59061),a=n(97233),l=n(94724),c=n(29279),d=n(62540);const u=(0,r.PA)((e=>{let{close:t}=e;const{song:n}=(0,i.g)(),r=null!==n.cloudSongId,{createNewSong:u,openSong:h,saveSong:m,saveAsSong:g,renameSong:p,importSong:x,importSongLegacy:f,exportSong:v,publishSong:y}=(0,s.R)();return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(l.Dr,{onClick:async()=>{t(),await u()},children:(0,d.jsx)(a.Oj,{name:"new-song"})}),(0,d.jsx)(l.Nj,{}),(0,d.jsx)(l.Dr,{onClick:async()=>{t(),await h()},children:(0,d.jsx)(a.Oj,{name:"open-song"})}),(0,d.jsx)(l.Dr,{onClick:async()=>{t(),await m()},disabled:n.isSaved,children:(0,d.jsx)(a.Oj,{name:"save-song"})}),(0,d.jsx)(l.Dr,{onClick:async()=>{t(),await g()},disabled:!r,children:(0,d.jsx)(a.Oj,{name:"save-as"})}),(0,d.jsx)(l.Dr,{onClick:async()=>{t(),await p()},disabled:!r,children:(0,d.jsx)(a.Oj,{name:"rename"})}),(0,d.jsx)(l.Nj,{}),!o.Ye&&(0,d.jsx)(c.z,{onChange:async e=>{t(),await f(e)},children:(0,d.jsx)(l.Dr,{children:(0,d.jsx)(a.Oj,{name:"import-midi"})})}),o.Ye&&(0,d.jsx)(l.Dr,{onClick:async()=>{t(),await x()},children:(0,d.jsx)(a.Oj,{name:"import-midi"})}),(0,d.jsx)(l.Dr,{onClick:async()=>{t(),await v()},children:(0,d.jsx)(a.Oj,{name:"export-midi"})}),(0,d.jsx)(l.Nj,{}),(0,d.jsx)(l.Dr,{onClick:async()=>{t(),await y()},disabled:!r,children:(0,d.jsx)(a.Oj,{name:"publish"})})]})}))},52506:(e,t,n)=>{n.d(t,{m:()=>c});var r=n(69229),o=n(53416),s=n(59061),i=n(97233),a=n(94724),l=n(62540);const c=(0,r.PA)((e=>{let{close:t}=e;const{song:n}=(0,s.g)(),{createNewSong:r,openSong:c,saveSong:d,saveAsSong:u,downloadSong:h}=(0,o.P)();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.Dr,{onClick:async()=>{t(),await r()},children:(0,l.jsx)(i.Oj,{name:"new-song"})}),(0,l.jsx)(a.Nj,{}),(0,l.jsx)(a.Dr,{onClick:async()=>{t(),await c()},children:(0,l.jsx)(i.Oj,{name:"open-song"})}),(0,l.jsx)(a.Dr,{onClick:async()=>{t(),await d()},disabled:null===n.fileHandle,children:(0,l.jsx)(i.Oj,{name:"save-song"})}),(0,l.jsx)(a.Dr,{onClick:async()=>{t(),await u()},children:(0,l.jsx)(i.Oj,{name:"save-as"})}),(0,l.jsx)(a.Dr,{onClick:async()=>{t(),await h()},children:(0,l.jsx)(i.Oj,{name:"download-midi"})})]})}))},15818:(e,t,n)=>{n.d(t,{Q:()=>v});var r=n(96481),o=n.n(r),s=n(48390),i=n.n(s),a=n(69229),l=n(63696),c=n(13917),d=n(59061),u=n(97233),h=n(94724),m=n(161),g=n(52506),p=n(29279),x=n(77303),f=n(62540);const v=(0,a.PA)((()=>{const{rootViewStore:e,exportStore:t,authStore:{authUser:n}}=(0,d.g)(),r=e.openDrawer,s=()=>e.openDrawer=!1,a=(0,l.useRef)(null);return(0,f.jsxs)(h.W1,{open:r,onOpenChange:t=>e.openDrawer=t,trigger:(0,f.jsxs)(x.oz,{ref:a,onClick:(0,l.useCallback)((()=>e.openDrawer=!0),[]),id:"tab-file",children:[(0,f.jsx)("span",{style:{marginLeft:"0.25rem"},children:(0,f.jsx)(u.Oj,{name:"file"})}),(0,f.jsx)(i(),{style:{width:"1rem",marginLeft:"0.25rem"}})]}),children:[null===n&&c.Ye&&(0,f.jsx)(g.m,{close:s}),null===n&&!c.Ye&&(0,f.jsx)(p.h,{close:s}),n&&(0,f.jsx)(m.r,{close:s}),null===n&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(h.Nj,{}),(0,f.jsxs)(h.Dr,{onClick:()=>{s(),e.openSignInDialog=!0},children:[(0,f.jsx)(o(),{style:{marginRight:"0.5em"}}),(0,f.jsx)(u.Oj,{name:"please-sign-up"})]})]}),(0,f.jsx)(h.Nj,{}),(0,f.jsx)(h.Dr,{onClick:()=>{s(),t.openExportDialog=!0},children:(0,f.jsx)(u.Oj,{name:"export-audio"})})]})}))},29279:(e,t,n)=>{n.d(t,{h:()=>d,z:()=>c});var r=n(69229),o=n(53416),s=n(97233),i=n(94724),a=n(62540);const l="OpenButtonInputFile",c=e=>{let{onChange:t,children:n,accept:r}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{accept:r,style:{display:"none"},id:l,type:"file",onChange:t}),(0,a.jsx)("label",{htmlFor:l,children:n})]})},d=(0,r.PA)((e=>{let{close:t}=e;const{createNewSong:n,openSongLegacy:r,downloadSong:l}=(0,o.P)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Dr,{onClick:async()=>{t(),await n()},children:(0,a.jsx)(s.Oj,{name:"new-song"})}),(0,a.jsx)(i.Nj,{}),(0,a.jsx)(c,{onChange:async e=>{t(),await r(e)},accept:"audio/midi",children:(0,a.jsx)(i.Dr,{children:(0,a.jsx)(s.Oj,{name:"open-song"})})}),(0,a.jsx)(i.Dr,{onClick:async()=>{t(),await l()},children:(0,a.jsx)(s.Oj,{name:"save-song"})})]})}))},77303:(e,t,n)=>{n.d(t,{Ic:()=>C,Vx:()=>E,oz:()=>S,pO:()=>A});var r=n(46287),o=n(63696),s=n(76129),i=n.n(s),a=n(73303),l=n.n(a),c=n(50813),d=n.n(c),u=n(69229),h=n(92234),m=n(59061),g=n(69673),p=n(97233),x=n(96016),f=n(15818),v=n(49500),y=n(62540),j=function(e){return(0,y.jsx)("svg",{...e,children:(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M32 22.5h64c5.523 0 10 4.477 10 10v64c0 5.523-4.477 10-10 10H32c-5.523 0-10-4.477-10-10v-64c0-5.523 4.477-10 10-10Zm-16 10c0-8.837 7.163-16 16-16h64c8.837 0 16 7.163 16 16v64c0 8.837-7.163 16-16 16H32c-8.837 0-16-7.163-16-16v-64Zm57.694 28H54.306v8h19.388v-8ZM64 40.5h32v8H64v-8Zm0 40H32v8h32v-8Z"})})};j.defaultProps={width:"128",height:"128",xmlns:"http://www.w3.org/2000/svg"};var k=function(e){return(0,y.jsx)("svg",{...e,children:(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M72 22H56v50h-4v34h26V72h-6V22Zm12 50v34h12c5.523 0 10-4.477 10-10V32c0-5.523-4.477-10-10-10h-8v50h-4Zm0 40H32c-8.837 0-16-7.163-16-16V32c0-8.837 7.163-16 16-16h64c8.837 0 16 7.163 16 16v64c0 8.837-7.163 16-16 16H84ZM40 72h6v34H32c-5.523 0-10-4.477-10-10V32c0-5.523 4.477-10 10-10h8v50Z"})})};k.defaultProps={width:"128",height:"128",xmlns:"http://www.w3.org/2000/svg"};var b=function(e){return(0,y.jsx)("svg",{...e,children:(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M106 64c0 23.196-18.804 42-42 42S22 87.196 22 64s18.804-42 42-42 42 18.804 42 42Zm6 0c0 26.51-21.49 48-48 48S16 90.51 16 64s21.49-48 48-48 48 21.49 48 48ZM67 40a3 3 0 1 0-6 0v25.243L77.879 82.12a3 3 0 1 0 4.242-4.242L67 62.757V40Z"})})};b.defaultProps={width:"128",height:"128",xmlns:"http://www.w3.org/2000/svg"};const w=(0,r.A)("div",{target:"e1bvc78p3"})("display:flex;flex-direction:row;background:",(e=>{let{theme:t}=e;return t.darkBackgroundColor}),";height:3rem;flex-shrink:0;-webkit-app-region:drag;padding:",(()=>{if((0,h.r)())switch((0,h.u)()){case"Windows":return"0 0 0 0";case"macOS":return"0 0 0 76px"}}),";"),S=(0,r.A)("div",{target:"e1bvc78p2"})("display:flex;flex-direction:row;align-items:center;padding:0.5rem 1rem;font-size:0.75rem;border-top:solid 0.1rem transparent;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";cursor:pointer;-webkit-app-region:none;&.active{color:",(e=>{let{theme:t}=e;return t.textColor}),";background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";border-top-color:",(e=>{let{theme:t}=e;return t.themeColor}),";}&:hover{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}a{color:inherit;text-decoration:none;}"),C=(0,r.A)("span",{target:"e1bvc78p1"})({name:"11304en",styles:"margin-left:0.5rem;@media (max-width: 850px){display:none;}"}),T=(0,r.A)("div",{target:"e1bvc78p0"})({name:"1ff36h2",styles:"flex-grow:1"}),A={width:"1.3rem",height:"1.3rem",fill:"currentColor"},E=(0,u.PA)((()=>{const{rootViewStore:e,router:t}=(0,m.g)(),n=(0,o.useCallback)((()=>{t.path="/track"}),[t]),r=(0,o.useCallback)((()=>{t.path="/arrange"}),[t]),s=(0,o.useCallback)((()=>{t.path="/tempo"}),[t]),a=(0,o.useCallback)((()=>{e.openSettingDialog=!0}),[e]),c=(0,o.useCallback)((()=>{e.openHelp=!0}),[e]);return(0,y.jsxs)(w,{children:[!(0,h.r)()&&(0,y.jsx)(f.Q,{}),(0,y.jsx)(x.m,{title:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(p.Oj,{name:"switch-tab"})," [",g.t.cmdOrCtrl,"+1]"]}),delayDuration:500,children:(0,y.jsxs)(S,{className:"/track"===t.path?"active":void 0,onMouseDown:n,children:[(0,y.jsx)(k,{style:A,viewBox:"0 0 128 128"}),(0,y.jsx)(C,{children:(0,y.jsx)(p.Oj,{name:"piano-roll"})})]})}),(0,y.jsx)(x.m,{title:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(p.Oj,{name:"switch-tab"})," [",g.t.cmdOrCtrl,"+2]"]}),delayDuration:500,children:(0,y.jsxs)(S,{className:"/arrange"===t.path?"active":void 0,onMouseDown:r,children:[(0,y.jsx)(j,{style:A,viewBox:"0 0 128 128"}),(0,y.jsx)(C,{children:(0,y.jsx)(p.Oj,{name:"arrange"})})]})}),(0,y.jsx)(x.m,{title:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(p.Oj,{name:"switch-tab"})," [",g.t.cmdOrCtrl,"+3]"]}),delayDuration:500,children:(0,y.jsxs)(S,{className:"/tempo"===t.path?"active":void 0,onMouseDown:s,children:[(0,y.jsx)(b,{style:A,viewBox:"0 0 128 128"}),(0,y.jsx)(C,{children:(0,y.jsx)(p.Oj,{name:"tempo"})})]})}),(0,y.jsx)(T,{}),!(0,h.r)()&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(S,{onClick:a,children:[(0,y.jsx)(d(),{style:A}),(0,y.jsx)(C,{children:(0,y.jsx)(p.Oj,{name:"settings"})})]}),(0,y.jsxs)(S,{onClick:c,children:[(0,y.jsx)(l(),{style:A}),(0,y.jsx)(C,{children:(0,y.jsx)(p.Oj,{name:"help"})})]}),(0,y.jsxs)(S,{children:[(0,y.jsx)(i(),{style:A}),(0,y.jsx)(C,{children:(0,y.jsx)("a",{href:"https://discord.gg/XQxzNdDJse",target:"_blank",children:"Discord"})})]})]}),(0,y.jsx)(v.u,{})]})}))},49500:(e,t,n)=>{n.d(t,{u:()=>p});var r=n(83785),o=n(83055),s=n.n(o),i=n(69229),a=n(63696),l=n(52932),c=n(92234),d=n(59061),u=n(97233),h=n(94724),m=n(77303),g=n(62540);const p=(0,i.PA)((()=>{const{rootViewStore:e,authStore:{authUser:t}}=(0,d.g)(),[n,o]=(0,a.useState)(!1),i=(0,r.u)(),p=(0,a.useRef)(null);return null===t?(0,g.jsxs)(m.oz,{onClick:()=>{(0,c.r)()?window.electronAPI.openAuthWindow():e.openSignInDialog=!0,o(!1)},children:[(0,g.jsx)(s(),{style:m.pO}),(0,g.jsx)(m.Ic,{children:(0,g.jsx)(u.Oj,{name:"sign-in"})})]}):(0,g.jsxs)(h.W1,{open:n,onOpenChange:o,trigger:(0,g.jsxs)(m.oz,{ref:p,children:[(0,g.jsx)("img",{style:{...m.pO,borderRadius:"0.65rem",border:`1px solid ${i.dividerColor}`},src:t.photoURL??void 0}),(0,g.jsx)(m.Ic,{children:t.displayName})]}),children:[(0,g.jsx)(h.Dr,{onClick:()=>{null!==t&&window.open(`https://signal.vercel.app/users/${t.uid}`),o(!1)},children:(0,g.jsx)(u.Oj,{name:"profile"})}),(0,g.jsx)(h.Dr,{onClick:()=>{e.openUserSettingsDialog=!0},children:(0,g.jsx)(u.Oj,{name:"user-settings"})}),(0,g.jsx)(h.Dr,{onClick:async()=>{await l.j2.signOut(),o(!1)},children:(0,g.jsx)(u.Oj,{name:"sign-out"})})]})}))},14461:(e,t,n)=>{n.d(t,{I:()=>c});var r=n(69229),o=n(63696),s=n(92234),i=n(59061),a=n(97233),l=n(62540);const c=(0,r.PA)((()=>{const{songStore:e}=(0,i.g)(),t=(0,a.B2)();return(0,o.useEffect)((()=>{const n=n=>{if(!e.song.isSaved){const e=t["confirm-close"];(0,s.r)()?(n.returnValue=!1,n.preventDefault(),window.electronAPI.showMessageBox({type:"question",message:e,buttons:[t.close,t.cancel]}).then((e=>{0===e&&window.electronAPI.closeMainWindow()}))):n.returnValue=e}};return window.addEventListener("beforeunload",n),()=>{window.removeEventListener("beforeunload",n)}}),[]),(0,l.jsx)(l.Fragment,{})}))},85654:(e,t,n)=>{n.d(t,{f:()=>a});var r=n(97233),o=n(66459),s=n(5513),i=n(62540);const a=e=>{let{open:t,message:n,onClose:a}=e;return(0,i.jsxs)(o.lG,{open:t,onOpenChange:a,children:[(0,i.jsx)(o.L3,{children:(0,i.jsx)(r.Oj,{name:"initialize-error"})}),(0,i.jsx)(o.Cf,{children:n}),(0,i.jsx)(o.ii,{children:(0,i.jsx)(s.$,{onClick:a,children:(0,i.jsx)(r.Oj,{name:"close"})})})]})}},61229:(e,t,n)=>{n.d(t,{c:()=>g});var r=n(20994),o=n(69229),s=n(63696),i=n(50119),a=n(11735),l=n(13917),c=n(92234),d=n(59061),u=n(97233),h=n(85654),m=n(62540);const g=(0,o.PA)((()=>{const e=(0,d.g)(),t=(0,i.pC)(),n=(0,a.r3)(),[o,g]=(0,s.useState)(!1),[p,x]=(0,s.useState)(""),{show:f}=(0,r.p1)(),v=(0,u.B2)();return(0,s.useEffect)((()=>{(async()=>{await(async()=>{const t=f(v.initializing);try{await e.init()}catch(e){g(!0),x(e.message)}finally{t()}})(),await(async()=>{const e=new URLSearchParams(window.location.search).get("open");if(e){const r=f(v["loading-external-midi"]);try{const r=await n(e);t(r)}catch(e){g(!0),x(e.message)}finally{r()}}})(),await(async()=>{if(!(0,c.r)())return;const e=f(v["loading-file"]);try{const e=await window.electronAPI.getArgument();if(e){const n=await window.electronAPI.readFile(e),r=(0,l.z6)(n,e);t(r)}}catch(e){g(!0),x(e.message)}finally{e()}})()})()}),[]),(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(h.f,{open:o,message:p,onClose:()=>g(!1)})})}))},37676:(e,t,n)=>{n.d(t,{H:()=>h});var r=n(38990),o=n.n(r),s=n(69229),i=n(63696),a=n(59061),l=n(97233),c=n(44541),d=n(96016),u=n(62540);const h=(0,s.PA)((()=>{const{pianoRollStore:e}=(0,a.g)();return(0,u.jsx)(d.m,{title:(0,u.jsx)(l.Oj,{name:"event-list"}),children:(0,u.jsx)(c.I,{selected:e.showEventList,onMouseDown:(0,i.useCallback)((t=>{t.preventDefault(),e.showEventList=!e.showEventList}),[]),children:(0,u.jsx)(o(),{style:{width:"1.2rem",fill:"currentColor"}})})})}))},65977:(e,t,n)=>{n.d(t,{o:()=>d});var r=n(69229),o=n(63696),s=n(59061),i=n(16053),a=n(44541),l=n(6980),c=n(62540);const d=(0,r.PA)((()=>{const{pianoRollStore:e,pianoRollStore:{selectedTrack:t}}=(0,s.g)(),n=(0,o.useCallback)((()=>{const n=t;if(void 0===n)return;const r=n.programNumber;e.instrumentBrowserSetting={isRhythmTrack:n.isRhythmTrack,programNumber:r??0},e.openInstrumentBrowser=!0}),[e,t]);if(void 0===t)return(0,c.jsx)(c.Fragment,{});const{programNumber:r}=t,d=i.g[(0,i.h)(r??0)];return(0,c.jsxs)(a.I,{onMouseDown:e=>{e.preventDefault(),n()},children:[(0,c.jsx)("span",{style:{marginRight:"0.5rem"},children:d}),(0,c.jsx)("span",{children:(0,c.jsx)(l.a,{track:t})})]})}))},39774:(e,t,n)=>{n.d(t,{x:()=>m});var r=n(46287),o=n(69229),s=n(63696),i=n(50119),a=n(59061),l=n(97233),c=n(60962),d=n(62540);const u=(0,r.A)("div",{target:"e11enm5t1"})({name:"qjcow2",styles:"display:flex;flex-grow:1;max-width:8rem;min-width:5rem;margin-left:1rem;margin-right:2rem"}),h=(0,r.A)("div",{target:"e11enm5t0"})("display:flex;align-items:center;margin-right:0.5rem;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";"),m=(0,o.PA)((()=>{const{pianoRollStore:{currentPan:e,selectedTrackId:t}}=(0,a.g)(),n=(0,i.ed)(),r=(0,s.useCallback)((e=>n(t,e)),[n,t]),o=e??64;return(0,d.jsxs)(u,{children:[(0,d.jsx)(h,{children:(0,d.jsx)(l.Oj,{name:"pan"})}),(0,d.jsx)(c.A,{value:o,onChange:e=>r(e),onDoubleClick:()=>r(64),min:0,max:127,defaultValue:64,minStepsBetweenThumbs:1,marks:[64]})]})}))},92504:(e,t,n)=>{n.d(t,{D:()=>l});var r=n(69229),o=n(63696),s=n(59061),i=n(76600),a=n(62540);const l=(0,r.PA)((()=>{const{pianoRollStore:e}=(0,s.g)(),{autoScroll:t}=e,n=(0,o.useCallback)((()=>e.autoScroll=!e.autoScroll),[e]);return(0,a.jsx)(i.X,{onClick:n,selected:t})}))},62444:(e,t,n)=>{n.d(t,{l:()=>l});var r=n(69229),o=n(63696),s=n(59061),i=n(16051),a=n(62540);const l=(0,r.PA)((()=>{const{pianoRollStore:e}=(0,s.g)(),{quantize:t,isQuantizeEnabled:n}=e,r=(0,o.useCallback)((t=>{e.quantize=t}),[e]),l=(0,o.useCallback)((()=>{e.isQuantizeEnabled=!e.isQuantizeEnabled}),[e]);return(0,a.jsx)(i.A,{value:t,enabled:n,onSelect:r,onClickSwitch:l})}))},10155:(e,t,n)=>{n.d(t,{C:()=>l});var r=n(69229),o=n(63696),s=n(59061),i=n(16139),a=n(62540);const l=(0,r.PA)((()=>{const{pianoRollStore:e}=(0,s.g)();return(0,a.jsx)(i.y,{mouseMode:e.mouseMode,onSelect:(0,o.useCallback)((t=>e.mouseMode=t),[])})}))},14557:(e,t,n)=>{n.d(t,{c:()=>v});var r=n(46287),o=n(90829),s=n(99677),i=n(81244),a=n(37676),l=n(65977),c=n(39774),d=n(92504),u=n(62444),h=n(10155),m=n(84206),g=n(78155),p=n(62540);const x=(0,r.A)("div",{target:"e4nwxol1"})({name:"1twx5wq",styles:"width:1rem"}),f=(0,r.A)("div",{target:"e4nwxol0"})({name:"1ff36h2",styles:"flex-grow:1"}),v=()=>(0,p.jsxs)(s.M,{children:[(0,p.jsx)(i.D,{}),(0,p.jsx)(m.H,{}),(0,p.jsx)(a.H,{}),(0,p.jsx)(x,{}),(0,p.jsx)(l.o,{}),(0,p.jsx)(o.A,{}),(0,p.jsx)(g.S,{}),(0,p.jsx)(c.x,{}),(0,p.jsx)(f,{}),(0,p.jsx)(h.C,{}),(0,p.jsx)(u.l,{}),(0,p.jsx)(d.D,{})]})},84206:(e,t,n)=>{n.d(t,{H:()=>u});var r=n(46287),o=n(69229),s=n(63696),i=n(59061),a=n(8008),l=n(62540);const c=(0,r.A)("span",{target:"e1x5aaya1"})({name:"adnvm0",styles:"font-weight:bold;margin-right:2em;font-size:1rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:14rem;min-width:3em"}),d=(0,r.A)("input",{target:"e1x5aaya0"})("font-size:inherit;font-family:inherit;border:",(e=>{let{theme:t}=e;return t.dividerColor})," 1px solid;color:inherit;height:2rem;padding:0 0.5rem;box-sizing:border-box;border-radius:4px;margin-right:1em;background:#00000017;outline:none;"),u=(0,o.PA)((()=>{const{pianoRollStore:{selectedTrack:e}}=(0,i.g)(),[t,n]=(0,s.useState)(!1);return void 0===e?(0,l.jsx)(l.Fragment,{}):(0,l.jsx)(l.Fragment,{children:t?(0,l.jsx)(d,{defaultValue:e.name??"",ref:e=>e?.focus(),onKeyPress:t=>{"Enter"===t.key&&(e.setName(t.currentTarget.value),n(!1))},onKeyDown:e=>{"Escape"===e.key&&n(!1)},onBlur:()=>n(!1)}):(0,l.jsx)(c,{onDoubleClick:()=>n(!0),children:(0,l.jsx)(a.x,{track:e})})})}))},78155:(e,t,n)=>{n.d(t,{S:()=>g});var r=n(46287),o=n(4126),s=n.n(o),i=n(69229),a=n(63696),l=n(50119),c=n(59061),d=n(60962),u=n(62540);const h=(0,r.A)("div",{target:"eg9rc0n1"})({name:"1vyxjlb",styles:"display:flex;flex-grow:1;max-width:8rem;min-width:5rem;margin-left:1rem;margin-right:1rem;align-items:center"}),m=(0,r.A)(s(),{target:"eg9rc0n0"})("width:1.3rem;height:2rem;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";margin-right:0.5rem;"),g=(0,i.PA)((()=>{const{pianoRollStore:{currentVolume:e,selectedTrackId:t}}=(0,c.g)(),n=(0,l.J2)(),r=e??100,o=(0,a.useCallback)((e=>n(t,e)),[n,t]);return(0,u.jsxs)(h,{children:[(0,u.jsx)(m,{}),(0,u.jsx)(d.A,{value:r,onChange:e=>o(e),max:127,minStepsBetweenThumbs:1})]})}))},75710:(e,t,n)=>{n.d(t,{A:()=>f});var r=n(83785),o=n(17243),s=n(69229),i=n(63696),a=n(50119),l=n(92770),c=n(78439),d=n(59061),u=n(61508),h=n(24719),m=n(87680),g=n(62540);const p=(0,s.PA)((e=>{let{rulerStore:t,onMouseDown:n,style:s}=e;const{player:p,player:{loop:x}}=(0,d.g)(),f=(0,a.UI)(),v=(0,r.u)(),{onContextMenu:y,menuProps:j}=(0,c.E)(),[k,b]=(0,i.useState)(null),[w,S]=(0,i.useState)(0),C=l.PE.rulerHeight,{canvasWidth:T,transform:A,scrollLeft:E}=t.parent,{beats:I,timeSignatures:M,quantizer:O}=t,P=(0,i.useCallback)((e=>{const n=t.getTick(e.nativeEvent.offsetX),r=O.round(n);e.nativeEvent.ctrlKey?p.setLoopBegin(r):e.nativeEvent.altKey?p.setLoopEnd(r):p.position=r}),[O,p]),D=(0,i.useCallback)((e=>{const r=(e=>{const t=A.getTick(20);return(0,o.findLast)(M,(n=>n.tick<e&&n.tick+t>=e))})(t.getTick(e.nativeEvent.offsetX));void 0!==r?(((e,n)=>{2==n.detail?b(e):(t.selectedTimeSignatureEventIds=[e.id],2===n.button&&(S(t.getQuantizedTick(n.nativeEvent.offsetX)),y(n)))})(r,e),P(e)):2==e.button?(S(t.getQuantizedTick(e.nativeEvent.offsetX)),y(e)):(t.selectedTimeSignatureEventIds=[],P(e)),n?.(e)}),[O,p,E,A,M]),N=(0,i.useCallback)((e=>{e.clearRect(0,0,T,C),e.save(),e.translate(.5-E,0),function(e,t,n,r){e.strokeStyle=r.secondaryTextColor,e.lineWidth=1,e.beginPath();const o=n.length>1&&n[1].x-n[0].x<=5;n.forEach((n=>{let{beat:s,measure:i,x:a}=n;const l=0===s;l?(e.moveTo(a,t/2),e.lineTo(a,t)):o||(e.moveTo(a,.8*t),e.lineTo(a,t)),!l||o&&i%2!=0||(e.textBaseline="top",e.font=`12px ${r.canvasFont}`,e.fillStyle=r.secondaryTextColor,e.fillText(`${i+1}`,a+2,2))})),e.closePath(),e.stroke()}(e,C,I,v),null!==x&&function(e,t,n,r,o){e.lineWidth=1,e.fillStyle=t.enabled?o.themeColor:o.secondaryTextColor,e.strokeStyle=t.enabled?o.themeColor:o.secondaryTextColor,e.beginPath();const s=r.getX(t.begin),i=r.getX(t.end);if(null!==t.begin){const t=s;e.moveTo(t,0),e.lineTo(t,n),e.moveTo(t,0),e.lineTo(t+8,0),e.lineTo(t,8)}if(null!==t.end){const t=i;e.moveTo(t,0),e.lineTo(t,n),e.moveTo(t,0),e.lineTo(t-8,0),e.lineTo(t,8)}e.closePath(),e.fill(),e.stroke()}(e,x,C,A,v),function(e,t,n,r,o){e.textBaseline="bottom",e.font=`11px ${o.canvasFont}`,n.forEach((n=>{const s=r.getX(n.tick),i=`${n.numerator}/${n.denominator}`,a=e.measureText(i),l=a.actualBoundingBoxAscent+a.actualBoundingBoxDescent;e.fillStyle=n.isSelected?o.themeColor:o.secondaryBackgroundColor;const c=l+8;!function(e,t,n,r,o,s){e.beginPath(),e.moveTo(t,n),e.lineTo(t+r+s,n),e.lineTo(t+r,n+o),e.lineTo(t,n+o),e.lineTo(t,n),e.closePath(),e.fill()}(e,s,t-c,a.width+4,c,l),e.fillStyle=n.isSelected?o.onSurfaceColor:o.textColor,e.fillText(i,s+2,t-2)}))}(e,C,M,A,v),e.restore()}),[T,A,E,I,M,x,v]),R=(0,i.useCallback)((()=>{b(null)}),[]),z=(0,i.useCallback)((e=>{let{numerator:n,denominator:r}=e;t.selectedTimeSignatureEventIds.forEach((e=>{f(e,n,r)}))}),[f]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(u.A,{draw:N,width:T,height:C,onMouseDown:D,onContextMenu:e=>e.preventDefault(),style:s}),(0,g.jsx)(h.r,{...j,rulerStore:t,tick:w}),(0,g.jsx)(m.I,{open:null!=k,initialNumerator:k?.numerator,initialDenominator:k?.denominator,onClose:R,onClickOK:z})]})}));function x(e,t){return(0,o.isEqual)(e.style,t.style)}const f=i.memo(p,x)},68044:(e,t,n)=>{n.d(t,{d:()=>o});var r=n(59061);const o=()=>{const{pianoRollStore:e}=(0,r.g)();return{onMouseDown(t,n){e.selectedNoteIds.push(n)}}}},61278:(e,t,n)=>{n.d(t,{j:()=>o});var r=n(59061);const o=()=>{const{pianoRollStore:e}=(0,r.g)();return{onMouseDown(){e.toggleTool(),e.notesCursor="crosshair"}}}},81304:(e,t,n)=>{n.d(t,{P:()=>i});var r=n(2265),o=n(59061),s=n(6017);const i=()=>{const{song:{timebase:e},pianoRollStore:t,pianoRollStore:{transform:n,selectedTrack:i,quantizer:a,newNoteVelocity:l},pushHistory:c}=(0,o.g)(),d=(0,s.Kv)();return{onMouseDown(o){if(o.shiftKey)return;const s=t.getLocal(o),{tick:u,noteNumber:h}=n.getNotePoint(s);if(void 0===i||null==i.channel||!r.i.isValid(h))return;c();const m=i.isRhythmTrack?a.round(u):a.floor(u),g=i.isRhythmTrack?e/8:t.lastNoteDuration??a.unit,p=i.addEvent({type:"channel",subtype:"note",noteNumber:h,tick:m,velocity:l,duration:g});void 0!==p&&d.onMouseDown(o,p.id)}}}},88854:(e,t,n)=>{n.d(t,{r:()=>l});var r=n(50119),o=n(51382),s=n(40540),i=n(54015),a=n(59061);const l=()=>{const{pianoRollStore:e,pianoRollStore:{transform:t,quantizer:n,selectedTrack:l},player:c,controlStore:d}=(0,a.g)();return{onMouseDown(a){if(void 0===l)return;const u=e.getLocal(a),h=t.getNotePointFractional(u),m=u;c.isPlaying||(c.position=n.round(h.tick)),d.selectedEventIds=[],e.selection=s.L.fromPoints(h,h),(0,i.R)(a,{onMouseMove:(r,i)=>{const a=o.b.add(m,i),l=t.getNotePointFractional(a);e.selection=s.L.fromPoints({...h,tick:n.round(h.tick)},{...l,tick:n.round(l.tick)})},onMouseUp:()=>{const{selection:t}=e;null!==t&&(e.selectedNoteIds=(0,r.XA)(l.events,t).map((e=>e.id)))}})}}}},6017:(e,t,n)=>{n.d(t,{H:()=>c,Kv:()=>d,eb:()=>l});var r=n(50119),o=n(59061),s=n(22095),i=n(77024);const a=e=>()=>{const{pianoRollStore:t,pianoRollStore:{selectedTrack:n,selectedNoteIds:a}}=(0,o.g)(),l=(0,r.eE)(),c=(0,r.mG)(),d=(0,r.Yr)(),u=(0,i.H)();return{onMouseDown(r,o){if(void 0===n||void 0===n.channel)return;const i=n.getEventById(o);if(null==i||!(0,s.Fb)(i))return;a.includes(o)||l(o);const h=t.selectedNoteIds,{channel:m}=n;c({...i,channel:m});let g=i.noteNumber;u.onMouseDown(r,{type:"note",position:e,noteId:o},h.filter((e=>e!==o)).map((t=>({type:"note",position:e,noteId:t}))),{onChange(e,r){let{oldPosition:i,newPosition:a}=r;const l=n.getEventById(o);null!=l&&(0,s.Fb)(l)&&(i.tick!==a.tick&&(t.lastNoteDuration=l.duration),i.noteNumber!==a.noteNumber&&l.noteNumber!==g&&(d({noteNumber:g,channel:m}),c({noteNumber:l.noteNumber,channel:m,velocity:l.velocity}),g=l.noteNumber))},onMouseUp(){d({noteNumber:g,channel:m})},onClick(e){e.shiftKey||l(o)}})}}},l=a("left"),c=a("right"),d=a("center")},73041:(e,t,n)=>{n.d(t,{c:()=>s});var r=n(54015),o=n(59061);const s=()=>{const{pianoRollStore:e}=(0,o.g)();return{onMouseDown(){(0,r.b)({onMouseMove:t=>{e.scrollBy(t.movementX,t.movementY),e.autoScroll=!1}})}}}},40432:(e,t,n)=>{n.d(t,{D:()=>o});var r=n(77024);const o=()=>{const e=(0,r.H)();return{onMouseDown(t,n){e.onMouseDown(t,{type:"selection",position:"left"},n.map((e=>({type:"note",position:"left",noteId:e}))))}}}},31945:(e,t,n)=>{n.d(t,{g:()=>o});var r=n(77024);const o=()=>{const e=(0,r.H)();return{onMouseDown(t,n){e.onMouseDown(t,{type:"selection",position:"right"},n.map((e=>({type:"note",position:"right",noteId:e}))))}}}},77024:(e,t,n)=>{n.d(t,{H:()=>d});var r=n(51382),o=n(71229),s=n(3354),i=n(54015),a=n(59061),l=n(52013);const c=(e,t)=>({tick:void 0!==t.tickRange?o.Q.clamp(t.tickRange,e.tick):e.tick,noteNumber:void 0!==t.noteNumberRange?o.Q.clamp(t.noteNumberRange,e.noteNumber):e.noteNumber}),d=()=>{const{pianoRollStore:e,pianoRollStore:{isQuantizeEnabled:t,transform:n,quantizer:o},pushHistory:d}=(0,a.g)();return{onMouseDown(a,u){let h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],m=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const g=e.getDraggablePosition(u);if(null===g)return;let p=!1;const x=e.getLocal(a),f=n.getNotePoint(x),v=s.T.sub(g,f),y=h.map((t=>e.getDraggablePosition(t)));(0,i.R)(a,{onMouseMove:(i,a)=>{const f=!i.shiftKey&&t,j=f?o.unit:l.G,k=e.getDraggableArea(u,j);if(null===k)return;const b=e.getDraggablePosition(u);if(null===b)return;const w=(()=>{const e=r.b.add(x,a),t=s.T.add(n.getNotePoint(e),v),i=f?{tick:o.round(t.tick),noteNumber:t.noteNumber}:t;return c(i,k)})();if(s.T.equals(w,b))return;const S=s.T.sub(w,g),C=h.map(((t,n)=>{const r=y[n];if(null===r)return null;const o=e.getDraggableArea(t,j);if(null===o)return null;const i=s.T.add(r,S);return c(i,o)}));p||(p=!0,d()),e.updateDraggable(u,w),h.forEach(((t,n)=>{const r=C[n];null!==r&&null!==r&&e.updateDraggable(t,r)})),m?.onChange?.(i,{oldPosition:b,newPosition:w})},onMouseUp:e=>{m?.onMouseUp?.(e)},onClick:e=>{m?.onClick?.(e)}})}}}},91375:(e,t,n)=>{n.d(t,{C:()=>s});var r=n(50119),o=n(77024);const s=()=>{const e=(0,o.H)(),t=(0,r.R8)();return{onMouseDown:(n,r)=>(n.metaKey&&t(),e.onMouseDown(n,{type:"selection",position:"center"},r.map((e=>({type:"note",position:"center",noteId:e})))))}}},26254:(e,t,n)=>{n.d(t,{J:()=>o});var r=n(59061);const o=()=>{const{pianoRollStore:e,pianoRollStore:{selectedTrack:t,selectedNoteIds:n}}=(0,r.g)();return{onMouseDown(r,o){void 0!==t&&0!==n.length&&(e.selectedNoteIds=n.filter((e=>e!==o)))}}}},74168:(e,t,n)=>{n.d(t,{p:()=>i});var r=n(51382),o=n(54015),s=n(59061);const i=()=>{const{pianoRollStore:e,pianoRollStore:{selectedTrack:t},pushHistory:n}=(0,s.g)(),i=r=>{void 0!==t&&(n(),t.removeEvent(r),e.selectedNoteIds=e.selectedNoteIds.filter((e=>e!==r)))};return{onMouseDown(t){const n=e.getLocal(t),s=e.getNotes(n);s.length>0&&i(s[0].id),(0,o.R)(t,{onMouseMove:(t,o)=>{const s=r.b.add(n,o),a=e.getNotes(s);a.length>0&&i(a[0].id)}})}}}},63988:(e,t,n)=>{n.d(t,{p:()=>l});var r=n(50119),o=n(51382),s=n(40540),i=n(54015),a=n(59061);const l=()=>{const{pianoRollStore:e,pianoRollStore:{transform:t,quantizer:n},player:l,controlStore:c}=(0,a.g)();return{onMouseDown(a){const d=e.getLocal(a),u=t.getNotePoint(d),h=d;l.isPlaying||(l.position=n.round(u.tick)),c.selectedEventIds=[],e.selection=s.L.fromPoints(u,u),(0,i.R)(a,{onMouseMove:(n,r)=>{const i=o.b.add(h,r),a=t.getNotePoint(i);e.selection=s.L.fromPoints(u,a)},onMouseUp:()=>{const{selection:t,selectedTrack:n}=e;null!==t&&void 0!==n&&(e.selectedNoteIds=(0,r.XA)(n.events,t).map((e=>e.id)),e.selection=null)}})}}}},84038:(e,t,n)=>{n.d(t,{m:()=>c});var r=n(63696),o=n(59061),s=n(61278),i=n(73041),a=n(14206),l=n(52013);const c=()=>{const{pianoRollStore:e,pianoRollStore:{mouseMode:t}}=(0,o.g)(),[n,c]=(0,r.useState)(!1),d=(0,a._)(),u=(0,l.n)(),h=(()=>{switch(t){case"pencil":return d;case"selection":return u}})(),m=(0,i.c)(),g=(0,s.j)();return{onMouseDown(e){const t=e.nativeEvent;c(!0),function(e){return 1===e.button?m:2===e.button&&e.detail%2==0?g:h}(t).onMouseDown(t)},onMouseMove(t){const r=t.nativeEvent;if(!n){const t=h.getCursor(r);e.notesCursor=t}},onMouseUp(){c(!1)}}}},14206:(e,t,n)=>{n.d(t,{_:()=>d});var r=n(59061),o=n(68044),s=n(81304),i=n(6017),a=n(26254),l=n(74168),c=n(63988);const d=()=>{const{pianoRollStore:e}=(0,r.g)(),t=(0,l.p)(),n=(0,s.P)(),d=(0,c.p)(),m=(0,i.Kv)(),g=(0,i.eb)(),p=(0,i.H)(),x=(0,a.J)(),f=(0,o.d)();return{onMouseDown(r){const o=e.getLocal(r),s=e.getNotes(o),i=e.selectedTrack?.isRhythmTrack??!1;switch(r.button){case 0:if(!(s.length>0))return r.shiftKey||r.metaKey?d.onMouseDown(r):n.onMouseDown(r);{if(r.detail%2==0)return t.onMouseDown(r);const e=s[0];if(r.shiftKey)e.isSelected?x.onMouseDown(r,e.id):f.onMouseDown(r,e.id);else switch(h(o,e,i)){case"center":return m.onMouseDown(r,e.id);case"left":return g.onMouseDown(r,e.id);case"right":return p.onMouseDown(r,e.id)}}break;case 2:return t.onMouseDown(r);default:return null}},getCursor(t){const n=e.getLocal(t),r=e.getNotes(n),o=e.selectedTrack?.isRhythmTrack??!1;if(r.length>0){const e=h(n,r[0],o);return u(e)}return"auto"}}},u=e=>{switch(e){case"center":return"move";case"left":return"w-resize";case"right":return"e-resize"}},h=(e,t,n)=>{if(null===t)return console.warn("no item"),"center";const r=e.x-t.x;if(n)return"center";const o=Math.min(t.width/3,8);return r<=o?"left":t.width-r<=o?"right":"center"}},52013:(e,t,n)=>{n.d(t,{G:()=>l,n:()=>c});var r=n(59061),o=n(88854),s=n(40432),i=n(31945),a=n(91375);const l=10,c=()=>{const{pianoRollStore:e,pianoRollStore:{selectionBounds:t,selectedNoteIds:n}}=(0,r.g)(),l=(0,a.C)(),c=(0,s.D)(),u=(0,i.g)(),h=(0,o.r)();return{onMouseDown(r){if(r.relatedTarget)return null;const o=e.getLocal(r);if(0===r.button){if(null===t)return h.onMouseDown(r);switch(d(t,o)){case"center":return l.onMouseDown(r,n);case"right":return u.onMouseDown(r,n);case"left":return c.onMouseDown(r,n);case"outside":return h.onMouseDown(r)}}return null},getCursor(n){const r=e.getLocal(n);switch(null===t?"outside":d(t,r)){case"center":return"move";case"left":return"w-resize";case"right":return"e-resize";case"outside":return"crosshair"}}}};function d(e,t){const n=e;if(!(n.x<=t.x&&n.x+n.width>=t.x&&n.y<=t.y&&n.y+n.height>=t.y))return"outside";const r=t.x-n.x,o=Math.min(n.width/3,8);return r<=o?"left":n.width-r<=o?"right":"center"}},57112:(e,t,n)=>{n.d(t,{y:()=>S});var r=n(83785),o=n(44308),s=n.n(o),i=n(69229),a=n(63696),l=n(92770),c=n(51382),d=n(64659),u=n(44569),h=n(54015),m=n(78439),g=n(59061),p=n(6358),x=n(61508),f=n(75442),v=n(62540);const y=[0,1,0,1,0,0,1,0,1,0,1,0];function j(e,t,n){e.lineWidth=1,e.strokeStyle=n,e.beginPath(),e.moveTo(0,0),e.lineTo(t,0),e.closePath(),e.stroke()}function k(e,t,n,r,o,s,i){o&&(e.fillStyle=r.themeColor,e.fillRect(0,.5,t,n)),s&&(e.fillStyle=r.themeColor,e.fillRect(t-4,.5,4,n)),i&&j(e,t,r.dividerColor)}function b(e,t,n,r,o,s,i,a){const l=Math.round(r/2);e.fillStyle=i,e.fillRect(0,.5,t,r),s&&(e.fillStyle=o.themeColor,e.fillRect(t-4,.5,4,r)),e.lineWidth=1,e.strokeStyle=a,e.beginPath(),e.moveTo(t,l),e.lineTo(n,l),e.closePath(),e.stroke()}function w(e,t,n,r,o,s){const i=t-5;e.textAlign="right",e.textBaseline="middle",e.font=`12px ${o}`,e.fillStyle=s,e.fillText((0,u.bF)(r),i,n/2)}const S=(0,i.PA)((()=>{const e=(0,r.u)(),{pianoRollStore:t,pianoRollStore:{keySignature:n,transform:{numberOfKeys:o,pixelsPerKey:i},previewingNoteNumbers:u},player:S}=(0,g.g)(),C=l.PE.keyWidth,T=l.PE.keyWidth*l.PE.blackKeyWidthRatio,[A,E]=(0,a.useState)(new Set),{onContextMenu:I,menuProps:M}=(0,m.E)(),O=new Set([...A,...u]),P=(0,a.useCallback)((t=>{const r=null!==n?d.u.getIntervals(n):[];!function(e,t,n,r,o,i,a,l){e.save(),e.translate(0,.5),e.fillStyle=i.pianoKeyWhite,e.fillRect(0,0,n,r*o);const c=[...Array(o).keys()],d=c.filter((e=>0===y[e%y.length])),u=c.filter((e=>1===y[e%y.length])),h=c.filter((e=>e%12==0));j(e,n,i.dividerColor);for(const t of d){let s=(o-t-1)*r;const c=a.has(t),d=l.includes(t%12),u=t%12==4||t%12==11;let h=r;1===y[(t-1)%y.length]&&(h+=.5*r),1===y[(t+1)%y.length]&&(s-=.5*r,h+=.5*r),e.save(),e.translate(0,s),k(e,n,h,i,c,d,u),e.restore()}const m=function(e,t){const n=e.createLinearGradient(0,0,t,0);return n.addColorStop(0,"rgba(33, 33, 33, 1.000)"),n.addColorStop(.895,"rgba(96, 93, 93, 1.000)"),n.addColorStop(.924,"rgba(48, 48, 48, 1.000)"),n.addColorStop(1,"rgba(0, 0, 0, 1.000)"),n}(e,t),g=s()(i.dividerColor).alpha(.3).string();for(const s of u){const c=(o-s-1)*r,d=a.has(s),u=l.includes(s%12);e.save(),e.translate(0,c),b(e,t,n,r,i,u,d?i.themeColor:m,g),e.restore()}for(const t of h){const s=(o-t-1)*r;e.save(),e.translate(0,s),w(e,n,r,t,i.canvasFont,i.secondaryTextColor),e.restore()}e.restore()}(t,T,C,i,o,e,O,r)}),[o,e,O,n,i,T]),D=(0,a.useCallback)((e=>{if(0!==e.button)return;function n(e,t){const n=o-t/i,r=Math.floor(n);return e>T&&0!==y[r%y.length]?Math.round(n)-Math.floor(n)?r+1:r-1:r}const r={x:e.nativeEvent.offsetX,y:e.nativeEvent.offsetY},{selectedTrack:s}=t,a=s?.channel??0;let l=n(r.x,r.y);S.sendEvent((0,p.d1)(0,a,l,127)),E(new Set([l])),(0,h.R)(e.nativeEvent,{onMouseMove(e,t){const o=c.b.add(r,t),s=n(o.x,o.y);s!==l&&(S.sendEvent((0,p.dG)(0,a,l,0)),S.sendEvent((0,p.d1)(0,a,s,127)),l=s,E(new Set([s])))},onMouseUp(e){S.sendEvent((0,p.dG)(0,a,l,0)),E(new Set)}})}),[o,i]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(x.A,{draw:P,width:C,height:i*o,onMouseDown:D,onContextMenu:I}),(0,v.jsx)(f.a,{...M})]})}))},75442:(e,t,n)=>{n.d(t,{a:()=>u});var r=n(69229),o=n(63696),s=n(59061),i=n(97233),a=n(5909),l=n(95229),c=n(94724),d=n(62540);const u=(0,r.PA)((e=>{const{handleClose:t}=e,{pianoRollStore:n}=(0,s.g)(),[r,u]=(0,o.useState)(!1);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(a.t,{...e,children:[(0,d.jsx)(c.Dr,{onClick:()=>{null===n.keySignature&&(n.keySignature={scale:"major",key:0}),u(!0),t()},children:(0,d.jsx)(i.Oj,{name:"show-scale"})}),(0,d.jsx)(c.Dr,{onClick:()=>{n.keySignature=null,t()},disabled:null===n.keySignature,children:(0,d.jsx)(i.Oj,{name:"hide-scale"})})]}),(0,d.jsx)(l.C,{open:r,onOpenChange:u})]})}))},72993:(e,t,n)=>{n.d(t,{A:()=>j});var r=n(46287),o=n(96604),s=n.n(o),i=n(17243),a=n(69229),l=n(63696),c=n(92770),d=n(25649),u=n(59061),h=n(54773),m=n(49422),g=n(4487),p=n(29966),x=n(62540);const f=(0,r.A)("div",{target:"e1p0ipbr2"})("flex-grow:1;background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";position:relative;"),v=(0,r.A)("div",{target:"e1p0ipbr1"})({name:"1fjjas",styles:"flex-grow:1;position:relative;.alphaContent{position:absolute;top:0;left:0;}"}),y=(0,r.A)("div",{target:"e1p0ipbr0"})("border-top:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";height:calc(100% - 17px);"),j=(0,a.PA)((()=>{const{pianoRollStore:e,pianoRollStore:{scaleX:t,scaleY:n,scrollLeft:r,scrollTop:o,transform:a,contentWidth:j,contentHeight:k}}=(0,u.g)(),b=(0,l.useRef)(null),w=s()(b),S=(0,l.useRef)(null),{height:C=0}=s()(S),T=(0,l.useCallback)((()=>e.scaleAroundPointX(.2,c.PE.keyWidth)),[t,e]),A=(0,l.useCallback)((()=>e.scaleAroundPointX(-.2,c.PE.keyWidth)),[t,e]),E=(0,l.useCallback)((()=>e.scaleX=1),[e]),I=(0,l.useCallback)((()=>e.scaleAroundPointY(.2,0)),[n,e]),M=(0,l.useCallback)((()=>e.scaleAroundPointY(-.2,0)),[n,e]),O=(0,l.useCallback)((()=>e.scaleY=1),[e]),P=(0,l.useCallback)((t=>{if(t.shiftKey&&(t.altKey||t.ctrlKey)){let n=(0,d.T)(t.nativeEvent)?.02*t.deltaY:.01*t.deltaX;n=(0,i.clamp)(n,-.15,.15),e.scaleAroundPointY(n,t.nativeEvent.offsetY)}else if(t.altKey||t.ctrlKey){const n=(0,d.T)(t.nativeEvent)?.01:-.01,r=(0,i.clamp)(t.deltaY*n,-.15,.15);e.scaleAroundPointX(r,t.nativeEvent.offsetX)}else{const n=(0,d.T)(t.nativeEvent)?1:a.pixelsPerKey*c.De,r=t.deltaY*n;e.scrollBy(-t.deltaX,-r)}}),[e,a]),D=(0,l.useCallback)((()=>{e.setScrollTopInPixels(e.scrollTop)}),[e]);return(0,x.jsxs)(f,{ref:b,children:[(0,x.jsxs)(p.W,{split:"horizontal",minSize:50,defaultSize:"60%",onChange:D,children:[(0,x.jsxs)(v,{onWheel:P,ref:S,children:[(0,x.jsx)(g.d,{width:w.width,height:C}),(0,x.jsx)(m.J,{scrollOffset:o,contentLength:k,onScroll:(0,l.useCallback)((t=>e.setScrollTopInPixels(t)),[e]),onClickScaleUp:I,onClickScaleDown:M,onClickScaleReset:O})]}),(0,x.jsx)(y,{children:(0,x.jsx)(h.A,{})})]}),(0,x.jsx)(m.j,{scrollOffset:r,contentLength:j,onScroll:(0,l.useCallback)((t=>{e.setScrollLeftInPixels(t),e.autoScroll=!1}),[e]),onClickScaleUp:T,onClickScaleDown:A,onClickScaleReset:E})]})}))},93790:(e,t,n)=>{n.d(t,{l:()=>v});var r=n(83785),o=n(44308),s=n.n(o),i=n(51080),a=n(69229),l=n(63696),c=n(71229),d=n(72343),u=n(51046),h=n(59061),m=n(22095),g=n(30453),p=n(94995),x=n(69120),f=n(62540);const v=(0,a.PA)((e=>{let{zIndex:t,trackId:n}=e;const{song:o,pianoRollStore:{transform:a,scrollLeft:v,canvasWidth:y}}=(0,h.g)(),j=(0,r.u)(),k=o.getTrack(n);if(void 0===k)return(0,f.jsx)(f.Fragment,{});const b=(0,l.useMemo)((()=>k.events.filter(m.Fb).filter((0,u.L)(c.Q.fromLength(a.getTick(v),a.getTick(y))))),[v,y,a.horizontalId,k.events]),w=(0,l.useMemo)((()=>b.map((e=>({...k.isRhythmTrack?a.getDrumRect(e):a.getRect(e),id:e.id,velocity:127,isSelected:!1})))),[b,a,k.isRhythmTrack]),S=(0,d.B)(s()(j.ghostNoteColor)),C=i.v_(i.vt()),T=void 0!==k.color?(0,g.I)(k.color):null,A=null!==T?i.Cc(i.vt(),T,S,.7):S;return k.isRhythmTrack?(0,f.jsx)(p.G,{strokeColor:C,rects:w,inactiveColor:C,activeColor:A,selectedColor:A,zIndex:t}):(0,f.jsx)(x.D,{rects:w,strokeColor:C,inactiveColor:C,activeColor:A,selectedColor:A,zIndex:t+.1})}))},30362:(e,t,n)=>{n.d(t,{v:()=>i});var r=n(47547),o=n(46128),s=n(62540);const i=e=>{let{rect:t,color:n,highlightedColor:i,laneColors:a,height:l,zIndex:c}=e;const d=(0,r.I1)();return(0,s.jsx)(r.oW,{createShader:o.e,createBuffer:e=>new o.L(e),uniforms:{projectionMatrix:d,color:n,highlightedColor:i,laneColors:a,height:l},buffer:t,zIndex:c})}},5277:(e,t,n)=>{n.d(t,{q:()=>g});var r=n(83785),o=n(44308),s=n.n(o),i=n(69229),a=n(63696),l=n(92770),c=n(64659),d=n(72343),u=n(59061),h=n(30362),m=n(62540);const g=(0,i.PA)((e=>{let{zIndex:t}=e;const n=(0,r.u)(),{pianoRollStore:{scrollTop:o,canvasWidth:i,canvasHeight:g,scaleY:p,keySignature:x}}=(0,u.g)(),f=(0,a.useMemo)((()=>{const e=(0,d.B)(s()(n.pianoWhiteKeyLaneColor)),t=(0,d.B)(s()(n.pianoBlackKeyLaneColor));if(null===x)return Float32Array.from(Array(12).fill(0).map(((n,r)=>c.u.getIntervals({scale:"major",key:0}).includes(r)?e:t)).flat());const r=function(e){const t=c.u.getIntervals(e);return new Array(12).fill(!1).map(((e,n)=>t.includes(n%12)))}(x),o=(0,d.B)(s()(n.pianoHighlightedLaneColor)),i=r.map((t=>t?o:e));return Float32Array.from(i.flat())}),[n,x]),v=(0,a.useMemo)((()=>(0,d.B)(s()(n.pianoLaneEdgeColor))),[n]),y=(0,a.useMemo)((()=>(0,d.B)(s()(n.editorGridColor))),[n]);return(0,m.jsx)(h.v,{rect:{x:0,y:o,width:i,height:g},color:v,highlightedColor:y,laneColors:f,height:p*l.PE.keyHeight,zIndex:t})}))},94995:(e,t,n)=>{n.d(t,{G:()=>a});var r=n(47547),o=n(97468),s=n(89436),i=n(62540);const a=e=>{let{rects:t,strokeColor:n,selectedColor:a,inactiveColor:l,activeColor:c,zIndex:d}=e;const u=(0,r.I1)();return(0,i.jsx)(r.oW,{createShader:o.G,createBuffer:e=>new s.r(e),uniforms:{projectionMatrix:u,strokeColor:n,selectedColor:a,inactiveColor:l,activeColor:c},buffer:t,zIndex:d})}},69120:(e,t,n)=>{n.d(t,{D:()=>i});var r=n(47547),o=n(89436),s=n(62540);const i=e=>{let{rects:t,strokeColor:n,inactiveColor:i,activeColor:a,selectedColor:l,zIndex:c}=e;const d=(0,r.I1)();return(0,s.jsx)(r.oW,{createShader:o.K,createBuffer:e=>new o.r(e),uniforms:{projectionMatrix:d,strokeColor:n,selectedColor:l,inactiveColor:i,activeColor:a},buffer:t,zIndex:c})}},74411:(e,t,n)=>{n.d(t,{u:()=>m});var r=n(83785),o=n(44308),s=n.n(o),i=n(69229),a=n(72343),l=n(59061),c=n(30453),d=n(94995),u=n(69120),h=n(62540);const m=(0,i.PA)((e=>{let{zIndex:t}=e;const{pianoRollStore:{notes:n,selectedTrack:o}}=(0,l.g)(),i=(0,r.u)();if(void 0===o)return(0,h.jsx)(h.Fragment,{});const m=s()(void 0!==o.color?(0,c.g)(o.color):i.themeColor),g=(0,a.B)((0,a.N)(m,i.isLightContent,.3)),p=(0,a.B)(m.lighten(.7)),x=(0,a.B)(s()(i.backgroundColor)),f=(0,a.B)(m);return(0,h.jsxs)(h.Fragment,{children:[o.isRhythmTrack&&(0,h.jsx)(d.G,{strokeColor:g,rects:n,inactiveColor:x,activeColor:f,selectedColor:p,zIndex:t}),!o.isRhythmTrack&&(0,h.jsx)(u.D,{strokeColor:g,inactiveColor:x,activeColor:f,selectedColor:p,rects:n,zIndex:t+.1})]})}))},55930:(e,t,n)=>{n.d(t,{F:()=>y});var r=n(83785),o=n(47547),s=n(69229),i=n(63696),a=n(28632),l=n(78439),c=n(59061),d=n(51618),u=n(98423),h=n(31563),m=n(84038),g=n(86653),p=n(93790),x=n(5277),f=n(74411),v=n(62540);const y=(0,s.PA)((e=>{let{width:t,height:n}=e;const{pianoRollStore:s,pianoRollStore:{notesCursor:y,scrollLeft:j,scrollTop:k,rulerStore:{beats:b},cursorX:w,selectionBounds:S,ghostTrackIds:C}}=(0,c.g)(),T=(0,m.m)(),{onContextMenu:A,menuProps:E}=(0,l.E)(),I=(0,r.u)(),M=(0,i.useCallback)((e=>{if("selection"===s.mouseMode)return e.stopPropagation(),void A(e)}),[]);(0,i.useEffect)((()=>{s.canvasWidth=t}),[t]),(0,i.useEffect)((()=>{s.canvasHeight=n}),[n]);const O=(0,i.useMemo)((()=>(0,a.L)(-j,0)),[j]),P=(0,i.useMemo)((()=>(0,a.L)(0,-k)),[j,k]),D=(0,i.useMemo)((()=>(0,a.L)(-j,-k)),[j,k]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(o.om,{width:t,height:n,style:{cursor:y,background:I.pianoWhiteKeyLaneColor},onContextMenu:M,onMouseDown:T.onMouseDown,onMouseMove:T.onMouseMove,onMouseUp:T.onMouseUp,children:[(0,v.jsx)(o.dL,{matrix:P,children:(0,v.jsx)(x.q,{zIndex:0})}),(0,v.jsxs)(o.dL,{matrix:O,children:[(0,v.jsx)(d.g,{height:n,beats:b,zIndex:1}),(0,v.jsx)(u.b,{x:w,height:n,zIndex:5})]}),(0,v.jsxs)(o.dL,{matrix:D,children:[C.map((e=>(0,v.jsx)(p.l,{trackId:e,zIndex:2},e))),(0,v.jsx)(f.u,{zIndex:3}),(0,v.jsx)(h.L,{rect:S,zIndex:4})]})]}),(0,v.jsx)(g.E,{...E})]})}))},97468:(e,t,n)=>{n.d(t,{G:()=>o});var r=n(47547);const o=e=>new r.Mt(e,"#version 300 es\n      precision lowp float;\n\n      uniform mat4 projectionMatrix;\n\n      in vec4 position;\n      in vec4 bounds;  // [x, y, width, height]\n      in vec2 state; // [velocity, isSelected]\n\n      out vec4 vBounds;\n      out vec2 vPosition;\n      out vec2 vState;\n\n      void main() {\n        vec4 transformedPosition = vec4((position.xy * bounds.zw + bounds.xy), position.zw);\n        gl_Position = projectionMatrix * transformedPosition;\n        vBounds = bounds;\n        vPosition = transformedPosition.xy;\n        vState = state;\n      }\n    ","#version 300 es\n      precision lowp float;\n\n      uniform vec4 strokeColor;\n      uniform vec4 selectedColor;\n      uniform vec4 inactiveColor;\n      uniform vec4 activeColor;\n\n      in vec4 vBounds;\n      in vec2 vPosition;\n      in vec2 vState;\n\n      out vec4 outColor;\n\n      void main() {\n        float border = 1.0;\n        \n        float r = vBounds.w / 2.0;\n        vec2 center = vBounds.xy + vBounds.zw / 2.0;\n        float len = length(vPosition - center);\n\n        if (len < r - border) {\n          // if selected, draw selected color\n          // otherwise, draw color based on velocity by mixing active and inactive color\n          outColor = mix(mix(inactiveColor, activeColor, vState.x), selectedColor, vState.y);\n        } else if (len < r) {\n          outColor = strokeColor;\n        }\n      }\n    ",{position:{size:2,type:e.FLOAT},bounds:{size:4,type:e.FLOAT,divisor:1},state:{size:2,type:e.FLOAT,divisor:1}},{projectionMatrix:(0,r.z$)(),strokeColor:(0,r.fz)(),inactiveColor:(0,r.fz)(),activeColor:(0,r.fz)(),selectedColor:(0,r.fz)()})},46128:(e,t,n)=>{n.d(t,{L:()=>i,e:()=>a});var r=n(47547),o=n(18264),s=n.n(o);class i{constructor(e){this.vertexArray=e}update(e){const t=(0,r.pl)(e);this.vertexArray.updateBuffer("position",new Float32Array(t))}get vertexCount(){return 6}}const a=e=>new r.Mt(e,"#version 300 es\n      precision lowp float;\n\n      uniform mat4 projectionMatrix;\n      in vec4 position;\n      out vec4 vPosition;\n\n      void main() {\n        gl_Position = projectionMatrix * position;\n        vPosition = position;\n      }\n    ","#version 300 es\n      precision lowp float;\n\n      uniform vec4 color;\n      uniform vec4 highlightedColor;\n      uniform vec4 laneColors[12];\n      uniform float height;\n      \n      in vec4 vPosition;\n\n      out vec4 outColor;\n      \n      void main() {\n        float screenHeight = height * 128.0;\n        float modY = mod(screenHeight - vPosition.y, height * 12.0);\n        float lineWidth = 1.0;\n\n        if (modY < height - lineWidth) {\n          outColor = laneColors[0];\n        } else if (modY < height) {\n          outColor = color;\n        } else if (modY < height * 2.0 - lineWidth) {\n          outColor = laneColors[1];\n        } else if (modY < height * 2.0) {\n          outColor = color;\n        } else if (modY < height * 3.0 - lineWidth) {\n          outColor = laneColors[2];\n        } else if (modY < height * 3.0) {\n          outColor = color;\n        } else if (modY < height * 4.0 - lineWidth) {\n          outColor = laneColors[3];\n        } else if (modY < height * 4.0) {\n          outColor = color;\n        } else if (modY < height * 5.0 - lineWidth) {\n          outColor = laneColors[4];\n        } else if (modY < height * 5.0) {\n          outColor = color;\n        } else if (modY < height * 6.0 - lineWidth) {\n          outColor = laneColors[5];\n        } else if (modY < height * 6.0) {\n          outColor = color;\n        } else if (modY < height * 7.0 - lineWidth) {\n          outColor = laneColors[6];\n        } else if (modY < height * 7.0) {\n          outColor = color;\n        } else if (modY < height * 8.0 - lineWidth) {\n          outColor = laneColors[7];\n        } else if (modY < height * 8.0) {\n          outColor = color;\n        } else if (modY < height * 9.0 - lineWidth) {\n          outColor = laneColors[8];\n        } else if (modY < height * 9.0) {\n          outColor = color;\n        } else if (modY < height * 10.0 - lineWidth) {\n          outColor = laneColors[9];\n        } else if (modY < height * 10.0) {\n          outColor = color;\n        } else if (modY < height * 11.0 - lineWidth) {\n          outColor = laneColors[10];\n        } else if (modY < height * 11.0) {\n          outColor = color;\n        } else if (modY < height * 12.0 - lineWidth) {\n          outColor = laneColors[11];\n        } else if (modY < height * 12.0) {\n          outColor = highlightedColor;\n        }\n      }\n    ",{position:{size:2,type:e.FLOAT}},{projectionMatrix:(0,r.z$)(),color:(0,r.fz)(),highlightedColor:(0,r.fz)(),laneColors:{initialValue:new Float32Array(48),isEqual:s(),upload:(e,t,n)=>e.uniform4fv(t,n,0,48)},height:(0,r.Z7)()})},89436:(e,t,n)=>{n.d(t,{K:()=>s,r:()=>o});var r=n(47547);class o{_instanceCount=0;boundsBuffer=(()=>new Float32Array(0))();stateBuffer=(()=>new Float32Array(0))();constructor(e){this.vertexArray=e,this.vertexArray.updateBuffer("position",new Float32Array((0,r.pl)({x:0,y:0,width:1,height:1})))}update(e){(this.boundsBuffer.length<4*e.length||this.stateBuffer.length<2*e.length)&&(this.boundsBuffer=new Float32Array(4*e.length),this.stateBuffer=new Float32Array(2*e.length));for(let t=0;t<e.length;t++){const n=e[t];this.boundsBuffer[4*t+0]=n.x,this.boundsBuffer[4*t+1]=n.y,this.boundsBuffer[4*t+2]=n.width,this.boundsBuffer[4*t+3]=n.height,this.stateBuffer[2*t+0]=n.velocity/127,this.stateBuffer[2*t+1]=n.isSelected?1:0}this.vertexArray.updateBuffer("bounds",this.boundsBuffer.subarray(0,4*e.length)),this.vertexArray.updateBuffer("state",this.stateBuffer.subarray(0,2*e.length)),this._instanceCount=e.length}get vertexCount(){return 6}get instanceCount(){return this._instanceCount}}const s=e=>new r.Mt(e,"#version 300 es\n      precision lowp float;\n\n      uniform mat4 projectionMatrix;\n\n      in vec4 position;\n      in vec4 bounds;  // [x, y, width, height]\n      in vec2 state; // [velocity, isSelected]\n\n      out vec4 vBounds;\n      out vec2 vPosition;\n      out vec2 vState;\n\n      void main() {\n        vec4 transformedPosition = vec4((position.xy * bounds.zw + bounds.xy), position.zw);\n        gl_Position = projectionMatrix * transformedPosition;\n        vBounds = bounds;\n        vPosition = transformedPosition.xy;\n        vState = state;\n      }\n    ","#version 300 es\n      precision lowp float;\n\n      uniform vec4 strokeColor;\n      uniform vec4 selectedColor;\n      uniform vec4 inactiveColor;\n      uniform vec4 activeColor;\n\n      in vec4 vBounds;\n      in vec2 vPosition;\n      in vec2 vState;\n\n      out vec4 outColor;\n\n      void main() {\n        float border = 1.0;\n        float localX = vPosition.x - vBounds.x;\n        float localY = vPosition.y - vBounds.y;\n\n        float outlineTop = step(border, localY);\n        float outlineBottom = step(localY, vBounds.w - border);\n        float outlineLeft = step(border, localX);\n        float outlineRight = step(localX, vBounds.z - border);\n        \n        float isOutline = outlineTop * outlineBottom * outlineLeft * outlineRight;\n    \n        if (isOutline < 1.0) {\n          // draw outline\n          outColor = strokeColor;\n        } else {\n          // if selected, draw selected color\n          // otherwise, draw color based on velocity by mixing active and inactive color\n          outColor = mix(mix(inactiveColor, activeColor, vState.x), selectedColor, vState.y);\n        }\n      }\n    ",{position:{size:2,type:e.FLOAT},bounds:{size:4,type:e.FLOAT,divisor:1},state:{size:2,type:e.FLOAT,divisor:1}},{projectionMatrix:(0,r.z$)(),strokeColor:(0,r.fz)(),inactiveColor:(0,r.fz)(),activeColor:(0,r.fz)(),selectedColor:(0,r.fz)()})},84574:(e,t,n)=>{n.d(t,{m:()=>f});var r=n(46287),o=n(69229),s=n(59061),i=n(55782),a=n(73853),l=n(14557),c=n(19069),d=n(7101),u=n(47953),h=n(72993),m=n(29966),g=n(62540);const p=(0,r.A)("div",{target:"ez7p9kn0"})({name:"z5atxi",styles:"display:flex;flex-direction:column;flex-grow:1"}),x=e=>{let{isShow:t,pane:n,children:r,...o}=e;return t?(0,g.jsxs)(m.W,{...o,children:[n,r]}):(0,g.jsx)(g.Fragment,{children:r})},f=(0,o.PA)((()=>{const{pianoRollStore:e}=(0,s.g)(),{showTrackList:t,showEventList:n}=e;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(p,{children:[(0,g.jsx)(a.y,{}),(0,g.jsx)(l.c,{}),(0,g.jsx)("div",{style:{display:"flex",flexGrow:1,position:"relative"},children:(0,g.jsx)(x,{split:"vertical",minSize:280,pane1Style:{display:"flex"},pane2Style:{display:"flex"},isShow:t,pane:(0,g.jsx)(c.S,{}),children:(0,g.jsx)(x,{split:"vertical",minSize:240,pane1Style:{display:"flex"},pane2Style:{display:"flex"},isShow:n,pane:(0,g.jsx)(i.Ay,{}),children:(0,g.jsx)(h.A,{})})})})]}),(0,g.jsx)(d.w,{}),(0,g.jsx)(u.G,{})]})}))},4487:(e,t,n)=>{n.d(t,{d:()=>x});var r=n(46287),o=n(83785),s=n(69229),i=n(92770),a=n(59061),l=n(75710),c=n(57112),d=n(55930),u=n(62540);const h=(0,r.A)("div",{target:"eozgfpb3"})(""),m=(0,r.A)("div",{target:"eozgfpb2"})("position:absolute;left:",i.PE.keyWidth,"px;"),g=(0,r.A)("div",{target:"eozgfpb1"})("position:absolute;top:0;left:0;padding-left:",i.PE.keyWidth,"px;height:",i.PE.rulerHeight,"px;"),p=(0,r.A)("div",{target:"eozgfpb0"})({name:"1m19vma",styles:"position:absolute;left:0;top:0"}),x=(0,s.PA)((e=>{let{width:t,height:n}=e;const{pianoRollStore:r}=(0,a.g)(),{scrollTop:s}=r,x=(0,o.u)();return(0,u.jsxs)(h,{children:[(0,u.jsx)(m,{style:{top:i.PE.rulerHeight},children:(0,u.jsx)(d.F,{width:t,height:n-i.PE.rulerHeight})}),(0,u.jsx)(p,{style:{top:-s+i.PE.rulerHeight},children:(0,u.jsx)(c.y,{})}),(0,u.jsx)(g,{style:{background:x.backgroundColor,borderBottom:`1px solid ${x.dividerColor}`},children:(0,u.jsx)(l.A,{rulerStore:r.rulerStore})})]})}))},86653:(e,t,n)=>{n.d(t,{E:()=>u});var r=n(63696),o=n(50119),s=n(59061),i=n(69673),a=n(97233),l=n(5909),c=n(94724),d=n(62540);const u=r.memo((e=>{const{handleClose:t}=e,{pianoRollStore:n}=(0,s.g)(),r=n.selectedNoteIds.length>0,u=(0,o.ti)(),h=(0,o.Rb)(),m=(0,o.Nl)(),g=(0,o.L$)(),p=(0,o.J1)(),x=(0,o.fm)();return(0,d.jsxs)(l.t,{...e,children:[(0,d.jsxs)(c.Dr,{onClick:()=>{u(),h(),t()},disabled:!r,children:[(0,d.jsx)(a.Oj,{name:"cut"}),(0,d.jsxs)(l.Z,{children:[i.t.cmdOrCtrl,"+X"]})]}),(0,d.jsxs)(c.Dr,{onClick:()=>{u(),t()},disabled:!r,children:[(0,d.jsx)(a.Oj,{name:"copy"}),(0,d.jsxs)(l.Z,{children:[i.t.cmdOrCtrl,"+C"]})]}),(0,d.jsxs)(c.Dr,{onClick:()=>{m(),t()},children:[(0,d.jsx)(a.Oj,{name:"paste"}),(0,d.jsxs)(l.Z,{children:[i.t.cmdOrCtrl,"+V"]})]}),(0,d.jsxs)(c.Dr,{onClick:()=>{g(),t()},disabled:!r,children:[(0,d.jsx)(a.Oj,{name:"duplicate"}),(0,d.jsxs)(l.Z,{children:[i.t.cmdOrCtrl,"+D"]})]}),(0,d.jsxs)(c.Dr,{onClick:()=>{h(),t()},disabled:!r,children:[(0,d.jsx)(a.Oj,{name:"delete"}),(0,d.jsx)(l.Z,{children:"Del"})]}),(0,d.jsx)(c.Nj,{}),(0,d.jsxs)(c.Dr,{onClick:()=>{x(12),t()},disabled:!r,children:[(0,d.jsx)(a.Oj,{name:"one-octave-up"}),(0,d.jsx)(l.Z,{children:"Shift+↑"})]}),(0,d.jsxs)(c.Dr,{onClick:()=>{x(-12),t()},disabled:!r,children:[(0,d.jsx)(a.Oj,{name:"one-octave-down"}),(0,d.jsx)(l.Z,{children:"Shift+↓"})]}),(0,d.jsxs)(c.Dr,{onClick:()=>{n.openTransposeDialog=!0,t()},disabled:!r,children:[(0,d.jsx)(a.Oj,{name:"transpose"}),(0,d.jsx)(l.Z,{children:"T"})]}),(0,d.jsx)(c.Nj,{}),(0,d.jsxs)(c.Dr,{onClick:()=>{p(),t()},disabled:!r,children:[(0,d.jsx)(a.Oj,{name:"quantize"}),(0,d.jsx)(l.Z,{children:"Q"})]}),(0,d.jsx)(c.Dr,{onClick:()=>{n.openVelocityDialog=!0,t()},disabled:!r,children:(0,d.jsx)(a.Oj,{name:"velocity"})})]})}))},24719:(e,t,n)=>{n.d(t,{r:()=>m});var r=n(69229),o=n(63696),s=n(50119),i=n(59061),a=n(69673),l=n(97233),c=n(5909),d=n(94724),u=n(87680),h=n(62540);const m=(0,r.PA)((e=>{let{rulerStore:t,tick:n,...r}=e;const{handleClose:m}=r,{song:g,player:p}=(0,i.g)(),x=(0,s.C4)(),[f,v]=(0,o.useState)(!1),y=t.selectedTimeSignatureEventIds.length>0,j=(0,o.useCallback)((()=>{v(!0),m()}),[]),k=(0,o.useCallback)((()=>{g.conductorTrack?.removeEvents(t.selectedTimeSignatureEventIds),m()}),[g]),b=(0,o.useCallback)((()=>{p.setLoopBegin(n),m()}),[n,p]),w=(0,o.useCallback)((()=>{p.setLoopEnd(n),m()}),[n,p]),S=(0,o.useCallback)((()=>{v(!1)}),[]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(c.t,{...r,children:[(0,h.jsxs)(d.Dr,{onClick:b,children:[(0,h.jsx)(l.Oj,{name:"set-loop-start"}),(0,h.jsxs)(c.Z,{children:[a.t.cmdOrCtrl,"+Click"]})]}),(0,h.jsxs)(d.Dr,{onClick:w,children:[(0,h.jsx)(l.Oj,{name:"set-loop-end"}),(0,h.jsx)(c.Z,{children:"Alt+Click"})]}),(0,h.jsx)(d.Dr,{onClick:j,children:(0,h.jsx)(l.Oj,{name:"add-time-signature"})}),(0,h.jsx)(d.Dr,{onClick:k,disabled:!y,children:(0,h.jsx)(l.Oj,{name:"remove-time-signature"})})]}),(0,h.jsx)(u.I,{open:f,onClose:S,onClickOK:e=>{let{numerator:t,denominator:r}=e;x(n,t,r)}})]})}))},29966:(e,t,n)=>{n.d(t,{W:()=>s});var r=n(46287),o=n(28465);const s=(0,r.A)(o.A,{target:"eig1oxs0"})({name:"1q9pimx",styles:".Resizer{background:#000;opacity:0.2;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-moz-background-clip:padding;-webkit-background-clip:padding;background-clip:padding-box;}.Resizer:hover{transition:all 0.2s ease;}.Resizer.horizontal{height:11px;margin:-5px 0;border-top:5px solid rgba(255, 255, 255, 0);border-bottom:5px solid rgba(255, 255, 255, 0);cursor:row-resize;width:100%;}.Resizer.horizontal:hover{border-top:5px solid rgba(255, 255, 255, 0.5);border-bottom:5px solid rgba(255, 255, 255, 0.5);}.Resizer.vertical{width:11px;margin:0 -5px;border-left:5px solid rgba(255, 255, 255, 0);border-right:5px solid rgba(255, 255, 255, 0);cursor:col-resize;}.Resizer.vertical:hover{border-left:5px solid rgba(255, 255, 255, 0.5);border-right:5px solid rgba(255, 255, 255, 0.5);}.Resizer.disabled{cursor:not-allowed;}.Resizer.disabled:hover{border-color:transparent;}"})},87680:(e,t,n)=>{n.d(t,{I:()=>m});var r=n(46287),o=n(17243),s=n(63696),i=n(97233),a=n(66459),l=n(5513),c=n(95881),d=n(4830),u=n(62540);const h=(0,r.A)(d.A,{target:"e1omeeu90"})({name:"3bjnxn",styles:"width:3em;text-align:center;font-size:1rem;padding:0.2rem 0;&::-webkit-inner-spin-button{-webkit-appearance:none;margin:0;}"}),m=e=>{let{initialNumerator:t=4,initialDenominator:n=4,open:r,onClose:d,onClickOK:m}=e;const[g,p]=(0,s.useState)(t),[x,f]=(0,s.useState)(n);return(0,s.useEffect)((()=>{r&&(p(t),f(n))}),[r]),(0,u.jsxs)(a.lG,{open:r,onOpenChange:d,children:[(0,u.jsx)(a.L3,{children:(0,u.jsx)(i.Oj,{name:"time-signature"})}),(0,u.jsx)(a.Cf,{children:(0,u.jsxs)("div",{style:{display:"flex",alignItems:"stretch",justifyContent:"center"},children:[(0,u.jsx)(h,{value:g,type:"number",min:1,max:32,onChange:e=>p(parseInt(e.target.value)),onBlur:()=>p(Math.max(1,Math.min(32,g))),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),e.currentTarget.blur())}}),(0,u.jsx)("span",{style:{width:"3em",display:"flex",alignItems:"center",justifyContent:"center"},children:"/"}),(0,u.jsx)(c.l,{style:{minWidth:"5em"},value:x.toString(),onChange:e=>f(parseInt(e.target.value)),children:(0,o.range)(0,6).map((e=>Math.pow(2,e))).map((e=>(0,u.jsx)("option",{value:e.toString(),children:e},e)))})]})}),(0,u.jsxs)(a.ii,{children:[(0,u.jsx)(l.$,{autoFocus:!0,onClick:d,children:(0,u.jsx)(i.Oj,{name:"cancel"})}),(0,u.jsx)(l.j,{onClick:()=>{m({numerator:g,denominator:x}),d()},disabled:isNaN(g)&&g<=32&&g>0,children:(0,u.jsx)(i.Oj,{name:"ok"})})]})]})}},29869:(e,t,n)=>{n.d(t,{m:()=>v});var r=n(46287),o=n(83785),s=n(20994),i=n(22399),a=n.n(i),l=n(69229),c=n(63696),d=n(11735),u=n(59061),h=n(97233),m=n(66459),g=n(55747),p=n(5513),x=n(87944),f=n(62540);const v=(0,l.PA)((()=>{const{songStore:e,rootViewStore:t,cloudSongRepository:n,userRepository:r}=(0,u.g)(),{song:i}=e,l=(0,d.GB)(),v=(0,d.JN)(),{openPublishDialog:b}=t,[w,S]=(0,c.useState)("notPublishable"),[C,T]=(0,c.useState)(!0),A=(0,s.dj)(),E=(0,o.u)(),I=(0,h.B2)();(0,c.useEffect)((()=>{(async()=>{if(b){T(!0);const t=e.song.cloudSongId;if(null===t)return S("notPublishable"),void T(!1);const r=await n.get(t);S(r?.isPublic?"published":"publishable"),T(!1)}})()}),[b]);const M=(0,c.useCallback)((()=>t.openPublishDialog=!1),[t]);return(0,f.jsxs)(m.lG,{open:b,onOpenChange:M,style:{minWidth:"20rem"},children:[(0,f.jsx)(m.L3,{children:(0,f.jsx)(h.Oj,{name:"publish-song"})}),(0,f.jsxs)(m.Cf,{children:["publishable"===w&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{style:{marginBottom:"1rem"},children:(0,f.jsx)(h.Oj,{name:"publish-notice"})}),(0,f.jsx)(g.F,{severity:"warning",children:(0,f.jsx)(h.Oj,{name:"publish-rules"})})]}),"published"===w&&null!==i.cloudSongId&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(y,{href:k(i.cloudSongId),target:"_blank",children:[(0,f.jsx)(h.Oj,{name:"published-notice"}),(0,f.jsx)(a(),{color:E.secondaryTextColor,size:"1rem"})]}),(0,f.jsx)(x.C,{url:k(i.cloudSongId),text:I["share-my-song-text"]}),(0,f.jsx)(j,{})]})]}),(0,f.jsxs)(m.ii,{children:[(0,f.jsx)(p.$,{onClick:M,children:(0,f.jsx)(h.Oj,{name:"close"})}),"publishable"===w&&(0,f.jsx)(p.j,{onClick:async()=>{const{song:t}=e;try{T(!0);const e=await r.getCurrentUser();if(null===e)throw new Error("Failed to get current user, please re-sign in");await l(t,e),S("published"),A.success(I["song-published"])}catch(e){A.error(e.message)}finally{T(!1)}},disabled:C,children:(0,f.jsx)(h.Oj,{name:"publish"})}),"published"===w&&(0,f.jsx)(p.j,{onClick:async()=>{const{song:t}=e;try{T(!0),await v(t),S("publishable"),A.success(I["song-unpublished"])}catch(e){A.error(e.message)}finally{T(!1)}},disabled:C,children:(0,f.jsx)(h.Oj,{name:"unpublish"})})]})]})})),y=(0,r.A)("a",{target:"eqqftdk1"})("display:flex;align-items:center;color:",(e=>{let{theme:t}=e;return t.textColor}),";text-decoration:none;margin-bottom:1rem;&:hover{opacity:0.8;}"),j=(0,r.A)("div",{target:"eqqftdk0"})("margin:1rem 0 0 0;height:1px;background:",(e=>{let{theme:t}=e;return t.dividerColor}),";"),k=e=>`${window.location.origin}/songs/${e}`},93731:(e,t,n)=>{n.d(t,{w:()=>h});var r=n(46287),o=n(69229),s=n(63696),i=n(50119),a=n(13917),l=n(59061),c=n(97233),d=n(62540);const u=(0,r.A)("div",{target:"e1gahe2s0"})({name:"vhyimk",styles:"height:100%;display:flex;flex-direction:column;flex-grow:1;overflow:hidden"}),h=(0,o.PA)((e=>{let{children:t}=e;const{song:n}=(0,l.g)(),r=(0,c.B2)(),o=(0,i.pC)(),h=(0,s.useCallback)((e=>{e.preventDefault()}),[]),m=(0,s.useCallback)((async e=>{e.preventDefault();const t=e.dataTransfer.files[0];if(("audio/midi"===t.type||"audio/mid"===t.type)&&(n.isSaved||confirm(r["confirm-open"]))){const e=await(0,a.mZ)(t);o(e)}}),[n,o]);return(0,d.jsx)(u,{onDrop:m,onDragOver:h,children:t})}))},59797:(e,t,n)=>{n.d(t,{K:()=>M});var r=n(46287),o=n(69229),s=n(59061),i=n(22573),a=n(18976),l=n(73245),c=n(94025),d=n(52767),u=n(74390),h=n(35679),m=n(10713),g=n(77303),p=n(14461),x=n(61229),f=n(84574),v=n(29869),y=n(43017),j=n(12163),k=n(48930),b=n(82733),w=n(36079),S=n(71323),C=n(93731),T=n(62540);const A=(0,r.A)("div",{target:"e15sz86a1"})({name:"vhyimk",styles:"height:100%;display:flex;flex-direction:column;flex-grow:1;overflow:hidden"}),E=(0,r.A)("div",{target:"e15sz86a0"})({name:"1mxf4fi",styles:"height:100%;display:flex;flex-grow:1;flex-direction:column"}),I=(0,o.PA)((()=>{const{router:e}=(0,s.g)(),t=e.path;return(0,T.jsxs)(T.Fragment,{children:["/track"===t&&(0,T.jsx)(f.m,{}),"/tempo"===t&&(0,T.jsx)(k.t,{}),"/arrange"===t&&(0,T.jsx)(i.y,{})]})})),M=()=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(C.w,{children:(0,T.jsxs)(E,{children:[(0,T.jsx)(g.Vx,{}),(0,T.jsxs)(A,{children:[(0,T.jsx)(I,{}),(0,T.jsx)(b.Cg,{}),(0,T.jsx)(a.j,{})]})]})}),(0,T.jsx)(m.Q,{}),(0,T.jsx)(d.V,{}),(0,T.jsx)(u.u,{}),(0,T.jsx)(h.p,{}),(0,T.jsx)(j.L,{}),(0,T.jsx)(l.Y,{}),(0,T.jsx)(y.F,{}),(0,T.jsx)(c.K,{}),(0,T.jsx)(x.c,{}),(0,T.jsx)(p.I,{}),(0,T.jsx)(v.m,{}),(0,T.jsx)(S.D,{}),(0,T.jsx)(w.r,{})]})},22333:(e,t,n)=>{n.d(t,{z:()=>x});var r=n(46287),o=n(69229),s=n(59061),i=n(97233),a=n(56416),l=n(11051),c=n(66459),d=n(15467),u=n(95881),h=n(62540);const m=(0,o.PA)((()=>{const{settingStore:e}=(0,s.g)(),t=(0,i.f4)();return(0,h.jsxs)(d.J,{children:[(0,h.jsx)(i.Oj,{name:"language"}),(0,h.jsx)(u.l,{value:e.language??t,onChange:t=>e.language=t.target.value,style:{marginTop:"0.5rem"},children:[{label:"English",language:"en"},{label:"Japanese",language:"ja"},{label:"Chinese (Simplified)",language:"zh-Hans"},{label:"Chinese (Traditional)",language:"zh-Hant"}].map((e=>(0,h.jsx)("option",{value:e.language,children:e.label},e.language)))})]})})),g=(0,o.PA)((()=>{const{themeStore:e}=(0,s.g)(),{themeType:t}=e;return(0,h.jsxs)(d.J,{children:[(0,h.jsx)(i.Oj,{name:"theme"}),(0,h.jsx)(u.l,{value:t,onChange:t=>e.themeType=t.target.value,style:{marginTop:"0.5rem"},children:Object.keys(a.Z).map((e=>(0,h.jsx)("option",{value:e,children:(0,h.jsx)(l.V,{themeType:e})},e)))})]})})),p=(0,r.A)("div",{target:"e1ngx2at0"})({name:"4zk4ri",styles:"display:flex;flex-direction:column;gap:1rem"}),x=(0,o.PA)((()=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(c.L3,{children:(0,h.jsx)(i.Oj,{name:"general"})}),(0,h.jsx)(c.Cf,{children:(0,h.jsxs)(p,{children:[(0,h.jsx)(m,{}),(0,h.jsx)(g,{})]})})]})))},95090:(e,t,n)=>{n.d(t,{h:()=>v});var r=n(46287),o=n(69229),s=n(59061),i=n(97233),a=n(66459),l=n(55747),c=n(16066),d=n(571),u=n(15467),h=n(62540);const m=e=>{let{device:t,isSelected:n,onCheck:r}=e;return(0,h.jsx)(u.J,{style:{display:"flex",alignItems:"center",marginBottom:"1rem"},children:(0,h.jsx)(c.S,{checked:n,onCheckedChange:e=>r(!0===e),style:{marginRight:"0.5rem"},label:(0,h.jsxs)(h.Fragment,{children:[t.name,!t.isConnected&&" (disconnected)"]})})})},g=(0,r.A)("div",{target:"e1a3jnrs3"})(""),p=(0,r.A)("div",{target:"e1a3jnrs2"})("color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";"),x=(0,r.A)("div",{target:"e1a3jnrs1"})({name:"hw7i2k",styles:"height:2rem"}),f=(0,r.A)("div",{target:"e1a3jnrs0"})({name:"1w6g3jg",styles:"font-weight:bold;margin:1rem 0"}),v=(0,o.PA)((()=>{const{midiDeviceStore:e}=(0,s.g)(),{inputs:t,outputs:n,isLoading:r,requestError:o,enabledInputs:c,enabledOutputs:u,isFactorySoundEnabled:v}=e,y=e=>(e?.name??"")+((e.manufacturer?.length??0)>0?`(${e.manufacturer})`:""),j=e=>({id:e.id,name:y(e),isConnected:"connected"===e.state}),k=t.map((e=>({device:j(e),isSelected:c[e.id]}))),b=n.map((e=>({device:j(e),isSelected:u[e.id]})));return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(a.L3,{children:(0,h.jsx)(i.Oj,{name:"midi-settings"})}),(0,h.jsxs)(a.Cf,{children:[r&&(0,h.jsx)(d.P,{}),o&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(l.F,{severity:"warning",children:o.message}),(0,h.jsx)(x,{})]}),!r&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(f,{children:(0,h.jsx)(i.Oj,{name:"inputs"})}),(0,h.jsxs)(g,{children:[0===k.length&&(0,h.jsx)(p,{children:(0,h.jsx)(i.Oj,{name:"no-inputs"})}),k.map((t=>{let{device:n,isSelected:r}=t;return(0,h.jsx)(m,{device:n,isSelected:r,onCheck:t=>e.setInputEnable(n.id,t)},n.id)}))]}),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(x,{}),(0,h.jsx)(f,{children:(0,h.jsx)(i.Oj,{name:"outputs"})}),(0,h.jsxs)(g,{children:[(0,h.jsx)(m,{device:{id:"signal-midi-app",name:"Signal Factory Sound",isConnected:!0},isSelected:v,onCheck:t=>e.isFactorySoundEnabled=t}),b.map((t=>{let{device:n,isSelected:r}=t;return(0,h.jsx)(m,{device:n,isSelected:r,onCheck:t=>e.setOutputEnable(n.id,t)},n.id)}))]})]})]})]})]})}))},43017:(e,t,n)=>{n.d(t,{F:()=>f});var r=n(46287),o=n(69229),s=n(63696),i=n(59061),a=n(97233),l=n(66459),c=n(5513),d=n(22333),u=n(95090),h=n(85539),m=n(156),g=n(62540);const p=e=>{let{route:t}=e;switch(t){case"general":return(0,g.jsx)(d.z,{});case"midi":return(0,g.jsx)(u.h,{});case"soundfont":return(0,g.jsx)(m.H,{})}},x=(0,r.A)("div",{target:"e2pvsme0"})({name:"1bed697",styles:"flex-grow:1;min-height:24rem"}),f=(0,o.PA)((()=>{const{rootViewStore:e}=(0,i.g)(),{openSettingDialog:t}=e,[n,r]=(0,s.useState)("general"),o=(0,s.useCallback)((()=>e.openSettingDialog=!1),[e]);return(0,g.jsxs)(l.lG,{open:t,onOpenChange:o,style:{minWidth:"32rem"},children:[(0,g.jsx)(l.L3,{children:(0,g.jsx)(a.Oj,{name:"settings"})}),(0,g.jsxs)(l.Cf,{style:{display:"flex",flexDirection:"row"},children:[(0,g.jsx)(h.V,{route:n,onChange:r}),(0,g.jsx)(x,{children:(0,g.jsx)(p,{route:n})})]}),(0,g.jsx)(l.ii,{children:(0,g.jsx)(c.$,{onClick:o,children:(0,g.jsx)(a.Oj,{name:"close"})})})]})}))},85539:(e,t,n)=>{n.d(t,{V:()=>u});var r=n(46287),o=n(97233),s=n(5513),i=n(62540);const a=["general","midi","soundfont"],l=(0,r.A)(s.$,{target:"e1c2xddn1"})("display:flex;font-size:0.875rem;align-items:center;margin-bottom:0.5rem;background:",(e=>{let{theme:t,selected:n}=e;return n?t.highlightColor:"inherit"}),";"),c=(0,r.A)("div",{target:"e1c2xddn0"})({name:"e3t188",styles:"display:flex;flex-direction:column;min-width:12em;margin-right:2rem"}),d=e=>{let{route:t}=e;switch(t){case"general":return(0,i.jsx)(o.Oj,{name:"general"});case"midi":return(0,i.jsx)(o.Oj,{name:"midi"});case"soundfont":return(0,i.jsx)(o.Oj,{name:"soundfont"})}},u=e=>{let{route:t,onChange:n}=e;return(0,i.jsx)(c,{children:a.map((e=>(0,i.jsx)(l,{selected:t===e,onClick:()=>n(e),children:(0,i.jsx)(d,{route:e},e)},e)))})}},63667:(e,t,n)=>{n.d(t,{F:()=>v});var r=n(46287),o=n(44308),s=n.n(o),i=n(20994),a=n(40756),l=n.n(a),c=n(69229),d=n(63696),u=n(59061),h=n(5513),m=n(571),g=n(70612),p=n(62540);const x=(0,r.A)("div",{target:"e16rc1t13"})({name:"1c1nme9",styles:"display:flex;flex-direction:column;margin-bottom:1rem;overflow-y:auto"}),f=(0,r.A)("div",{target:"e16rc1t12"})("position:absolute;display:flex;align-items:center;justify-content:center;top:0;left:0;background-color:",(e=>{let{theme:t}=e;return s()(t.backgroundColor).alpha(.5).toString()}),";color:",(e=>{let{theme:t}=e;return t.textColor}),";width:100%;height:100%;z-index:1;"),v=(0,c.PA)((()=>{const{soundFontStore:e}=(0,u.g)(),{files:t,selectedSoundFontId:n}=e,[r,o]=(0,d.useState)(!1),s=(0,i.dj)();return(0,p.jsxs)(x,{children:[t.map((t=>(0,p.jsx)(k,{isSelected:t.id===n,item:t,onClick:async()=>{o(!0);try{await e.load(t.id)}catch(e){s.error(e.message)}finally{o(!1)}},onClickDelete:async()=>{await e.removeSoundFont(t.id)}},t.id))),r&&(0,p.jsx)(f,{children:(0,p.jsx)(m.P,{})})]})})),y=(0,r.A)(l(),{target:"e16rc1t11"})("width:1rem;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";"),j=(0,r.A)("div",{target:"e16rc1t10"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),k=e=>{let{item:t,isSelected:n,onClick:r,onClickDelete:o}=e;return(0,p.jsxs)(j,{children:[(0,p.jsx)(g.a,{label:t.name,isSelected:n,onClick:r}),t.id>=0&&(0,p.jsx)(h.$,{style:{marginLeft:"auto",display:"flex",alignItems:"center"},onClick:o,children:(0,p.jsx)(y,{})})]})}},61613:(e,t,n)=>{n.d(t,{r:()=>h});var r=n(46287),o=n(40756),s=n.n(o),i=n(69229),a=n(59061),l=n(97233),c=n(5513),d=n(62540);const u=(0,r.A)("div",{target:"e1vg3g243"})({name:"g78t84",styles:"display:flex;justify-content:flex-end;margin-top:1rem"}),h=(0,i.PA)((()=>{const{soundFontStore:e}=(0,a.g)(),{scanPaths:t}=e;return(0,d.jsxs)(d.Fragment,{children:[0===t.length&&(0,d.jsx)("p",{children:(0,d.jsx)("i",{children:"No scan paths"})}),t.map((t=>(0,d.jsx)(x,{path:t,onClickDelete:()=>(async t=>{await e.removeScanPath(t)})(t)},t))),(0,d.jsxs)(u,{children:[(0,d.jsx)(c.$,{onClick:async()=>{const t=await window.electronAPI.showOpenDirectoryDialog();t&&e.addScanPath(t)},children:(0,d.jsx)(l.Oj,{name:"add"})}),(0,d.jsx)(c.$,{onClick:()=>{e.scanSoundFonts()},children:(0,d.jsx)(l.Oj,{name:"scan"})})]})]})})),m=(0,r.A)("span",{target:"e1vg3g242"})("font-size:0.8rem;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";"),g=(0,r.A)(s(),{target:"e1vg3g241"})("width:1rem;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";"),p=(0,r.A)("div",{target:"e1vg3g240"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),x=e=>{let{path:t,onClickDelete:n}=e;return(0,d.jsxs)(p,{children:[(0,d.jsx)(m,{children:t}),(0,d.jsx)(c.$,{style:{marginLeft:"auto",display:"flex",alignItems:"center"},onClick:n,children:(0,d.jsx)(g,{})})]})}},156:(e,t,n)=>{n.d(t,{H:()=>f});var r=n(46287),o=n(69229),s=n(92234),i=n(59061),a=n(97233),l=n(66459),c=n(29279),d=n(55747),u=n(5513),h=n(63667),m=n(61613),g=n(62540);const p=(0,r.A)(u.$,{target:"e10018hp1"})({name:"8irbms",styles:"display:inline-flex;align-items:center"}),x=(0,r.A)("div",{target:"e10018hp0"})({name:"1w6g3jg",styles:"font-weight:bold;margin:1rem 0"}),f=(0,o.PA)((()=>{const{soundFontStore:e}=(0,i.g)();return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(l.L3,{children:(0,g.jsx)(a.Oj,{name:"soundfont"})}),(0,g.jsxs)(l.Cf,{children:[(0,g.jsx)(h.F,{}),!(0,s.r)()&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.z,{onChange:async t=>{t.preventDefault();const n=t.currentTarget.files?.item(0);if(n){const t=await n.arrayBuffer();e.addSoundFont({type:"local",data:t},{name:n.name})}},accept:".sf2",children:(0,g.jsx)(p,{as:"div",children:(0,g.jsx)(a.Oj,{name:"add"})})}),(0,g.jsx)(d.F,{severity:"info",style:{marginTop:"1rem"},children:(0,g.jsx)(a.Oj,{name:"soundfont-save-notice"})})]}),(0,s.r)()&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(x,{children:(0,g.jsx)(a.Oj,{name:"soundfont-location"})}),(0,g.jsx)(m.r,{})]})]})]})}))},12163:(e,t,n)=>{n.d(t,{L:()=>d});var r=n(20994),o=n(69229),s=n(63696),i=n(59061),a=n(97233),l=n(51348),c=n(62540);const d=(0,o.PA)((()=>{const{rootViewStore:e,rootViewStore:{openSignInDialog:t}}=(0,i.g)(),n=(0,r.dj)(),o=(0,a.B2)(),d=(0,s.useCallback)((()=>e.openSignInDialog=!1),[e]);return(0,c.jsx)(l.w,{open:t,onClose:d,onSuccess:async()=>{e.openSignInDialog=!1,n.success(o["success-sign-in"])},onFailure:e=>{console.warn(e)}})}))},51348:(e,t,n)=>{n.d(t,{w:()=>g});var r=n(46287),o=n(73016),s=n(66459),i=n(17354),a=n(52932),l=n(97233),c=n(55747),d=n(5513),u=n(62540);const h=(0,r.A)("span",{target:"e1p5rn1h1"})("border:1px solid currentColor;font-size:0.8rem;padding:0.1rem 0.4rem;margin-left:1em;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";"),m=(0,r.A)("div",{target:"e1p5rn1h0"})({name:"1jfrm3v",styles:"margin:1rem 0 2rem 0;line-height:1.5"}),g=e=>{let{open:t,onClose:n,onSuccess:r,onFailure:g}=e;return(0,u.jsxs)(s.lG,{open:t,onOpenChange:n,style:{minWidth:"20rem"},children:[(0,u.jsxs)(s.L3,{children:[(0,u.jsx)(l.Oj,{name:"sign-in"}),(0,u.jsx)(h,{children:"Beta"})]}),(0,u.jsxs)(s.Cf,{children:[(0,u.jsx)(c.F,{severity:"info",children:(0,u.jsx)(l.Oj,{name:"cloud-beta-warning"})}),(0,u.jsx)(m,{children:(0,u.jsx)(l.Oj,{name:"cloud-description"})}),(0,u.jsx)(o.l,{uiConfig:{signInOptions:[i.HF.PROVIDER_ID,i.Dt.PROVIDER_ID,"apple.com"],callbacks:{signInSuccessWithAuthResult:()=>(r(),!1),signInFailure:g},signInFlow:"popup"},firebaseAuth:a.j2})]}),(0,u.jsx)(s.ii,{children:(0,u.jsx)(d.$,{onClick:n,children:(0,u.jsx)(l.Oj,{name:"close"})})})]})}},29340:(e,t,n)=>{n.d(t,{m:()=>a});var r=n(69229),o=n(59061),s=n(76600),i=n(62540);const a=(0,r.PA)((()=>{const{tempoEditorStore:e}=(0,o.g)(),{autoScroll:t}=e;return(0,i.jsx)(s.X,{onClick:()=>e.autoScroll=!t,selected:t})}))},6368:(e,t,n)=>{n.d(t,{o:()=>l});var r=n(69229),o=n(63696),s=n(59061),i=n(16051),a=n(62540);const l=(0,r.PA)((()=>{const{tempoEditorStore:e}=(0,s.g)(),{quantize:t,isQuantizeEnabled:n}=e,r=(0,o.useCallback)((t=>e.quantize=t),[e]),l=(0,o.useCallback)((()=>{e.isQuantizeEnabled=!e.isQuantizeEnabled}),[e]);return(0,a.jsx)(i.A,{value:t,enabled:n,onSelect:r,onClickSwitch:l})}))},91711:(e,t,n)=>{n.d(t,{f:()=>l});var r=n(69229),o=n(63696),s=n(59061),i=n(16139),a=n(62540);const l=(0,r.PA)((()=>{const{tempoEditorStore:e}=(0,s.g)(),{mouseMode:t}=e;return(0,a.jsx)(i.y,{mouseMode:t,onSelect:(0,o.useCallback)((t=>e.mouseMode=t),[])})}))},87553:(e,t,n)=>{n.d(t,{D:()=>h});var r=n(46287),o=n(97233),s=n(99677),i=n(29340),a=n(6368),l=n(91711),c=n(62540);const d=(0,r.A)("span",{target:"e1npb7n01"})({name:"6egrdb",styles:"font-weight:bold;margin-right:2em;font-size:1rem;margin-left:0.5rem"}),u=(0,r.A)("div",{target:"e1npb7n00"})({name:"1ff36h2",styles:"flex-grow:1"}),h=()=>(0,c.jsxs)(s.M,{children:[(0,c.jsx)(d,{children:(0,c.jsx)(o.Oj,{name:"tempo"})}),(0,c.jsx)(u,{}),(0,c.jsx)(l.f,{}),(0,c.jsx)(a.o,{}),(0,c.jsx)(i.m,{})]})},12066:(e,t,n)=>{n.d(t,{r:()=>d});var r=n(51382),o=n(71229),s=n(51046),i=n(12968),a=n(54015),l=n(59061),c=n(22095);const d=()=>{const{song:{conductorTrack:e},tempoEditorStore:t}=(0,l.g)();return{onMouseDown(n,l,d){if(void 0===e)return;const u=d.fromPosition(l),h=(0,i.i)(n);t.selectedEventIds=[],t.selection={fromTick:u.tick,toTick:u.tick},(0,a.b)({onMouseMove:e=>{const n=(0,i.i)(e),o=r.b.sub(n,h),s=r.b.add(l,o),a=d.fromPosition(s);t.selection={fromTick:Math.min(u.tick,a.tick),toTick:Math.max(u.tick,a.tick)}},onMouseUp:n=>{const{selection:r}=t;null!==r&&(t.selectedEventIds=e.events.filter(c.u3).filter((0,s.F)(o.Q.create(r.fromTick,r.toTick))).map((e=>e.id)),t.selection=null)}})}}}},38604:(e,t,n)=>{n.d(t,{d:()=>d});var r=n(17243),o=n(51382),s=n(20604),i=n(26556),a=n(12968),l=n(54015),c=n(59061);const d=()=>{const{song:{conductorTrack:e},tempoEditorStore:t,tempoEditorStore:{quantizer:n},pushHistory:d}=(0,c.g)();return{onMouseDown(c,u,h,m){if(void 0===e)return;d(),t.selectedEventIds.includes(u)||(t.selectedEventIds=[u]);const g=t.selectedEventIds.map((t=>e.getEventById(t))).filter(s.EA).map((e=>({...e}))),p=g.find((e=>e.id===u));if(void 0===p)return;const x=m.fromPosition(h),f=(0,a.i)(c);(0,l.b)({onMouseMove:t=>{const s=(0,a.i)(t),l=o.b.sub(s,f),c=o.b.add(h,l),d=m.fromPosition(c),u=d.tick-x.tick,v=u-(p.tick+u-n.round(p.tick+u)),y=d.bpm-x.bpm;e.updateEvents(g.map((e=>({id:e.id,tick:Math.max(0,Math.floor(e.tick+v)),microsecondsPerBeat:Math.floor((0,i.w4)((0,r.clamp)((0,i.M)(e.microsecondsPerBeat)+y,0,m.maxBPM)))}))))}})}}}},96911:(e,t,n)=>{n.d(t,{_:()=>u});var r=n(50119),o=n(51382),s=n(26556),i=n(12968),a=n(54015),l=n(59061),c=n(6358),d=n(22095);const u=()=>{const{song:e,tempoEditorStore:{quantizer:t},pushHistory:n}=(0,l.g)();return{onMouseDown(l,u,h){const m=e.conductorTrack;if(void 0===m)return;n();const g=(0,i.i)(l),p=h.fromPosition(u),x=(0,s.w4)(p.bpm),f={...(0,c.F8)(0,Math.round(x)),tick:t.round(p.tick)};m.createOrUpdate(f);let v=p.tick,y=p.bpm;(0,a.b)({onMouseMove:e=>{const n=(0,i.i)(e),a=o.b.sub(n,g),l=o.b.add(u,a),p=Math.max(0,Math.min(h.maxBPM,h.fromPosition(l).bpm)),x=h.getTick(l.x);(0,r.rm)(m,t,d.u3,(e=>(0,c.F8)(0,(0,s.w4)(e))))(y,p,v,x),v=x,y=p}})}}}},48930:(e,t,n)=>{n.d(t,{t:()=>c});var r=n(46287),o=n(64741),s=n(87553),i=n(86589),a=n(62540);const l=(0,r.A)("div",{target:"e1llbi9p0"})({name:"1i1zgvg",styles:"display:flex;flex-direction:column;flex-grow:1;overflow:hidden"}),c=()=>(0,a.jsxs)(l,{children:[(0,a.jsx)(o.g,{}),(0,a.jsx)(s.D,{}),(0,a.jsx)(i._,{})]})},86589:(e,t,n)=>{n.d(t,{_:()=>f});var r=n(46287),o=n(83785),s=n(96604),i=n.n(s),a=n(69229),l=n(63696),c=n(92770),d=n(59061),u=n(75710),h=n(20038),m=n(85766),g=n(41749),p=n(62540);const x=(0,r.A)("div",{target:"e1mroqxo0"})("position:relative;flex-grow:1;background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";"),f=(0,a.PA)((()=>{const{tempoEditorStore:e,tempoEditorStore:{transform:t,scrollLeft:n,contentWidth:r}}=(0,d.g)(),s=(0,l.useRef)(null),a=i()(s),f=(0,l.useCallback)((t=>{e.setScrollLeftInPixels(t),e.autoScroll=!1}),[]),v=(0,o.u)(),y=Math.floor(n),j=a.width,k=a.height-c.PE.rulerHeight-h.ZW;return(0,l.useEffect)((()=>{e.canvasWidth=j,e.canvasHeight=k}),[j,k]),(0,p.jsxs)(x,{ref:s,children:[(0,p.jsx)(u.A,{rulerStore:e.rulerStore,style:{background:v.backgroundColor,borderBottom:`1px solid ${v.dividerColor}`,boxSizing:"border-box",position:"absolute",left:c.PE.keyWidth}}),(0,p.jsx)(g.W,{width:j,height:k,style:{position:"absolute",top:c.PE.rulerHeight,left:c.PE.keyWidth,backgroundColor:v.editorBackgroundColor}}),(0,p.jsx)(m.B,{width:c.PE.keyWidth,offset:c.PE.rulerHeight,transform:t}),(0,p.jsx)(h.fJ,{scrollOffset:y,contentLength:r,onScroll:f})]})}))},85766:(e,t,n)=>{n.d(t,{B:()=>c});var r=n(46287),o=n(53649),s=n.n(o),i=n(62540);const a=(0,r.A)("div",{target:"e87wik11"})("position:absolute;left:0;height:100%;background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";pointer-events:none;border-right:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";box-shadow:0px 0px 5px 0 rgba(0, 0, 0, 0.1);"),l=(0,r.A)("div",{target:"e87wik10"})({name:"uumi4b",styles:"position:relative;&>div{position:absolute;text-align:right;width:100%;padding-right:1em;box-sizing:border-box;font-size:90%;margin-top:-0.5em;}"}),c=e=>{let{width:t,transform:n,offset:r}=e;return(0,i.jsx)(a,{style:{width:t,top:r},children:(0,i.jsx)(l,{children:s()(30,n.maxBPM,30).map((e=>{const t=Math.round(n.getY(e));return(0,i.jsx)("div",{style:{top:t},children:e},e)}))})})}},46185:(e,t,n)=>{n.d(t,{q:()=>h});var r=n(83785),o=n(47547),s=n(44308),i=n.n(s),a=n(17243),l=n(69229),c=n(72343),d=n(59061),u=n(62540);const h=(0,l.PA)((e=>{let{width:t,zIndex:n}=e;const{tempoEditorStore:{transform:s}}=(0,d.g)(),l=(0,r.u)(),h=(0,a.range)(30,s.maxBPM,30).map((e=>s.getY(e))).map((e=>({x:0,y:e,width:t,height:1}))),m=(0,c.B)(i()(l.dividerColor));return(0,u.jsx)(o.FX,{rects:h,color:m,zIndex:n})}))},41749:(e,t,n)=>{n.d(t,{W:()=>y});var r=n(47547),o=n(69229),s=n(63696),i=n(50119),a=n(26556),l=n(28632),c=n(59061),d=n(51618),u=n(98423),h=n(31563),m=n(12066),g=n(38604),p=n(96911),x=n(46185),f=n(13077),v=n(62540);const y=(0,o.PA)((e=>{let{width:t,height:n,style:o}=e;const{tempoEditorStore:y,tempoEditorStore:{items:j,transform:k,scrollLeft:b,mouseMode:w,rulerStore:{beats:S},cursorX:C,selectionRect:T}}=(0,c.g)(),A=(0,i.Te)(),E=(0,p._)(),I=(0,m.r)(),M=(0,g.d)(),O=Math.floor(b),P=(0,s.useCallback)((e=>({x:e.offsetX+O,y:e.offsetY})),[O]),D=(0,s.useCallback)((e=>j.find((t=>e.x>=t.bounds.x&&e.x<t.bounds.x+t.bounds.width))),[j]),N=(0,s.useCallback)((e=>{0===e.button&&E.onMouseDown(e.nativeEvent,P(e.nativeEvent),k)}),[E,k,O,w]),R=(0,s.useCallback)((e=>{if(0!==e.button)return;const t=P(e.nativeEvent),n=y.hitTest(t);void 0!==n?M.onMouseDown(e.nativeEvent,n,t,k):I.onMouseDown(e.nativeEvent,t,k)}),[M,I,k,O]),z="pencil"===w?N:R,L=(0,s.useCallback)((e=>{const t=P(e.nativeEvent),n=D(t);if(!n)return;const r=j.filter((e=>e.id===n.id))[0],o=e.nativeEvent.deltaY>0?-1:1,s=(0,a.M)(r.microsecondsPerBeat);A(r.id,Math.floor((0,a.w4)(s+o)))}),[j,O,A]),B=(0,s.useMemo)((()=>(0,l.L)(-O,0)),[O]);return(0,v.jsxs)(r.om,{width:t,height:n,onMouseDown:z,onWheel:L,style:o,children:[(0,v.jsx)(x.q,{width:t,zIndex:0}),(0,v.jsxs)(r.dL,{matrix:B,children:[(0,v.jsx)(d.g,{height:n,beats:S,zIndex:1}),(0,v.jsx)(f.w,{width:t,zIndex:2}),(0,v.jsx)(h.L,{rect:T,zIndex:3}),(0,v.jsx)(u.b,{x:C,height:n,zIndex:4})]})]})}))},13077:(e,t,n)=>{n.d(t,{w:()=>a});var r=n(69229),o=n(59061),s=n(8957),i=n(62540);const a=(0,r.PA)((e=>{let{width:t,zIndex:n}=e;const{tempoEditorStore:{items:r,selectedEventIds:a,controlPoints:l,scrollLeft:c}}=(0,o.g)();return(0,i.jsx)(s.B,{width:t,items:r.map((e=>({...e.bounds,id:e.id}))),selectedEventIds:a,controlPoints:l,scrollLeft:c,lineWidth:2,zIndex:n})}))},61885:(e,t,n)=>{n.d(t,{i:()=>o});var r=n(22095);const o=(e,t,n)=>{const o=e.filter(r.u3).sort(((e,t)=>e.tick-t.tick)).map((e=>{const n=6e7/e.microsecondsPerBeat;return{id:e.id,x:Math.round(t.getX(e.tick)),y:Math.round(t.getY(n)),microsecondsPerBeat:e.microsecondsPerBeat}}));return o.map(((e,r)=>{const s=r+1<o.length?o[r+1].x:n;return{id:e.id,bounds:{x:e.x,y:e.y,width:s-e.x,height:t.height-e.y+1},microsecondsPerBeat:e.microsecondsPerBeat}}))}},76600:(e,t,n)=>{n.d(t,{X:()=>u});var r=n(46287),o=n(11484),s=n.n(o),i=n(97233),a=n(96016),l=n(44541),c=n(62540);const d=(0,r.A)(s(),{target:"ephjsd50"})({name:"pcpglt",styles:"width:1.2rem;fill:currentColor"}),u=e=>{let{onClick:t,selected:n}=e;return(0,c.jsx)(a.m,{title:(0,c.jsx)(i.Oj,{name:"auto-scroll"}),children:(0,c.jsx)(l.I,{onMouseDown:e=>{e.preventDefault(),t()},selected:n,children:(0,c.jsx)(d,{})})})}},99064:(e,t,n)=>{n.d(t,{Y:()=>u});var r=n(46287),o=n(48390),s=n.n(o),i=n(98919),a=n.n(i),l=n(62540);const c=(0,r.A)("div",{target:"ee1xvp41"})("font-size:150%;font-family:",(e=>{let{theme:t}=e;return t.monoFont}),";background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";border:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";width:2em;padding:0.25em;text-align:center;"),d=(0,r.A)("div",{target:"ee1xvp40"})("display:flex;flex-direction:column;align-items:center;svg{color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";}svg:hover{color:",(e=>{let{theme:t}=e;return t.textColor}),";}"),u=e=>{let{value:t,prevValue:n,nextValue:r,className:o,onChange:i}=e;return(0,l.jsxs)(d,{className:o,children:[(0,l.jsx)("div",{className:"button-up",onClick:()=>i(r()),children:(0,l.jsx)(a(),{})}),(0,l.jsx)(c,{onWheel:function(e){i(e.deltaY<0?n():r())},children:t}),(0,l.jsx)("div",{className:"button-down",onClick:()=>i(n()),children:(0,l.jsx)(s(),{})})]})}},98376:(e,t,n)=>{n.d(t,{y:()=>u});var r=n(46287),o=n(39397),s=n(97233),i=n(16066),a=n(99064),l=n(62540);const c=(0,r.A)("div",{target:"e1n7tkk51"})("background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";border:1px solid ",(e=>{let{theme:t}=e;return t.popupBorderColor}),";box-shadow:0 1rem 3rem ",(e=>{let{theme:t}=e;return t.shadowColor}),';padding:0.5rem 1rem;border-radius:0.5rem;display:flex;position:relative;top:1rem;left:0.25rem;&::before{content:"";width:1rem;height:1rem;background:',(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";position:absolute;top:-0.5rem;left:calc(50% - 1rem);transform:rotate(45deg);}.button-up{margin-bottom:-0.4rem;}.button-down{margin-top:-0.1rem;}"),d=(0,r.A)("div",{target:"e1n7tkk50"})({name:"1aa3hlf",styles:"display:flex;flex-direction:column;justify-content:center;margin-left:1rem"});function u(e){let{value:t=8,values:n,triplet:r,dotted:u,onChangeValue:h,onChangeTriplet:m,onChangeDotted:g,trigger:p}=e;return(0,l.jsxs)(o.bL,{children:[(0,l.jsx)(o.l9,{asChild:!0,children:p}),(0,l.jsx)(o.ZL,{children:(0,l.jsx)(o.UC,{children:(0,l.jsxs)(c,{children:[(0,l.jsx)(a.Y,{value:t,prevValue:()=>{const e=Math.max(n.indexOf(t)-1,0);return n[e]},nextValue:()=>{const e=Math.min(n.indexOf(t)+1,n.length-1);return n[e]},onChange:h}),(0,l.jsxs)(d,{children:[(0,l.jsx)(i.S,{onCheckedChange:e=>m(!0===e),checked:r,label:(0,l.jsx)(s.Oj,{name:"triplet"}),style:{marginBottom:"0.5rem"}}),(0,l.jsx)(i.S,{onCheckedChange:e=>g(!0===e),checked:u,label:(0,l.jsx)(s.Oj,{name:"dotted"})})]})]})})})]})}},16051:(e,t,n)=>{n.d(t,{A:()=>w});var r=n(46287),o=n(81381),s=n.n(o),i=n(56279),a=n.n(i),l=n(63696),c=n(97233),d=n(96016),u=n(20928),h=n(98376),m=n(62540);const g=(0,r.A)(u.$,{target:"efynre56"})({name:"nzbbxn",styles:"margin-right:1em;align-items:stretch"}),p=(0,r.A)(u.A,{target:"efynre55"})({name:"1w213f3",styles:"padding:0.4rem"}),x=(0,r.A)(s(),{target:"efynre54"})({name:"v3kinn",styles:"top:-0.5rem;left:0.1rem;position:relative;width:0.5rem;height:0.5rem;margin:0 -0.1rem"}),f=(0,r.A)("span",{target:"efynre53"})("color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";font-size:70%;padding:0 0.24em;"),v=(0,r.A)(u.A,{target:"efynre52"})({name:"1hcx8jb",styles:"padding:0"}),y=(0,r.A)("div",{target:"efynre51"})("min-width:3em;pointer-events:none;font-size:0.9rem;font-family:",(e=>{let{theme:t}=e;return t.monoFont}),";"),j=(0,r.A)(a(),{target:"efynre50"})({name:"1u2l1m9",styles:"width:1.1rem"});function k(e,t,n){let r=e;return t&&(r/=1.5),n&&(r*=1.5),r}function b(e){let{value:t,enabled:n,onSelect:r,onClickSwitch:o}=e;const s=t%1!=0&&1.5*t%1==0,i=t/1.5%1==0,a=k(t,i,s),l=[1,2,4,8,16,32,64,128];return(0,m.jsxs)(g,{children:[(0,m.jsx)(d.m,{title:(0,m.jsx)(c.Oj,{name:"snap-to-grid"}),children:(0,m.jsx)(p,{selected:n,onMouseDown:o,children:(0,m.jsx)(j,{})})}),(0,m.jsx)(h.y,{value:a,values:l,dotted:s,triplet:i,onChangeValue:e=>r(k(e,s,i)),onChangeDotted:e=>r(k(a,e,!1)),onChangeTriplet:e=>r(k(a,!1,e)),trigger:(0,m.jsx)(v,{onWheel:e=>{const t=l.indexOf(a),n=e.deltaY<0?1:-1,o=Math.min(l.length-1,Math.max(0,t+n));r(k(l[o],s,i))},children:(0,m.jsxs)(y,{children:[(0,m.jsx)("span",{className:"denominator",children:a}),i&&(0,m.jsx)(f,{children:"3"}),s&&(0,m.jsx)(x,{})]})})})]})}const w=l.memo(b)},16139:(e,t,n)=>{n.d(t,{y:()=>m});var r=n(46287),o=n(63696),s=n(97233),i=n(96016),a=n(20928),l=n(62540),c=function(e){return(0,l.jsx)("svg",{...e,children:(0,l.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M92.656 25.247c.328-.33 1.39-.625 2.395.387l7.591 7.635c.994 1 .708 2.05.381 2.38l-9.994 10.069-10.385-10.385 10.012-10.086ZM78.417 39.592 33.55 84.793l-3.97 13.979 14.34-3.58 44.882-45.216-10.385-10.384Zm20.89-18.188c-2.875-2.892-7.785-3.532-10.91-.384l-59.65 60.095-.546.55-.211.744-5.598 19.71-1.416 4.985 5.029-1.255 20.182-5.039.812-.203.59-.594 59.692-60.137c3.094-3.116 2.466-7.97-.384-10.837l-7.59-7.635Z"})})};c.defaultProps={width:"128",height:"128",xmlns:"http://www.w3.org/2000/svg"};var d=function(e){return(0,l.jsx)("svg",{...e,children:(0,l.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M27 21h-6v6h6v-6Zm10 0h6v6h-6v-6Zm22 0h-6v6h6v-6Zm16 0h-6v6h6v-6Zm16 0h-6v6h6v-6Zm10 0h6v6h-6v-6Zm0 16h6v6h-6v-6Zm-74 0h-6v6h6v-6Zm74 16h6v6h-6v-6Zm-74 0h-6v6h6v-6Zm74 16h6v6h-6v-6Zm-74 0h-6v6h6v-6Zm74 16h6v6h-6v-6Zm-74 0h-6v6h6v-6Zm42 16h6v6h-6v-6Zm22 0h-6v6h6v-6Zm10 0h6v6h-6v-6Zm-42 0h-6v6h6v-6Zm-22 0h6v6h-6v-6Zm-10 0h-6v6h6v-6Z"})})};d.defaultProps={width:"128",height:"128",xmlns:"http://www.w3.org/2000/svg"};const u=(0,r.A)(a.$,{target:"eiiw2q91"})({name:"13wcnn3",styles:"background-color:transparent;margin-right:1rem"}),h=(0,r.A)("div",{target:"eiiw2q90"})({name:"zjik7",styles:"display:flex"}),m=e=>{let{mouseMode:t,onSelect:n}=e;return(0,l.jsxs)(u,{children:[(0,l.jsx)(a.A,{onMouseDown:(0,o.useCallback)((()=>n("pencil")),[]),selected:"pencil"===t,children:(0,l.jsx)(i.m,{title:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.Oj,{name:"pencil-tool"})," [1]"]}),children:(0,l.jsx)(h,{children:(0,l.jsx)(c,{style:{width:"1.3rem",height:"1.3rem",fill:"currentColor"},viewBox:"0 0 128 128"})})})}),(0,l.jsx)(a.A,{onMouseDown:(0,o.useCallback)((()=>n("selection")),[]),selected:"selection"===t,children:(0,l.jsx)(i.m,{title:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.Oj,{name:"selection-tool"})," [2]"]}),children:(0,l.jsx)(h,{children:(0,l.jsx)(d,{style:{width:"1.3rem",height:"1.3rem",fill:"currentColor"},viewBox:"0 0 128 128"})})})})]})}},99677:(e,t,n)=>{n.d(t,{M:()=>r});const r=(0,n(46287).A)("div",{target:"ejalp8n0"})("display:flex;align-items:center;padding:0.5rem 1rem;height:3rem;box-sizing:border-box;background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";")},44541:(e,t,n)=>{n.d(t,{I:()=>a});var r=n(46287),o=n(63696),s=n(62540);const i=(0,r.A)("button",{target:"efamyr0"})("-webkit-appearance:none;min-width:auto;padding:0 0.8rem;color:",(e=>{let{theme:t,selected:n}=e;return n?t.onSurfaceColor:t.textColor}),";border:none;background:",(e=>{let{theme:t,selected:n}=e;return n?t.themeColor:t.darkBackgroundColor}),";text-transform:none;height:2rem;overflow:hidden;white-space:nowrap;display:flex;align-items:center;border-radius:999px;cursor:pointer;outline:none;flex-shrink:0;&:hover{background:",(e=>{let{theme:t,selected:n}=e;return n?t.themeColor:t.highlightColor}),";}"),a=(0,o.forwardRef)(((e,t)=>{let{children:n,onMouseDown:r,...o}=e;return(0,s.jsx)(i,{...o,onMouseDown:e=>{e.preventDefault(),r?.(e)},tabIndex:-1,ref:t,children:n})}))},20928:(e,t,n)=>{n.d(t,{$:()=>i,A:()=>l});var r=n(46287),o=n(63696),s=n(62540);const i=(0,r.A)("div",{target:"e13wm2pd1"})({name:"1ygd1io",styles:"min-width:auto;overflow:hidden;white-space:nowrap;display:flex;align-items:center;cursor:pointer;flex-shrink:0"}),a=(0,r.A)("button",{target:"e13wm2pd0"})("outline:none;-webkit-appearance:none;min-width:auto;padding:0 0.5rem;color:",(e=>{let{theme:t,selected:n}=e;return n?t.onSurfaceColor:t.textColor}),";background:",(e=>{let{theme:t,selected:n}=e;return n?t.themeColor:t.secondaryBackgroundColor}),";text-transform:none;height:2rem;overflow:hidden;white-space:nowrap;display:flex;align-items:center;cursor:pointer;margin:0;border:none;border-radius:4px;&:first-of-type{border-radius:4px 0 0 4px;}&:last-child{border-radius:0 4px 4px 0;}&:hover{background:",(e=>{let{theme:t,selected:n}=e;return n?t.themeColor:t.highlightColor}),";}"),l=(0,o.forwardRef)(((e,t)=>{let{children:n,onMouseDown:r,...o}=e;return(0,s.jsx)(a,{...o,onMouseDown:e=>{e.preventDefault(),r?.(e)},tabIndex:-1,ref:t,children:n})}))},89296:(e,t,n)=>{n.d(t,{$:()=>m});var r=n(46287),o=n(39751),s=n.n(o),i=n(69229),a=n(50119),l=n(97233),c=n(62540);const d=(0,r.A)("div",{target:"e1pd9xtb2"})("display:flex;padding:0.5rem 1rem;align-items:center;justify-content:center;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";border-radius:0.5rem;margin:0.5rem;&:hover{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}"),u=(0,r.A)(s(),{target:"e1pd9xtb1"})({name:"g41qz1",styles:"min-width:auto;margin-right:0.5em;color:inherit"}),h=(0,r.A)("div",{target:"e1pd9xtb0"})({name:"ol9ofu",styles:"font-size:0.875rem"}),m=(0,i.PA)((()=>{const e=(0,a.gg)();return(0,c.jsxs)(d,{onClick:e,children:[(0,c.jsx)(u,{}),(0,c.jsx)(h,{children:(0,c.jsx)(l.Oj,{name:"add-track"})})]})}))},41479:(e,t,n)=>{n.d(t,{F:()=>a});var r=n(97233),o=n(16053),s=n(62540);const i=e=>{let{programNumber:t}=e;switch((0,o.h)(t)){case 0:return(0,s.jsx)(r.Oj,{name:"Piano"});case 1:return(0,s.jsx)(r.Oj,{name:"Chromatic Percussion"});case 2:return(0,s.jsx)(r.Oj,{name:"Organ"});case 3:return(0,s.jsx)(r.Oj,{name:"Guitar"});case 4:return(0,s.jsx)(r.Oj,{name:"Bass"});case 5:return(0,s.jsx)(r.Oj,{name:"Strings"});case 6:return(0,s.jsx)(r.Oj,{name:"Ensemble"});case 7:return(0,s.jsx)(r.Oj,{name:"Brass"});case 8:return(0,s.jsx)(r.Oj,{name:"Reed"});case 9:return(0,s.jsx)(r.Oj,{name:"Pipe"});case 10:return(0,s.jsx)(r.Oj,{name:"Synth Lead"});case 11:return(0,s.jsx)(r.Oj,{name:"Synth Pad"});case 12:return(0,s.jsx)(r.Oj,{name:"Synth Effects"});case 13:return(0,s.jsx)(r.Oj,{name:"Ethnic"});case 14:return(0,s.jsx)(r.Oj,{name:"Percussive"});case 15:return(0,s.jsx)(r.Oj,{name:"Sound effects"})}return(0,s.jsx)(s.Fragment,{})},a=e=>{let{programNumber:t}=e;const n=o.g[(0,o.h)(t)];return(0,s.jsxs)(s.Fragment,{children:[n," ",(0,s.jsx)(i,{programNumber:t})]})}},6980:(e,t,n)=>{n.d(t,{Z:()=>i,a:()=>a});var r=n(69229),o=n(97233),s=n(62540);const i=e=>{let{programNumber:t}=e;switch(t){case 0:return(0,s.jsx)(o.Oj,{name:"Acoustic Grand Piano"});case 1:return(0,s.jsx)(o.Oj,{name:"Bright Acoustic Piano"});case 2:return(0,s.jsx)(o.Oj,{name:"Electric Grand Piano"});case 3:return(0,s.jsx)(o.Oj,{name:"Honky-tonk Piano"});case 4:return(0,s.jsx)(o.Oj,{name:"Electric Piano 1"});case 5:return(0,s.jsx)(o.Oj,{name:"Electric Piano 2"});case 6:return(0,s.jsx)(o.Oj,{name:"Harpsichord"});case 7:return(0,s.jsx)(o.Oj,{name:"Clavinet"});case 8:return(0,s.jsx)(o.Oj,{name:"Celesta"});case 9:return(0,s.jsx)(o.Oj,{name:"Glockenspiel"});case 10:return(0,s.jsx)(o.Oj,{name:"Music Box"});case 11:return(0,s.jsx)(o.Oj,{name:"Vibraphone"});case 12:return(0,s.jsx)(o.Oj,{name:"Marimba"});case 13:return(0,s.jsx)(o.Oj,{name:"Xylophone"});case 14:return(0,s.jsx)(o.Oj,{name:"Tubular Bells"});case 15:return(0,s.jsx)(o.Oj,{name:"Dulcimer"});case 16:return(0,s.jsx)(o.Oj,{name:"Drawbar Organ"});case 17:return(0,s.jsx)(o.Oj,{name:"Percussive Organ"});case 18:return(0,s.jsx)(o.Oj,{name:"Rock Organ"});case 19:return(0,s.jsx)(o.Oj,{name:"Church Organ"});case 20:return(0,s.jsx)(o.Oj,{name:"Reed Organ"});case 21:return(0,s.jsx)(o.Oj,{name:"Accordion"});case 22:return(0,s.jsx)(o.Oj,{name:"Harmonica"});case 23:return(0,s.jsx)(o.Oj,{name:"Tango Accordion"});case 24:return(0,s.jsx)(o.Oj,{name:"Acoustic Guitar (nylon)"});case 25:return(0,s.jsx)(o.Oj,{name:"Acoustic Guitar (steel)"});case 26:return(0,s.jsx)(o.Oj,{name:"Electric Guitar (jazz)"});case 27:return(0,s.jsx)(o.Oj,{name:"Electric Guitar (clean)"});case 28:return(0,s.jsx)(o.Oj,{name:"Electric Guitar (muted)"});case 29:return(0,s.jsx)(o.Oj,{name:"Overdriven Guitar"});case 30:return(0,s.jsx)(o.Oj,{name:"Distortion Guitar"});case 31:return(0,s.jsx)(o.Oj,{name:"Guitar Harmonics"});case 32:return(0,s.jsx)(o.Oj,{name:"Acoustic Bass"});case 33:return(0,s.jsx)(o.Oj,{name:"Electric Bass (finger)"});case 34:return(0,s.jsx)(o.Oj,{name:"Electric Bass (pick)"});case 35:return(0,s.jsx)(o.Oj,{name:"Fretless Bass"});case 36:return(0,s.jsx)(o.Oj,{name:"Slap Bass 1"});case 37:return(0,s.jsx)(o.Oj,{name:"Slap Bass 2"});case 38:return(0,s.jsx)(o.Oj,{name:"Synth Bass 1"});case 39:return(0,s.jsx)(o.Oj,{name:"Synth Bass 2"});case 40:return(0,s.jsx)(o.Oj,{name:"Violin"});case 41:return(0,s.jsx)(o.Oj,{name:"Viola"});case 42:return(0,s.jsx)(o.Oj,{name:"Cello"});case 43:return(0,s.jsx)(o.Oj,{name:"Contrabass"});case 44:return(0,s.jsx)(o.Oj,{name:"Tremolo Strings"});case 45:return(0,s.jsx)(o.Oj,{name:"Pizzicato Strings"});case 46:return(0,s.jsx)(o.Oj,{name:"Orchestral Harp"});case 47:return(0,s.jsx)(o.Oj,{name:"Timpani"});case 48:return(0,s.jsx)(o.Oj,{name:"String Ensemble 1"});case 49:return(0,s.jsx)(o.Oj,{name:"String Ensemble 2"});case 50:return(0,s.jsx)(o.Oj,{name:"Synth Strings 1"});case 51:return(0,s.jsx)(o.Oj,{name:"Synth Strings 2"});case 52:return(0,s.jsx)(o.Oj,{name:"Choir Aahs"});case 53:return(0,s.jsx)(o.Oj,{name:"Voice Oohs"});case 54:return(0,s.jsx)(o.Oj,{name:"Synth Choir"});case 55:return(0,s.jsx)(o.Oj,{name:"Orchestra Hit"});case 56:return(0,s.jsx)(o.Oj,{name:"Trumpet"});case 57:return(0,s.jsx)(o.Oj,{name:"Trombone"});case 58:return(0,s.jsx)(o.Oj,{name:"Tuba"});case 59:return(0,s.jsx)(o.Oj,{name:"Muted Trumpet"});case 60:return(0,s.jsx)(o.Oj,{name:"French Horn"});case 61:return(0,s.jsx)(o.Oj,{name:"Brass Section"});case 62:return(0,s.jsx)(o.Oj,{name:"Synth Brass 1"});case 63:return(0,s.jsx)(o.Oj,{name:"Synth Brass 2"});case 64:return(0,s.jsx)(o.Oj,{name:"Soprano Sax"});case 65:return(0,s.jsx)(o.Oj,{name:"Alto Sax"});case 66:return(0,s.jsx)(o.Oj,{name:"Tenor Sax"});case 67:return(0,s.jsx)(o.Oj,{name:"Baritone Sax"});case 68:return(0,s.jsx)(o.Oj,{name:"Oboe"});case 69:return(0,s.jsx)(o.Oj,{name:"English Horn"});case 70:return(0,s.jsx)(o.Oj,{name:"Bassoon"});case 71:return(0,s.jsx)(o.Oj,{name:"Clarinet"});case 72:return(0,s.jsx)(o.Oj,{name:"Piccolo"});case 73:return(0,s.jsx)(o.Oj,{name:"Flute"});case 74:return(0,s.jsx)(o.Oj,{name:"Recorder"});case 75:return(0,s.jsx)(o.Oj,{name:"Pan Flute"});case 76:return(0,s.jsx)(o.Oj,{name:"Blown Bottle"});case 77:return(0,s.jsx)(o.Oj,{name:"Shakuhachi"});case 78:return(0,s.jsx)(o.Oj,{name:"Whistle"});case 79:return(0,s.jsx)(o.Oj,{name:"Ocarina"});case 80:return(0,s.jsx)(o.Oj,{name:"Lead 1 (square)"});case 81:return(0,s.jsx)(o.Oj,{name:"Lead 2 (sawtooth)"});case 82:return(0,s.jsx)(o.Oj,{name:"Lead 3 (calliope)"});case 83:return(0,s.jsx)(o.Oj,{name:"Lead 4 (chiff)"});case 84:return(0,s.jsx)(o.Oj,{name:"Lead 5 (charang)"});case 85:return(0,s.jsx)(o.Oj,{name:"Lead 6 (voice)"});case 86:return(0,s.jsx)(o.Oj,{name:"Lead 7 (fifths)"});case 87:return(0,s.jsx)(o.Oj,{name:"Lead 8 (bass + lead)"});case 88:return(0,s.jsx)(o.Oj,{name:"Pad 1 (new age)"});case 89:return(0,s.jsx)(o.Oj,{name:"Pad 2 (warm)"});case 90:return(0,s.jsx)(o.Oj,{name:"Pad 3 (polysynth)"});case 91:return(0,s.jsx)(o.Oj,{name:"Pad 4 (choir)"});case 92:return(0,s.jsx)(o.Oj,{name:"Pad 5 (bowed)"});case 93:return(0,s.jsx)(o.Oj,{name:"Pad 6 (metallic)"});case 94:return(0,s.jsx)(o.Oj,{name:"Pad 7 (halo)"});case 95:return(0,s.jsx)(o.Oj,{name:"Pad 8 (sweep)"});case 96:return(0,s.jsx)(o.Oj,{name:"FX 1 (rain)"});case 97:return(0,s.jsx)(o.Oj,{name:"FX 2 (soundtrack)"});case 98:return(0,s.jsx)(o.Oj,{name:"FX 3 (crystal)"});case 99:return(0,s.jsx)(o.Oj,{name:"FX 4 (atmosphere)"});case 100:return(0,s.jsx)(o.Oj,{name:"FX 5 (brightness)"});case 101:return(0,s.jsx)(o.Oj,{name:"FX 6 (goblins)"});case 102:return(0,s.jsx)(o.Oj,{name:"FX 7 (echoes)"});case 103:return(0,s.jsx)(o.Oj,{name:"FX 8 (sci-fi)"});case 104:return(0,s.jsx)(o.Oj,{name:"Sitar"});case 105:return(0,s.jsx)(o.Oj,{name:"Banjo"});case 106:return(0,s.jsx)(o.Oj,{name:"Shamisen"});case 107:return(0,s.jsx)(o.Oj,{name:"Koto"});case 108:return(0,s.jsx)(o.Oj,{name:"Kalimba"});case 109:return(0,s.jsx)(o.Oj,{name:"Bagpipe"});case 110:return(0,s.jsx)(o.Oj,{name:"Fiddle"});case 111:return(0,s.jsx)(o.Oj,{name:"Shanai"});case 112:return(0,s.jsx)(o.Oj,{name:"Tinkle Bell"});case 113:return(0,s.jsx)(o.Oj,{name:"Agogo"});case 114:return(0,s.jsx)(o.Oj,{name:"Steel Drums"});case 115:return(0,s.jsx)(o.Oj,{name:"Woodblock"});case 116:return(0,s.jsx)(o.Oj,{name:"Taiko Drum"});case 117:return(0,s.jsx)(o.Oj,{name:"Melodic Tom"});case 118:return(0,s.jsx)(o.Oj,{name:"Synth Drum"});case 119:return(0,s.jsx)(o.Oj,{name:"Reverse Cymbal"});case 120:return(0,s.jsx)(o.Oj,{name:"Guitar Fret Noise"});case 121:return(0,s.jsx)(o.Oj,{name:"Breath Noise"});case 122:return(0,s.jsx)(o.Oj,{name:"Seashore"});case 123:return(0,s.jsx)(o.Oj,{name:"Bird Tweet"});case 124:return(0,s.jsx)(o.Oj,{name:"Telephone Ring"});case 125:return(0,s.jsx)(o.Oj,{name:"Helicopter"});case 126:return(0,s.jsx)(o.Oj,{name:"Applause"});case 127:return(0,s.jsx)(o.Oj,{name:"Gunshot"})}return(0,s.jsx)(s.Fragment,{})},a=(0,r.PA)((e=>{let{track:t}=e;return t.isRhythmTrack?(0,s.jsx)(s.Fragment,{children:"Standard Drum Kit"}):(0,s.jsx)(i,{programNumber:t.programNumber})}))},9481:(e,t,n)=>{n.d(t,{y:()=>m});var r=n(17243),o=n(63696),s=n(97233),i=n(66459),a=n(5513),l=n(15467),c=n(95881),d=n(4830),u=n(8008),h=n(62540);const m=e=>{let{track:t,open:n,onClose:m}=e;const[g,p]=(0,o.useState)(t.name),[x,f]=(0,o.useState)(t.channel);return(0,o.useEffect)((()=>{p(t.name),f(t.channel)}),[t]),(0,h.jsxs)(i.lG,{open:n,onOpenChange:m,style:{minWidth:"20rem"},children:[(0,h.jsxs)(i.L3,{children:[(0,h.jsx)(s.Oj,{name:"track"}),": ",(0,h.jsx)(u.x,{track:t})]}),(0,h.jsxs)(i.Cf,{children:[(0,h.jsx)(l.J,{children:(0,h.jsx)(s.Oj,{name:"track-name"})}),(0,h.jsx)(d.A,{type:"text",value:g,onChange:e=>p(e.target.value),style:{width:"100%",marginBottom:"1rem"}}),(0,h.jsx)(l.J,{children:(0,h.jsx)(s.Oj,{name:"channel"})}),(0,h.jsx)(c.l,{value:x,onChange:e=>f(parseInt(e.target.value)),children:(0,r.range)(0,16).map((e=>(0,h.jsxs)("option",{value:e.toString(),children:[e+1,9===e?(0,h.jsxs)(h.Fragment,{children:[" ","(",(0,h.jsx)(s.Oj,{name:"rhythm-track"}),")"]}):""]},e)))})]}),(0,h.jsxs)(i.ii,{children:[(0,h.jsx)(a.$,{autoFocus:!0,onClick:m,children:(0,h.jsx)(s.Oj,{name:"cancel"})}),(0,h.jsx)(a.j,{onClick:()=>{t.channel=x,t.setName(g??""),m()},children:(0,h.jsx)(s.Oj,{name:"ok"})})]})]})}},19069:(e,t,n)=>{n.d(t,{S:()=>u});var r=n(46287),o=n(69229),s=n(59061),i=n(71527),a=n(89296),l=n(8228),c=n(62540);const d=(0,r.A)("div",{target:"e45fs990"})("overflow-y:auto;background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";min-width:14rem;flex-grow:1;"),u=(0,o.PA)((()=>{const{song:e}=(0,s.g)();return(0,c.jsxs)(d,{children:[(0,c.jsx)(i.q,{items:e.tracks.filter((e=>!e.isConductorTrack)),getItemId:e=>e.id,onItemMoved:(t,n)=>{const r=e.getTrack(t),o=e.getTrack(n);if(void 0===r||void 0===o)return;const s=e.tracks.indexOf(r),i=e.tracks.indexOf(o);e.moveTrack(s,i)},render:e=>(0,c.jsx)(l.H,{track:e},e.id)}),(0,c.jsx)(a.$,{})]})}))},10781:(e,t,n)=>{n.d(t,{A:()=>g});var r=n(44308),o=n.n(r),s=n(69229),i=n(63696),a=n(50119),l=n(97233),c=n(89017),d=n(5909),u=n(94724),h=n(9481),m=n(62540);const g=(0,s.PA)((e=>{let{track:t,...n}=e;const r=(0,a.gg)(),s=(0,a.Vd)(),{handleClose:g}=n,[p,x]=(0,i.useState)(!1),[f,v]=(0,i.useState)(!1),y=r,j=(0,i.useCallback)((()=>s(t.id)),[t.id,s]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(d.t,{...n,children:[(0,m.jsx)(u.Dr,{onClick:e=>{e.stopPropagation(),y(),g()},children:(0,m.jsx)(l.Oj,{name:"add-track"})}),(0,m.jsx)(u.Dr,{onClick:e=>{e.stopPropagation(),j(),g()},children:(0,m.jsx)(l.Oj,{name:"delete-track"})}),(0,m.jsx)(u.Dr,{onClick:e=>{e.stopPropagation(),x(!0),g()},children:(0,m.jsx)(l.Oj,{name:"property"})}),(0,m.jsx)(u.Dr,{onClick:e=>{e.stopPropagation(),v(!0),g()},children:(0,m.jsx)(l.Oj,{name:"change-track-color"})})]}),(0,m.jsx)(h.y,{track:t,open:p,onClose:()=>x(!1)}),(0,m.jsx)(c.s,{open:f,onSelect:e=>{if(null===e)return void t.setColor(null);const n=o()(e);t.setColor({red:Math.floor(n.red()),green:Math.floor(n.green()),blue:Math.floor(n.blue()),alpha:255})},onClose:()=>v(!1)})]})}))},8228:(e,t,n)=>{n.d(t,{H:()=>D});var r=n(46287),o=n(73119),s=n.n(o),i=n(43138),a=n.n(i),l=n(4126),c=n.n(l),d=n(28951),u=n.n(d),h=n(69229),m=n(63696),g=n(50119),p=n(78439),x=n(59061),f=n(16053),v=n(30453),y=n(6980),j=n(9481),k=n(10781),b=n(8008),w=n(62540);const S=(0,r.A)("div",{target:"emvqz9i8"})("background-color:",(e=>{let{theme:t,selected:n}=e;return n?t.highlightColor:"transparent"}),";border:1px solid;border-color:",(e=>{let{theme:t,selected:n}=e;return n?t.dividerColor:"transparent"}),";display:flex;align-items:center;padding:0.5rem 0.5rem;border-radius:0.5rem;margin:0.5rem;outline:none;&:hover{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}"),C=(0,r.A)("div",{target:"emvqz9i7"})({name:"12comyy",styles:"display:flex;padding-bottom:0.3em;align-items:baseline"}),T=(0,r.A)("div",{target:"emvqz9i6"})("color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";font-size:0.75rem;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;"),A=(0,r.A)("div",{target:"emvqz9i5"})("font-weight:600;color:",(e=>{let{theme:t,selected:n}=e;return n?t.textColor:t.secondaryTextColor}),";padding-right:0.5em;font-size:0.875rem;text-overflow:ellipsis;white-space:nowrap;"),E=(0,r.A)("div",{target:"emvqz9i4"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),I=(0,r.A)("div",{target:"emvqz9i3"})("flex-shrink:0;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";font-size:0.625rem;display:flex;align-items:center;border:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";padding:0 0.25rem;cursor:pointer;height:1.25rem;margin-left:0.25rem;&:hover{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}"),M=(0,r.A)("div",{target:"emvqz9i2"})("display:flex;align-items:center;justify-content:center;font-size:1.2rem;width:2.6rem;height:2.6rem;border-radius:1.3rem;margin-right:0.5rem;flex-shrink:0;background:",(e=>{let{theme:t,selected:n}=e;return n?t.backgroundColor:t.secondaryBackgroundColor}),";border:2px solid ",(e=>{let{color:t}=e;return t}),";box-sizing:border-box;"),O=(0,r.A)("div",{target:"emvqz9i1"})("opacity:",(e=>{let{selected:t}=e;return t?1:.5}),";"),P=(0,r.A)("div",{target:"emvqz9i0"})("width:1.9rem;height:1.9rem;margin-right:0.25rem;display:flex;align-items:center;justify-content:center;border-radius:999px;color:",(e=>{let{theme:t,active:n}=e;return n?t.textColor:t.secondaryTextColor}),";cursor:pointer;outline:none;&:hover{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}svg{width:1.1rem;height:1.1rem;}"),D=(0,h.PA)((e=>{let{track:t}=e;const{pianoRollStore:n,rootViewStore:r,trackMute:o,router:i}=(0,x.g)(),l=(0,g.mg)(),d=(0,g.Ay)(),h=(0,g.W3)(),D=(0,g.i5)(),N=(0,g.bS)(),R=!r.isArrangeViewSelected&&t.id===n.selectedTrackId,z=o.isMuted(t.id),L=o.isSolo(t.id),B=!n.notGhostTrackIds.has(t.id),F=t.channel,{onContextMenu:H,menuProps:W}=(0,p.E)(),[_,K]=(0,m.useState)(!1),V=(0,m.useCallback)((()=>{t.isConductorTrack||(n.openInstrumentBrowser=!0,n.instrumentBrowserSetting={programNumber:t.programNumber??0,isRhythmTrack:t.isRhythmTrack})}),[]),X=(0,m.useCallback)((e=>{e.stopPropagation(),l(t.id)}),[t.id,l]),Y=(0,m.useCallback)((e=>{e.stopPropagation(),d(t.id)}),[t.id,d]),q=(0,m.useCallback)((e=>{e.stopPropagation(),e.nativeEvent.altKey?D():h(t.id)}),[t.id,D,h]),G=(0,m.useCallback)((()=>{i.pushTrack(),N(t.id)}),[t.id,N]),U=(0,m.useCallback)((()=>{K(!0)}),[]),$=t.isRhythmTrack?"🥁":f.g[(0,f.h)(t.programNumber??0)],Z=void 0!==t.color?(0,v.g)(t.color):"transparent";return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(S,{selected:R,onMouseDown:G,onContextMenu:H,tabIndex:-1,children:[(0,w.jsx)(M,{selected:R,color:Z,onDoubleClick:V,children:(0,w.jsx)(O,{selected:R,children:$})}),(0,w.jsxs)("div",{children:[(0,w.jsxs)(C,{children:[(0,w.jsx)(A,{selected:R,children:(0,w.jsx)(b.x,{track:t})}),(0,w.jsx)(T,{children:(0,w.jsx)(y.a,{track:t})})]}),(0,w.jsxs)(E,{children:[(0,w.jsx)(P,{active:L,onMouseDown:Y,tabIndex:-1,children:(0,w.jsx)(s(),{})}),(0,w.jsx)(P,{active:z,onMouseDown:X,tabIndex:-1,children:z?(0,w.jsx)(u(),{}):(0,w.jsx)(c(),{})}),(0,w.jsx)(P,{active:B,onMouseDown:q,tabIndex:-1,children:(0,w.jsx)(a(),{})}),void 0!==F&&(0,w.jsxs)(I,{onClick:U,children:["CH ",F+1]})]})]})]}),(0,w.jsx)(k.A,{...W,track:t}),(0,w.jsx)(j.y,{track:t,open:_,onClose:()=>K(!1)})]})}))},81244:(e,t,n)=>{n.d(t,{D:()=>h});var r=n(46287),o=n(52662),s=n.n(o),i=n(69229),a=n(63696),l=n(59061),c=n(62540);const d=(0,r.A)("button",{target:"e7epabs0"})("-webkit-appearance:none;border:none;outline:none;height:2rem;background:none;color:inherit;cursor:pointer;&:hover{background:none;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";}"),u=e=>{let{isOpen:t}=e;return(0,c.jsx)(s(),{style:{transition:"transform 0.1s ease",transform:`scale(1.4) rotateZ(${t?"0deg":"-90deg"})`}})},h=(0,i.PA)((()=>{const{pianoRollStore:e}=(0,l.g)(),t=e.showTrackList,n=(0,a.useCallback)((()=>e.showTrackList=!e.showTrackList),[e]),r=(0,a.useRef)(null);return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(d,{ref:r,tabIndex:-1,onMouseDown:e=>{e.preventDefault(),n()},children:(0,c.jsx)(u,{isOpen:t})})})}))},8008:(e,t,n)=>{n.d(t,{x:()=>i});var r=n(69229),o=n(97233),s=n(62540);const i=(0,r.PA)((e=>{let{track:t}=e;return t.name&&t.name.length>0?(0,s.jsx)(s.Fragment,{children:t.name}):void 0===t.channel?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(o.Oj,{name:"conductor-track"})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.Oj,{name:"track"})," ",t.channel+1]})}))},34542:(e,t,n)=>{n.d(t,{j:()=>r});const r=(0,n(46287).A)("div",{target:"e1wucebe0"})("--webkit-appearance:none;outline:none;border:none;border-radius:100%;margin:0.25rem;padding:0.4rem;color:",(e=>{let{theme:t}=e;return t.textColor}),";display:flex;align-items:center;justify-content:center;cursor:pointer;&:hover{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}svg{width:1.2rem;height:1.2rem;}")},61436:(e,t,n)=>{n.d(t,{D:()=>m});var r=n(46287),o=n(46834),s=n.n(o),i=n(67235),a=n.n(i),l=n(97233),c=n(96016),d=n(34542),u=n(62540);const h=(0,r.A)(d.j,{target:"e134in680"})("color:",(e=>{let{theme:t}=e;return t.onSurfaceColor}),";background:",(e=>{let{theme:t}=e;return t.themeColor}),";&:hover{background:",(e=>{let{theme:t}=e;return t.themeColor}),";opacity:0.8;}&.active{background:",(e=>{let{theme:t}=e;return t.themeColor}),";}"),m=(e,t)=>{let{onMouseDown:n,isPlaying:r}=e;return(0,u.jsx)(c.m,{title:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(l.Oj,{name:"play-pause"})," [space]"]}),side:"top",children:(0,u.jsx)(h,{id:"button-play",onMouseDown:n,className:r?"active":void 0,children:r?(0,u.jsx)(s(),{}):(0,u.jsx)(a(),{})})})}},54699:(e,t,n)=>{n.d(t,{g:()=>u});var r=n(46287),o=n(1902),s=n(69229),i=n(59061),a=n(50029),l=n(62540);const c=(0,r.A)(a.Q,{target:"epow5t61"})("background:transparent;-webkit-appearance:none;border:none;color:inherit;font-size:inherit;font-family:inherit;width:5em;text-align:center;outline:none;font-family:",(e=>{let{theme:t}=e;return t.monoFont}),";font-size:1rem;padding:0.3rem 0;&::-webkit-inner-spin-button{-webkit-appearance:none;margin:0;}"),d=(0,r.A)("div",{target:"epow5t60"})("display:flex;align-items:center;border:1px solid transparent;padding-left:0.75rem;border-radius:0.25rem;label{font-size:0.6rem;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";}&:focus-within{border:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";background:#ffffff14;}"),u=(0,s.PA)((()=>{const{song:e,pianoRollStore:{currentTempo:t},player:n}=(0,i.g)(),r=t??o.gg;return(0,l.jsxs)(d,{children:[(0,l.jsx)("label",{htmlFor:"tempo-input",children:"BPM"}),(0,l.jsx)(c,{id:"tempo-input",min:1,max:512,value:Math.round(100*r)/100,step:1,onChange:t=>{e.conductorTrack?.setTempo(t,n.position),n.currentTempo=t}})]})}))},82733:(e,t,n)=>{n.d(t,{Cg:()=>z});var r=n(46287),o=n(61851),s=n.n(o),i=n(97401),a=n.n(i),l=n(81381),c=n.n(l),d=n(35302),u=n.n(d),h=n(5176),m=n.n(h),g=n(34368),p=n.n(g),x=n(69229),f=n(63696),v=n(50119),y=n(56400),j=n(59061),k=n(97233),b=n(571),w=n(96016),S=n(34542),C=n(61436),T=n(54699),A=n(62540);const E=(0,r.A)("div",{target:"eyixwlw6"})("display:flex;align-items:center;justify-content:center;padding:0.25rem 1rem;background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";border-top:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";height:3rem;box-sizing:border-box;"),I=(0,r.A)(S.j,{target:"eyixwlw5"})("color:",(e=>{let{theme:t,active:n}=e;return n?t.recordColor:"inherit"}),";"),M=(0,r.A)(S.j,{target:"eyixwlw4"})("color:",(e=>{let{theme:t,active:n}=e;return n?t.themeColor:"inherit"}),";"),O=(0,r.A)(S.j,{target:"eyixwlw3"})("color:",(e=>{let{theme:t,active:n}=e;return n?t.themeColor:t.secondaryTextColor}),";"),P=(0,r.A)("div",{target:"eyixwlw2"})("font-family:",(e=>{let{theme:t}=e;return t.monoFont}),";font-size:0.9rem;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";"),D=(0,x.PA)((()=>{const{pianoRollStore:e}=(0,j.g)(),t=e.currentMBTTime;return(0,A.jsx)(P,{children:t})})),N=(0,r.A)("div",{target:"eyixwlw1"})("background:",(e=>{let{theme:t}=e;return t.dividerColor}),";margin:0.4em 1em;width:1px;height:1rem;"),R=(0,r.A)("div",{target:"eyixwlw0"})({name:"1201k1l",styles:"position:absolute;right:1em"}),z=(0,x.PA)((()=>{const{player:e,midiDeviceStore:t,midiRecorder:n,soundFontStore:r,synthGroup:o,synthGroup:{isMetronomeEnabled:i}}=(0,j.g)(),{isPlaying:l,loop:d}=e,h=n.isRecording,g=Object.values(t.enabledInputs).filter((e=>e)).length>0,x=r.isLoading,P=(0,v.qo)(),z=(0,v.sQ)(),L=(0,v.m$)(),B=(0,y.b)(),F=(0,f.useCallback)((()=>{o.isMetronomeEnabled=!o.isMetronomeEnabled}),[e]);return(0,A.jsxs)(E,{children:[(0,A.jsx)(w.m,{title:(0,A.jsx)(k.Oj,{name:"rewind"}),side:"top",children:(0,A.jsx)(S.j,{onMouseDown:z,children:(0,A.jsx)(a(),{})})}),(0,A.jsx)(w.m,{title:(0,A.jsx)(k.Oj,{name:"stop"}),side:"top",children:(0,A.jsx)(S.j,{onMouseDown:P,children:(0,A.jsx)(p(),{})})}),(0,A.jsx)(C.D,{onMouseDown:()=>e.playOrPause(),isPlaying:l}),g&&(0,A.jsx)(w.m,{title:(0,A.jsx)(k.Oj,{name:"record"}),side:"top",children:(0,A.jsx)(I,{onMouseDown:B,active:h,children:(0,A.jsx)(c(),{})})}),(0,A.jsx)(w.m,{title:(0,A.jsx)(k.Oj,{name:"fast-forward"}),side:"top",children:(0,A.jsx)(S.j,{onMouseDown:L,children:(0,A.jsx)(s(),{})})}),d&&(0,A.jsx)(M,{onMouseDown:()=>e.toggleEnableLoop(),active:d.enabled,children:(0,A.jsx)(u(),{})}),(0,A.jsx)(N,{}),(0,A.jsx)(O,{onMouseDown:F,active:i,children:(0,A.jsx)(m(),{})}),(0,A.jsx)(T.g,{}),(0,A.jsx)(N,{}),(0,A.jsx)(D,{}),x&&(0,A.jsx)(R,{children:(0,A.jsx)(b.P,{size:"1rem"})})]})}))},71751:(e,t,n)=>{n.d(t,{C:()=>c});var r=n(69229),o=n(63696),s=n(50119),i=n(59061),a=n(87357),l=n(62540);const c=(0,r.PA)((()=>{const{arrangeViewStore:e}=(0,i.g)(),{openTransposeDialog:t}=e,n=(0,s.vi)(),r=(0,o.useCallback)((()=>e.openTransposeDialog=!1),[e]),c=(0,o.useCallback)((t=>{n(t),e.openTransposeDialog=!1}),[e,n]);return(0,l.jsx)(a.S,{open:t,onClose:r,onClickOK:c})}))},7101:(e,t,n)=>{n.d(t,{w:()=>c});var r=n(69229),o=n(63696),s=n(50119),i=n(59061),a=n(87357),l=n(62540);const c=(0,r.PA)((()=>{const{pianoRollStore:e}=(0,i.g)(),{openTransposeDialog:t}=e,n=(0,s.fm)(),r=(0,o.useCallback)((()=>e.openTransposeDialog=!1),[e]),c=(0,o.useCallback)((t=>{n(t),e.openTransposeDialog=!1}),[e,n]);return(0,l.jsx)(a.S,{open:t,onClose:r,onClickOK:c})}))},87357:(e,t,n)=>{n.d(t,{S:()=>c});var r=n(63696),o=n(97233),s=n(66459),i=n(5513),a=n(4830),l=n(62540);const c=e=>{let{open:t,onClickOK:n,onClose:c}=e;const[d,u]=(0,r.useState)("0");(0,r.useEffect)((()=>{t&&u("")}),[t]);const h=()=>{const e=parseInt(d);n(isNaN(e)?0:e),c()};return(0,l.jsxs)(s.lG,{open:t,onOpenChange:c,children:[(0,l.jsx)(s.L3,{children:(0,l.jsx)(o.Oj,{name:"transpose"})}),(0,l.jsx)(s.Cf,{children:(0,l.jsx)(a.A,{type:"number",value:d,onChange:e=>u(e.target.value),autoFocus:!0,placeholder:"0",onKeyPress:e=>{"Enter"===e.key&&h()}})}),(0,l.jsxs)(s.ii,{children:[(0,l.jsx)(i.$,{onClick:c,children:(0,l.jsx)(o.Oj,{name:"close"})}),(0,l.jsx)(i.j,{onClick:h,children:(0,l.jsx)(o.Oj,{name:"ok"})})]})]})}},36079:(e,t,n)=>{n.d(t,{r:()=>d});var r=n(13600),o=n(69229),s=n(59061),i=n(97233),a=n(66459),l=n(5513),c=n(62540);const d=(0,o.PA)((()=>{const{rootViewStore:e,userRepository:t}=(0,s.g)();return(0,c.jsxs)(a.lG,{open:e.openDeleteAccountDialog,children:[(0,c.jsx)(r.L3,{children:(0,c.jsx)(i.Oj,{name:"delete-account"})}),(0,c.jsx)(a.Cf,{children:(0,c.jsx)(i.Oj,{name:"delete-account-description"})}),(0,c.jsxs)(a.ii,{children:[(0,c.jsx)(l.j,{onClick:async()=>{try{await t.delete(),e.openDeleteAccountDialog=!1}catch(e){alert(`Failed to delete account: ${e}`)}},children:(0,c.jsx)(i.Oj,{name:"delete"})}),(0,c.jsx)(l.$,{onClick:()=>{e.openDeleteAccountDialog=!1},children:(0,c.jsx)(i.Oj,{name:"cancel"})})]})]})}))},71323:(e,t,n)=>{n.d(t,{D:()=>x});var r=n(46287),o=n(13600),s=n(69229),i=n(59061),a=n(97233),l=n(66459),c=n(5513),d=n(62540);const u=(0,r.A)("img",{target:"e17lg3h3"})("width:3rem;height:3rem;border-radius:1.5rem;border:2px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";box-sizing:border-box;"),h=(0,r.A)("div",{target:"e17lg3h2"})({name:"r2g86h",styles:"display:flex;align-items:center;gap:1rem"}),m=(0,s.PA)((()=>{const{authStore:{authUser:e}}=(0,i.g)();return null===e?(0,d.jsx)(d.Fragment,{}):(0,d.jsxs)(h,{children:[(0,d.jsx)(u,{src:e.photoURL??void 0}),(0,d.jsx)("p",{children:e.displayName})]})})),g=(0,r.A)("div",{target:"e17lg3h1"})({name:"4zk4ri",styles:"display:flex;flex-direction:column;gap:1rem"}),p=(0,r.A)(c.$,{target:"e17lg3h0"})("color:",(e=>{let{theme:t}=e;return t.redColor}),";"),x=(0,s.PA)((()=>{const{rootViewStore:e,authStore:{authUser:t}}=(0,i.g)();return(0,d.jsxs)(l.lG,{open:e.openUserSettingsDialog,style:{minWidth:"30rem"},children:[(0,d.jsx)(o.L3,{children:(0,d.jsx)(a.Oj,{name:"user-settings"})}),(0,d.jsx)(l.Cf,{children:(0,d.jsxs)(g,{children:[(0,d.jsx)(m,{}),(0,d.jsx)(c.$,{onClick:()=>{null!==t&&window.open(`https://signal.vercel.app/users/${t.uid}`)},children:(0,d.jsx)(a.Oj,{name:"profile"})}),(0,d.jsx)(p,{onClick:async()=>{e.openUserSettingsDialog=!1,e.openDeleteAccountDialog=!0},children:(0,d.jsx)(a.Oj,{name:"delete-account"})})]})}),(0,d.jsx)(l.ii,{children:(0,d.jsx)(c.$,{onClick:()=>{e.openUserSettingsDialog=!1},children:(0,d.jsx)(a.Oj,{name:"cancel"})})})]})}))},8567:(e,t,n)=>{n.d(t,{I:()=>c});var r=n(69229),o=n(63696),s=n(50119),i=n(59061),a=n(83445),l=n(62540);const c=(0,r.PA)((()=>{const{arrangeViewStore:e,pianoRollStore:t}=(0,i.g)(),n=(0,s.s0)(),r=(0,o.useCallback)((()=>e.openVelocityDialog=!1),[e]),c=(0,o.useCallback)(((t,r)=>{n({type:r,value:t}),e.openVelocityDialog=!1}),[e,n]);return(0,l.jsx)(a.y,{open:e.openVelocityDialog,value:t.newNoteVelocity,onClickOK:c,onClose:r})}))},47953:(e,t,n)=>{n.d(t,{G:()=>c});var r=n(69229),o=n(63696),s=n(50119),i=n(59061),a=n(83445),l=n(62540);const c=(0,r.PA)((()=>{const{pianoRollStore:e}=(0,i.g)(),t=(0,s.Qm)(),n=(0,o.useCallback)((()=>e.openVelocityDialog=!1),[e]),r=(0,o.useCallback)(((n,r)=>{t({type:r,value:n}),e.openVelocityDialog=!1}),[e,t]);return(0,l.jsx)(a.y,{open:e.openVelocityDialog,value:e.newNoteVelocity,onClickOK:r,onClose:n})}))},83445:(e,t,n)=>{n.d(t,{y:()=>m});var r=n(46287),o=n(63696),s=n(97233),i=n(66459),a=n(5513),l=n(70612),c=n(57499),d=n(62540);const u=(0,r.A)("div",{target:"e6sxpgh1"})({name:"4zk4ri",styles:"display:flex;flex-direction:column;gap:1rem"}),h=(0,r.A)("div",{target:"e6sxpgh0"})({name:"1u1z6e7",styles:"display:flex;gap:2rem"}),m=e=>{let{open:t,value:n,onClickOK:r,onClose:m}=e;const[g,p]=(0,o.useState)("set"),[x,f]=(0,o.useState)(n);(0,o.useEffect)((()=>{t&&f(n)}),[t]);const v=(0,o.useCallback)((()=>{r(x,g),m()}),[x,g]);return(0,d.jsxs)(i.lG,{open:t,style:{minWidth:"20rem"},children:[(0,d.jsx)(i.L3,{children:(0,d.jsx)(s.Oj,{name:"velocity"})}),(0,d.jsx)(i.Cf,{children:(0,d.jsxs)(u,{children:[(0,d.jsx)(c.l,{value:x,onChange:f,style:{flexGrow:1},onEnter:v}),(0,d.jsxs)(h,{children:[(0,d.jsx)(l.a,{label:(0,d.jsx)(s.Oj,{name:"operation-set"}),isSelected:"set"===g,onClick:()=>p("set")}),(0,d.jsx)(l.a,{label:(0,d.jsx)(s.Oj,{name:"operation-add"}),isSelected:"add"===g,onClick:()=>p("add")}),(0,d.jsx)(l.a,{label:(0,d.jsx)(s.Oj,{name:"operation-multiply"}),isSelected:"multiply"===g,onClick:()=>p("multiply")})]})]})}),(0,d.jsxs)(i.ii,{children:[(0,d.jsx)(a.$,{onClick:m,children:(0,d.jsx)(s.Oj,{name:"cancel"})}),(0,d.jsx)(a.$,{onClick:v,children:(0,d.jsx)(s.Oj,{name:"ok"})})]})]})}},50029:(e,t,n)=>{n.d(t,{Q:()=>s});var r=n(63696),o=n(62540);const s=e=>{let{value:t,min:n,max:s,step:i,id:a,onChange:l,onEnter:c,style:d,className:u}=e;const[h,m]=(0,r.useState)(t),g=e=>{m(p(e)),e===t||isNaN(e)||l(e)},p=e=>Math.max(n??Number.NEGATIVE_INFINITY,Math.min(s??Number.POSITIVE_INFINITY,e));return(0,r.useEffect)((()=>{m(t)}),[t]),(0,o.jsx)("input",{type:"number",id:a,min:n,max:s,value:h,step:i,onChange:e=>{g(p(parseFloat(e.target.value)))},onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),e.currentTarget.blur(),c?.())},onBlur:()=>{isNaN(h)&&g(n??0)},style:d,className:u})}},49422:(e,t,n)=>{n.d(t,{J:()=>j,j:()=>y});var r=n(46287),o=n(96604),s=n.n(o),i=n(39751),a=n.n(i),l=n(81381),c=n.n(l),d=n(56988),u=n.n(d),h=n(63696),m=n(20038),g=n(62540);const p=(0,r.A)("div",{target:"e1pbbrg70"})({name:"6kybrt",styles:"display:flex;align-items:center;justify-content:center;>svg{width:15px;height:15px;transform:scale(0.8);}"}),x=e=>{const t=(0,h.useRef)(null),n=s()(t),r=m.ZW,o=n.width-3*r,i={width:r,height:r};return(0,g.jsxs)(m.$H,{ref:t,isVertical:!1,...e,barLength:o,children:[(0,g.jsx)(p,{style:i,onClick:e.onClickScaleDown,children:(0,g.jsx)(u(),{})}),(0,g.jsx)(p,{style:i,onClick:e.onClickScaleReset,children:(0,g.jsx)(c(),{})}),(0,g.jsx)(p,{style:i,onClick:e.onClickScaleUp,children:(0,g.jsx)(a(),{})})]})},f=e=>{const t=(0,h.useRef)(null),n=s()(t),r=m.ZW,o=n.height-3*r,i={width:r,height:r};return(0,g.jsxs)(m.$H,{ref:t,isVertical:!0,...e,barLength:o,children:[(0,g.jsx)(p,{style:i,onClick:e.onClickScaleUp,children:(0,g.jsx)(a(),{})}),(0,g.jsx)(p,{style:i,onClick:e.onClickScaleReset,children:(0,g.jsx)(c(),{})}),(0,g.jsx)(p,{style:i,onClick:e.onClickScaleDown,children:(0,g.jsx)(u(),{})})]})},v=(e,t)=>e.scrollOffset===t.scrollOffset&&e.contentLength===t.contentLength&&e.onScroll===t.onScroll&&e.onClickScaleDown===t.onClickScaleDown&&e.onClickScaleReset===t.onClickScaleReset&&e.onClickScaleUp===t.onClickScaleUp,y=h.memo(x,v),j=h.memo(f,v)},20038:(e,t,n)=>{n.d(t,{$H:()=>f,ZW:()=>u,fJ:()=>k});var r=n(46287),o=n(96604),s=n.n(o),i=n(19401),a=n.n(i),l=n(63696),c=n(54015),d=n(62540);const u=17,h=u;function m(e){return Math.max(0,Math.min(1,e))}const g=(0,r.A)("div",{target:"eku4sek1"})({name:"1khn195",styles:"box-sizing:border-box"}),p=(0,r.A)("div",{target:"eku4sek0"})("height:100%;width:100%;position:absolute;display:flex;&.vertical{width:",u,"px;height:100%;position:absolute;top:0;right:0;flex-direction:column;.button-backward .triangle{transform:rotate(0deg) scale(1.1);}.button-forward .triangle{transform:rotate(180deg) scale(1.1);}}&.horizontal{width:100%;height:",u,"px;position:absolute;bottom:0;left:0;flex-direction:row;&>div{height:100%;}.button-backward .triangle{transform:rotate(-90deg) scale(1.1);}.button-forward .triangle{transform:rotate(90deg) scale(1.1);}}.triangle{flex-grow:1;pointer-events:none;width:15px;height:15px;}.button-backward,.button-forward{text-align:center;align-content:center;display:flex;}"),x=(e,t)=>{let{isVertical:n,barLength:r,scrollOffset:o=50,contentLength:s=1e3,onScroll:i,children:l}=e;const u=s-r,x=r-30,f=m(r/s),y=Math.max(h,x*f),j=u<=0;let k,b;j?(k=0,b=x):(k=Math.floor((x-y)*m(o/u)),b=Math.floor(x-y-k));const w=n?"vertical":"horizontal",S=n?"height":"width",C=e=>i?.(Math.min(u,Math.max(0,e))),T=e=>t=>{if(t.stopPropagation(),j)return;const n=t.target,r=v(t);let s=0,i=o;C(i+=e);const a=()=>document.elementFromPoint(r.x,r.y)===n,l=()=>{clearInterval(s),s=0};(e=>{s=window.setInterval((()=>{clearInterval(s),a()&&(C(i+=e),s=window.setInterval((()=>{C(i+=.5*e),a()||l()}),50))}),300)})(e),(0,c.b)({onMouseMove:e=>{n!==e.target&&l()},onMouseUp:()=>{l()}})},A=(0,d.jsx)(a(),{className:"triangle"});return(0,d.jsxs)(p,{ref:t,className:`ScrollBar ${w}`,children:[(0,d.jsx)("div",{className:"button-backward",style:{[S]:15},onMouseDown:T(-20),children:A}),(0,d.jsx)("div",{className:"page-backward",style:{[S]:k},onMouseDown:T(-80)}),!j&&(0,d.jsx)(g,{className:"thumb",style:{[S]:y},onMouseDown:e=>{if(e.stopPropagation(),j)return;const t=e.target;if(v(e),t.classList.contains("thumb")){const t=o;(0,c.R)(e.nativeEvent,{onMouseMove:(e,r)=>{const o=u/(x-y),s=t+r[n?"y":"x"]*o;C(s)}})}}}),(0,d.jsx)("div",{className:"page-forward",style:{[S]:b},onMouseDown:T(80)}),(0,d.jsx)("div",{className:"button-forward",style:{[S]:15},onMouseDown:T(20),children:A}),l]})},f=l.forwardRef(x);function v(e){return{x:e.pageX,y:e.pageY}}const y=e=>{const t=(0,l.useRef)(null),n=s()(t);return(0,d.jsx)(f,{ref:t,isVertical:!1,...e,barLength:n.width})},j=(e,t)=>e.scrollOffset===t.scrollOffset&&e.contentLength===t.contentLength&&e.onScroll===t.onScroll,k=l.memo(y,j)},55747:(e,t,n)=>{n.d(t,{F:()=>h});var r=n(46287),o=n(79478),s=n.n(o),i=n(32354),a=n.n(i),l=n(62540);const c=(0,r.A)("div",{target:"e1rivfrc1"})("background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";display:flex;padding:1rem;border-radius:0.5rem;line-height:1.5;"),d=e=>{let{severity:t,...n}=e;switch(t){case"info":return(0,l.jsx)(a(),{...n});case"warning":return(0,l.jsx)(s(),{...n})}},u=(0,r.A)("div",{target:"e1rivfrc0"})({name:"to3ihi",styles:"flex-grow:1;display:flex;align-items:center"}),h=e=>{let{children:t,severity:n,...r}=e;return(0,l.jsxs)(c,{...r,children:[(0,l.jsx)(d,{severity:n,style:{marginRight:"1rem",flexShrink:"0"}}),(0,l.jsx)(u,{children:t})]})}},5513:(e,t,n)=>{n.d(t,{$:()=>i,j:()=>a});var r=n(46287),o=n(44308),s=n.n(o);const i=(0,r.A)("button",{target:"e12ykc301"})("display:flex;align-items:center;background:transparent;border:none;border-radius:0.2rem;color:",(e=>{let{theme:t}=e;return t.textColor}),";padding:0.5rem 1rem;cursor:pointer;height:2rem;outline:none;font-size:0.8rem;&:hover{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}&:active{background:",(e=>{let{theme:t}=e;return s()(t.secondaryBackgroundColor).lighten(.1).hex()}),";}"),a=(0,r.A)(i,{target:"e12ykc300"})("background:",(e=>{let{theme:t}=e;return t.themeColor}),";color:",(e=>{let{theme:t}=e;return t.onSurfaceColor}),";&:hover{background:",(e=>{let{theme:t}=e;return s()(t.themeColor).darken(.1).hex()}),";}&:active{background:",(e=>{let{theme:t}=e;return s()(t.themeColor).darken(.2).hex()}),";}")},16066:(e,t,n)=>{n.d(t,{S:()=>m});var r=n(46287),o=n(61209),s=n(95352),i=n.n(s),a=n(15467),l=n(62540);const c=(0,r.A)(o.bL,{target:"e1fjc8rk3"})("border:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";background-color:",(e=>{let{theme:t}=e;return t.backgroundColor}),";width:1.5rem;height:1.5rem;border-radius:0.25rem;display:flex;align-items:center;justify-content:center;&:hover{border-color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";}"),d=(0,r.A)(o.C1,{target:"e1fjc8rk2"})({name:"1wnowod",styles:"display:flex;align-items:center;justify-content:center"}),u=(0,r.A)(i(),{target:"e1fjc8rk1"})("fill:",(e=>{let{theme:t}=e;return t.textColor}),";width:1rem;height:1rem;"),h=(0,r.A)("span",{target:"e1fjc8rk0"})({name:"uaob3j",styles:"margin-left:0.5rem"}),m=e=>{let{label:t,style:n,...r}=e;return(0,l.jsxs)(a.J,{style:{display:"flex",alignItems:"center",...n},children:[(0,l.jsx)(c,{...r,children:(0,l.jsx)(d,{children:(0,l.jsx)(u,{})})}),(0,l.jsx)(h,{children:t})]})}},571:(e,t,n)=>{n.d(t,{P:()=>i});var r=n(83785),o=n(34446),s=n(62540);const i=e=>{let{size:t="2rem"}=e;const n=(0,r.u)();return(0,s.jsx)(o.A,{style:{width:t,height:t},color:n.themeColor})}},27061:(e,t,n)=>{n.d(t,{D:()=>h});var r=n(46287),o=n(20994),s=n(63696),i=n(97233),a=n(5513),l=n(62540);const c=(0,r.A)("div",{target:"ex1t7oo2"})({name:"5thnkd",styles:"display:flex;flex-grow:1"}),d=(0,r.A)("input",{target:"ex1t7oo1"})({name:"1fuj9tb",styles:"flex-grow:1;border:none;border-radius:0.2rem;padding:0.5rem 1rem;font-size:0.8rem;outline:none;margin-right:0.5rem"}),u=(0,r.A)("div",{target:"ex1t7oo0"})(""),h=e=>{let{text:t}=e;const n=(0,o.dj)(),r=(0,i.B2)(),h=(0,s.useCallback)((()=>{navigator.clipboard.writeText(t),n.success(r.copied)}),[t]);return(0,l.jsxs)(c,{children:[(0,l.jsx)(d,{type:"text",value:t,readOnly:!0,onFocus:e=>{e.target.select()}}),(0,l.jsx)(u,{children:(0,l.jsx)(a.j,{onClick:h,children:(0,l.jsx)(i.Oj,{name:"copy"})})})]})}},13906:(e,t,n)=>{n.d(t,{K:()=>r});const r=(0,n(46287).A)("button",{target:"e1pg8lm40"})("width:2rem;height:2rem;display:flex;align-items:center;justify-content:center;border:none;border-radius:999px;background:none;color:",(e=>{let{theme:t,active:n}=e;return n?t.textColor:t.secondaryTextColor}),";cursor:pointer;&:hover{background:",(e=>{let{theme:t}=e;return t.highlightColor}),";}")},15467:(e,t,n)=>{n.d(t,{J:()=>r});const r=(0,n(46287).A)("label",{target:"e1xwgi3w0"})("display:block;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";font-size:0.8rem;font-family:inherit;")},24343:(e,t,n)=>{n.d(t,{h:()=>r});const r=(0,n(46287).A)("progress",{target:"e1fs5k4i0"})("width:100%;-moz-appearance:none;-webkit-appearance:none;background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";&::-webkit-progress-bar{background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";border-radius:0.25rem;height:0.5rem;}&::-webkit-progress-value{background:",(e=>{let{theme:t}=e;return t.themeColor}),";border-radius:0.25rem;height:100%;}border:none;border-radius:0.25rem;height:0.5rem;box-sizing:border-box;&::-moz-progress-bar{background:",(e=>{let{theme:t}=e;return t.themeColor}),";border-radius:0.25rem;height:100%;}")},87944:(e,t,n)=>{n.d(t,{C:()=>l});var r=n(46287),o=n(45432),s=n(27061),i=n(62540);const a=(0,r.A)("div",{target:"e12tas5b0"})({name:"106oewt",styles:"margin-top:1rem;display:grid;grid-template-columns:repeat(auto-fill, minmax(32px, 1fr));grid-gap:0.5rem;&>button:hover{opacity:0.8;}"}),l=e=>{let{url:t,text:n}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.D,{text:t}),(0,i.jsxs)(a,{children:[(0,i.jsx)(o.r6,{url:t,title:n,children:(0,i.jsx)(o.uv,{size:32,round:!0})}),(0,i.jsx)(o.uI,{url:t,children:(0,i.jsx)(o.ik,{size:32,round:!0})}),(0,i.jsx)(o.Kz,{url:t,title:n,children:(0,i.jsx)(o.Y4,{size:32,round:!0})}),(0,i.jsx)(o.rx,{url:t,title:n,children:(0,i.jsx)(o.Hu,{size:32,round:!0})}),(0,i.jsx)(o.mJ,{url:t,title:n,children:(0,i.jsx)(o.aT,{size:32,round:!0})}),(0,i.jsx)(o.Ot,{url:t,subject:"Check out this song on signal",children:(0,i.jsx)(o.aZ,{size:32,round:!0})})]})]})}},94724:(e,t,n)=>{n.d(t,{Dr:()=>d,Nj:()=>u,W1:()=>l});var r=n(46287),o=n(4955),s=(n(63696),n(62540));const i=(0,r.A)(o.UC,{target:"egxm11s3"})("background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";border-radius:0.5rem;box-shadow:0 1rem 3rem ",(e=>{let{theme:t}=e;return t.shadowColor}),";border:1px solid ",(e=>{let{theme:t}=e;return t.popupBorderColor}),";margin:0 1rem;padding:0.5rem 0;"),a=(0,r.A)("ul",{target:"egxm11s2"})({name:"v5al3",styles:"list-style:none;padding:0;margin:0"}),l=e=>{let{trigger:t,open:n,onOpenChange:r,children:l}=e;return(0,s.jsxs)(o.bL,{open:n,onOpenChange:r,children:[(0,s.jsx)(o.l9,{asChild:!0,children:t}),(0,s.jsx)(o.ZL,{children:(0,s.jsx)(i,{children:(0,s.jsx)(a,{children:l})})})]})},c=(0,r.A)("li",{target:"egxm11s1"})("font-size:0.8rem;color:",(e=>{let{theme:t,disabled:n}=e;return n?t.secondaryTextColor:t.textColor}),";display:flex;align-items:center;padding:0.5rem 1rem;pointer-events:",(e=>{let{disabled:t}=e;return t?"none":"auto"}),";cursor:pointer;&:hover{background:",(e=>{let{theme:t,disabled:n}=e;return n?"transparent":t.highlightColor}),";}"),d=e=>{let{children:t,...n}=e;return(0,s.jsx)(c,{...n,children:t})},u=(0,r.A)("hr",{target:"egxm11s0"})("border:none;border-top:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";")},70612:(e,t,n)=>{n.d(t,{a:()=>u});var r=n(46287),o=n(89472),s=n.n(o),i=n(62540);const a=(0,r.A)("div",{target:"egmu54m3"})("display:inline-flex;width:1.25rem;height:1.25rem;border:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";align-items:center;justify-content:center;border-radius:9999px;"),l=(0,r.A)(s(),{target:"egmu54m2"})("fill:",(e=>{let{theme:t}=e;return t.textColor}),";width:0.7rem;height:0.7rem;"),c=(0,r.A)("div",{target:"egmu54m1"})("display:flex;padding:0.5rem 0;align-items:center;&:hover ",a,"{border-color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";}"),d=(0,r.A)("span",{target:"egmu54m0"})("margin-left:0.5rem;font-size:0.8rem;color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";"),u=e=>{let{label:t,isSelected:n,onClick:r}=e;return(0,i.jsxs)(c,{onClick:r,children:[(0,i.jsx)(a,{children:n&&(0,i.jsx)(l,{})}),(0,i.jsx)(d,{children:t})]})}},95881:(e,t,n)=>{n.d(t,{l:()=>d});var r=n(46287),o=n(10716),s=n.n(o),i=n(62540);const a=(0,r.A)("select",{target:"evg0ddz2"})("display:block;width:100%;appearance:none;border:none;background:inherit;border:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";border-radius:0.25rem;height:3rem;padding:0 1rem;display:flex;align-items:center;justify-content:center;box-sizing:border-box;color:inherit;font-size:1rem;font-family:inherit;outline:none;&:focus{border-color:",(e=>{let{theme:t}=e;return t.themeColor}),";}option{color:",(e=>{let{theme:t}=e;return t.textColor}),";background:",(e=>{let{theme:t}=e;return t.backgroundColor}),";}"),l=(0,r.A)(s(),{target:"evg0ddz1"})({name:"6watob",styles:"position:absolute;right:0.5rem;top:0.8rem;pointer-events:none"}),c=(0,r.A)("div",{target:"evg0ddz0"})({name:"bjn8wh",styles:"position:relative"}),d=e=>(0,i.jsxs)(c,{children:[(0,i.jsx)(a,{...e}),(0,i.jsx)(l,{})]})},60962:(e,t,n)=>{n.d(t,{A:()=>u});var r=n(46287),o=n(99245),s=n(62540);const i=(0,r.A)(o.bL,{target:"e1kkyjvb4"})({name:"qb5ck1",styles:"position:relative;display:flex;flex-grow:1;align-items:center;user-select:none;touch-action:none;height:2rem"}),a=(0,r.A)(o.CC,{target:"e1kkyjvb3"})("background-color:",(e=>{let{theme:t}=e;return t.tertiaryTextColor}),";position:relative;flex-grow:1;border-radius:9999px;height:0.1rem;"),l=(0,r.A)(o.Q6,{target:"e1kkyjvb2"})("position:absolute;background-color:",(e=>{let{theme:t}=e;return t.textColor}),";border-radius:9999px;height:100%;"),c=(0,r.A)(o.zi,{target:"e1kkyjvb1"})("display:block;width:0.75rem;height:0.75rem;background-color:",(e=>{let{theme:t}=e;return t.textColor}),";box-shadow:0 0.1rem 1rem ",(e=>{let{theme:t}=e;return t.shadowColor}),";border-radius:999px;&:hover{background-color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";}&:focus{outline:none;}"),d=(0,r.A)("div",{target:"e1kkyjvb0"})("width:0.1rem;height:100%;position:absolute;background-color:",(e=>{let{theme:t}=e;return t.textColor}),";"),u=e=>{let{value:t,onChange:n,defaultValue:r,marks:o,...u}=e;return(0,s.jsxs)(i,{value:[t],defaultValue:void 0!==r?[r]:void 0,onValueChange:e=>n(e[0]),...u,children:[(0,s.jsxs)(a,{children:[(0,s.jsx)(l,{}),o?.map(((e,t)=>(0,s.jsx)(d,{style:{left:e/(u.max??100)*100+"%"}},t)))]}),(0,s.jsx)(c,{tabIndex:-1})]})}},57499:(e,t,n)=>{n.d(t,{l:()=>s});var r=n(46287),o=n(50029);const s=(0,r.A)(o.Q,{target:"e1izyqwe0"})("display:block;appearance:none;border:none;background:inherit;border:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";border-radius:0.25rem;height:3rem;padding:0 1rem;align-items:center;justify-content:center;box-sizing:border-box;color:inherit;font-size:1rem;font-family:",(e=>{let{theme:t}=e;return t.monoFont}),";outline:none;&:focus{border-color:",(e=>{let{theme:t}=e;return t.themeColor}),";}")},4830:(e,t,n)=>{n.d(t,{A:()=>r});const r=(0,n(46287).A)("input",{target:"ev1z3q10"})("display:block;appearance:none;border:none;background:inherit;border:1px solid ",(e=>{let{theme:t}=e;return t.dividerColor}),";border-radius:0.25rem;height:3rem;padding:0 1rem;align-items:center;justify-content:center;box-sizing:border-box;color:inherit;font-size:1rem;font-family:inherit;outline:none;&:focus{border-color:",(e=>{let{theme:t}=e;return t.themeColor}),";}")},77684:(e,t,n)=>{n.d(t,{y:()=>b});var r=n(46287),o=n(91785),s=n(83785),i=n(22538),a=n(57890),l=n.n(a),c=n(79478),d=n.n(c),u=n(54112),h=n.n(u),m=n(32354),g=n.n(m),p=n(63696),x=n(62540);const f=o.i7`
  from {
    opacity: 0;
    transform: translate(0, 0.5rem) scale(0.96);
  }
  to {
    opacity: 1;
    transform: translate(0, 0) scale(1);
  }
`,v=o.i7`
  from {
    opacity: 1;
    transform: translate(0, 0) scale(1);
  }
  to {
    opacity: 0;
    transform: translate(0, 0.5rem) scale(0.96);
  }
`,y=(0,r.A)(i.b,{target:"euru6zc1"})({name:"sgtmti",styles:"position:fixed;bottom:2rem;left:0;right:0;display:flex"}),j=(0,r.A)("div",{target:"euru6zc0"})("margin:0 auto;background:",(e=>{let{theme:t}=e;return t.secondaryBackgroundColor}),";padding:1rem;border-radius:0.5rem;font-size:0.8rem;box-shadow:0 0.5rem 3rem ",(e=>{let{theme:t}=e;return t.shadowColor}),";display:flex;align-items:center;animation:",(e=>{let{show:t}=e;return t?f:v})," 500ms cubic-bezier(0.16, 1, 0.3, 1) forwards;"),k=e=>{let{severity:t}=e;const n=(0,s.u)(),r=w(t,n);switch(t){case"error":return(0,x.jsx)(l(),{style:{fill:r}});case"info":return(0,x.jsx)(g(),{style:{fill:r}});case"success":return(0,x.jsx)(h(),{style:{fill:r}});case"warning":return(0,x.jsx)(d(),{style:{fill:r}})}},b=e=>{let{message:t,severity:n,onExited:r}=e;const[o,s]=(0,p.useState)(!0);return(0,p.useEffect)((()=>{const e=setTimeout((()=>s(!1)),4500),t=setTimeout(r,5e3);return()=>{clearTimeout(e),clearTimeout(t)}})),(0,x.jsx)(y,{children:(0,x.jsxs)(j,{show:o,children:[(0,x.jsx)(k,{severity:n}),(0,x.jsx)("div",{style:{width:"0.5rem"}}),t]})})},w=(e,t)=>{switch(e){case"error":return t.redColor;case"info":return t.textColor;case"success":return t.greenColor;case"warning":return t.yellowColor}}},96016:(e,t,n)=>{n.d(t,{m:()=>c});var r=n(46287),o=n(70791),s=n(44308),i=n.n(s),a=n(62540);const l=(0,r.A)(o.UC,{target:"e116mko0"})("background:",(e=>{let{theme:t}=e;return i()(t.backgroundColor).darken(.2).hex()}),";color:",(e=>{let{theme:t}=e;return t.secondaryTextColor}),";padding:0.5rem;border-radius:0.5rem;box-shadow:0 1rem 3rem ",(e=>{let{theme:t}=e;return t.shadowColor}),";"),c=e=>{let{children:t,title:n,side:r="bottom",...s}=e;return(0,a.jsx)(o.Kq,{...s,children:(0,a.jsxs)(o.bL,{children:[(0,a.jsx)(o.l9,{asChild:!0,children:t}),(0,a.jsx)(o.ZL,{children:(0,a.jsx)(l,{side:r,sideOffset:5,children:n})})]})})}},76646:(e,t,n)=>{n.d(t,{d:()=>o});var r=n(52188);let o;(o||(o={})).createInRange=(e,t,n)=>{const o=[],s=r.t.getMeasuresInRange(e,n);return s.forEach(((e,r)=>{const i=s[r+1],a=4*t/e.denominator,l=i?i.tick:n[1],c=Math.max(0,Math.floor((n[0]-e.tick)/a)),d=(l-e.tick)/a;for(let t=c;t<d;t++){const n=e.tick+a*t;o.push({measure:e.measure+Math.floor(t/e.numerator),beat:t%e.numerator,tick:n})}})),o}},8660:(e,t,n)=>{n.d(t,{B:()=>s});var r=n(71229),o=n(76646);let s;(s||(s={})).createInRange=(e,t,n,s,i)=>o.d.createInRange(e,n,r.Q.fromLength(t.getTick(s),t.getTick(i))).map((e=>({...e,x:Math.round(t.getX(e.tick))})))},29909:(e,t,n)=>{n.d(t,{a:()=>s});var r=n(6358),o=n(22095);let s;var i;(i=s||(s={})).getEventFactory=e=>t=>{switch(e.type){case"pitchBend":return(0,r.fJ)(0,0,Math.round(t));case"controller":return(0,r.Q9)(0,0,e.controllerType,Math.round(t))}},i.getEventPredicate=e=>{switch(e.type){case"pitchBend":return o.Y6;case"controller":return(0,o.HG)(e.controllerType)}},i.equals=(e,t)=>{switch(e.type){case"pitchBend":return"pitchBend"===t.type;case"controller":return"controller"===t.type&&e.controllerType===t.controllerType}}},51382:(e,t,n)=>{let r;var o;n.d(t,{b:()=>r}),(o=r||(r={})).sub=function(e,t){return{x:e.x-t.x,y:e.y-t.y}},o.add=function(e,t){return{x:e.x+t.x,y:e.y+t.y}},o.zero={x:0,y:0}},71229:(e,t,n)=>{let r;var o;n.d(t,{Q:()=>r}),(o=r||(r={})).fromLength=function(e,t){return[e,e+t]},o.create=function(e,t){return[e,t]},o.point=function(e){return[e,e]},o.contains=function(e,t){const[n,r]=e;return n<=t&&t<r},o.intersects=function(e,t){const[n,r]=e,[o,s]=t;return n<s&&o<r},o.clamp=function(e,t){const[n,r]=e;return Math.min(Math.max(n,t),r)}},70480:(e,t,n)=>{let r;n.d(t,{r:()=>r}),function(e){function t(e){return e.x+e.width}function n(e){return e.y+e.height}function o(e){return{x:t(e),y:n(e)}}e.containsPoint=function(e,t){return t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height},e.right=t,e.bottom=n,e.intersects=function(e,r){return t(e)>r.x&&t(r)>e.x&&n(e)>r.y&&n(r)>e.y},e.containsRect=function(e,t){return r.containsPoint(e,t)&&r.containsPoint(e,o(t))},e.br=o,e.fromPoints=function(e,t){const n=Math.min(e.x,t.x),r=Math.max(e.x,t.x),o=Math.min(e.y,t.y);return{x:n,y:o,width:r-n,height:Math.max(e.y,t.y)-o}},e.scale=function(e,t,n){return{x:e.x*t,y:e.y*n,width:e.width*t,height:e.height*n}},e.zero={x:0,y:0,width:0,height:0},e.move=function(e,t){return{x:e.x+t.x,y:e.y+t.y,width:e.width,height:e.height}}}(r||(r={}))},52188:(e,t,n)=>{let r;n.d(t,{t:()=>r}),function(e){const t={tick:0,measure:0,denominator:4,numerator:4};e.fromTimeSignatures=function(e,n){if(0===e.length)return[t];{let t=0;return e.map(((r,o)=>{let s=0;if(o>0){const i=e[o-1],a=4*n/i.denominator,l=Math.floor((r.tick-i.tick)/a/i.numerator);s=t+l,t=s}return{tick:r.tick,measure:s,numerator:r.numerator,denominator:r.denominator}}))}},e.getMBTString=function(e,t,r){return(arguments.length>3&&void 0!==arguments[3]?arguments[3]:s)(n(e,t,r))},e.getMeasuresInRange=(e,n)=>{let r=0;const o=[];for(const s of e){const i=e[r+1];if(r++,0===o.length){if(void 0!==i&&i.tick<=n[0])continue;s.tick>n[0]?(console.warn("There is no initial time signature. Use 4/4 by default"),o.push(t)):o.push(s)}if(0!==o.length){if(!(s.tick<=n[1]))break;o.push(s)}}return o};const n=(e,n,r)=>((e,t,n)=>{const r=4*n/e.denominator,o=r*e.numerator;let s=t-e.tick;const i=Math.floor(s/o);s-=i*o;const a=Math.floor(s/r);return s-=a*r,{measure:e.measure+i,beat:a,tick:s}})(i(e,n)??t,n,r);function r(e,n,r){const o=i(e,n)??t,s=4*r/o.denominator*o.numerator,a=Math.floor((n-o.tick)/s);return{tick:o.tick+s*a,duration:s,ticksPerBeat:4*r/o.denominator,eventTick:o.tick,numerator:o.numerator}}e.getMeasureStart=r,e.getPreviousMeasureTick=function(e,t,n){const o=r(e,t,n);return t>o.tick+o.ticksPerBeat?o.tick:r(e,o.tick-1,n).tick},e.getNextMeasureTick=function(e,t,n){const o=r(e,t,n);return o.tick+o.duration}}(r||(r={}));const o=(e,t)=>{const n=e.toFixed(0);return("0".repeat(t)+n).slice(-Math.max(t,n.length))};function s(e){return`${o(e.measure+1,4)}:${o(e.beat+1,2)}:${o(e.tick,3)}`}function i(e,t){let n=null;for(const r of e){if(r.tick>t)break;n=r}return n}},64659:(e,t,n)=>{n.d(t,{u:()=>o});var r=n(54164);let o;(o||(o={})).getIntervals=e=>r.F.getIntegerNotation(e.scale).map((t=>(t+e.key)%12))},54164:(e,t,n)=>{n.d(t,{F:()=>r});let r;var o;(o=r||(r={})).values=["major","minor","harmonicMajor","harmonicMinor","melodicMinor","ionian","dorian","phrygian","lydian","mixolydian","aeolian","locrian","majorPentatonic","minorPentatonic","majorBlues","minorBlues","halfWholeDiminished","wholeHalfDiminished","wholeTone"],o.getIntegerNotation=e=>{switch(e){case"major":case"ionian":return[0,2,4,5,7,9,11];case"minor":case"aeolian":return[0,2,3,5,7,8,10];case"harmonicMinor":return[0,2,3,5,7,8,11];case"harmonicMajor":return[0,2,4,5,7,8,11];case"melodicMinor":return[0,2,3,5,7,9,11];case"dorian":return[0,2,3,5,7,9,10];case"phrygian":return[0,1,3,5,7,8,10];case"lydian":return[0,2,4,6,7,9,11];case"mixolydian":return[0,2,4,5,7,9,10];case"locrian":return[0,1,3,5,6,8,10];case"majorPentatonic":return[0,2,4,7,9];case"minorPentatonic":return[0,3,5,7,10];case"majorBlues":return[0,2,3,4,7,9];case"minorBlues":return[0,3,5,6,7,10];case"halfWholeDiminished":return[0,1,3,4,6,7,9,10];case"wholeHalfDiminished":return[0,2,3,5,6,8,9,11];case"wholeTone":return[0,2,4,6,8,10]}}},95949:(e,t,n)=>{let r;n.d(t,{p:()=>r}),function(e){e.fromPoints=function(e,o,s,i){const a=t(e,s),l=t(o,s);return r(n(a,l),i)};const t=e.fromPoint=(e,t)=>({fromTick:t.floor(e.tick),toTick:t.ceil(e.tick),fromTrackIndex:Math.floor(e.trackIndex),toTrackIndex:Math.floor(e.trackIndex)+1}),n=e.union=(e,t)=>({fromTick:Math.min(e.fromTick,t.fromTick),toTick:Math.max(e.toTick,t.toTick),fromTrackIndex:Math.min(e.fromTrackIndex,t.fromTrackIndex),toTrackIndex:Math.max(e.toTrackIndex,t.toTrackIndex)}),r=e.clamp=(e,t)=>({fromTick:Math.max(0,e.fromTick),toTick:Math.max(0,e.toTick),fromTrackIndex:Math.min(t,Math.max(0,e.fromTrackIndex)),toTrackIndex:Math.min(t,Math.max(0,e.toTrackIndex))});e.moved=(e,t)=>({fromTick:e.fromTick+t.tick,toTick:e.toTick+t.tick,fromTrackIndex:e.fromTrackIndex+t.trackIndex,toTrackIndex:e.toTrackIndex+t.trackIndex}),e.start=function(e){return{tick:e.fromTick,trackIndex:e.fromTrackIndex}},e.end=function(e){return{tick:e.toTick,trackIndex:e.toTrackIndex}}}(r||(r={}))},40540:(e,t,n)=>{n.d(t,{L:()=>s});var r=n(17243),o=n(92770);let s;var i;(i=s||(s={})).getBounds=(e,t)=>{const n=t.getX(e.fromTick),r=t.getX(e.toTick),o=t.getY(e.fromNoteNumber);return{x:n,y:o,width:r-n,height:t.getY(e.toNoteNumber)-o}},i.moved=(e,t,n)=>({fromTick:e.fromTick+t,fromNoteNumber:e.fromNoteNumber+n,toTick:e.toTick+t,toNoteNumber:e.toNoteNumber+n}),i.fromPoints=function(e,t){const n=Math.min(e.tick,t.tick),s=Math.max(e.tick,t.tick),i=Math.ceil(Math.max(e.noteNumber,t.noteNumber)),a=Math.floor(Math.min(e.noteNumber,t.noteNumber));return{fromTick:Math.max(0,n),fromNoteNumber:(0,r.clamp)(i,-1,o.a2),toTick:Math.max(0,s),toNoteNumber:(0,r.clamp)(a,-1,o.a2)}},i.getFrom=function(e){return{tick:e.fromTick,noteNumber:e.fromNoteNumber}},i.getTo=function(e){return{tick:e.toTick,noteNumber:e.toNoteNumber}}},6463:(e,t,n)=>{let r;n.d(t,{w:()=>r}),(r||(r={})).getBounds=(e,t)=>{const n=t.getX(e.fromTick);return{x:n,y:0,width:t.getX(e.toTick)-n,height:t.height}}},20883:(e,t,n)=>{n.d(t,{w:()=>r});class r{constructor(e,t){this.transform=e,this.pixelsPerTrack=t}getX(e){return this.transform.getX(e)}getY(e){return e*this.pixelsPerTrack}getTick(e){return this.transform.getTick(e)}getTrackIndex(e){return e/this.pixelsPerTrack}getArrangePoint(e){return{tick:this.getTick(e.x),trackIndex:this.getTrackIndex(e.y)}}}},30876:(e,t,n)=>{let r;var o;n.d(t,{n:()=>r}),(o=r||(r={})).sub=function(e,t){return{tick:e.tick-t.tick,trackIndex:e.trackIndex-t.trackIndex}},o.clamp=function(e,t){return{tick:Math.max(0,e.tick),trackIndex:Math.max(0,Math.min(t,e.trackIndex))}}},67178:(e,t,n)=>{n.d(t,{d:()=>r});class r{constructor(e,t,n,r){this.transform=e,this.maxValue=t,this.height=n,this.lineWidth=r}getX(e){return this.transform.getX(e)}getTick(e){return Math.floor(this.transform.getTick(e))}getY(e){return(1-e/this.maxValue)*(this.height-2*this.lineWidth)+this.lineWidth}getValue(e){return Math.floor((1-(e-this.lineWidth)/(this.height-2*this.lineWidth))*this.maxValue)}toPosition(e,t){return{x:Math.round(this.getX(e)),y:Math.round(this.getY(t))}}fromPosition(e){return{tick:this.getTick(e.x),value:this.getValue(e.y)}}transformSelection(e){const t=this.getX(e.fromTick);return{x:t,y:0,width:this.getX(e.toTick)-t,height:this.height}}}},48077:(e,t,n)=>{n.d(t,{a:()=>r});class r{constructor(e,t,n){this.pixelsPerTick=e,this.pixelsPerKey=t,this.maxNoteNumber=n}getX(e){return e*this.pixelsPerTick}getY(e){return(this.maxNoteNumber-e)*this.pixelsPerKey}getTick(e){return e/this.pixelsPerTick}getNoteNumber(e){return Math.ceil(this.getNoteNumberFractional(e))}getNoteNumberFractional(e){return this.maxNoteNumber-e/this.pixelsPerKey}getDeltaNoteNumber(e){return-e/this.pixelsPerKey}get numberOfKeys(){return this.maxNoteNumber+1}getMaxY(){return this.numberOfKeys*this.pixelsPerKey}getRect(e){return{x:this.getX(e.tick),y:this.getY(e.noteNumber),width:this.getX(e.duration),height:this.pixelsPerKey}}getDrumRect(e){return{x:this.getX(e.tick)-this.pixelsPerKey/2,y:this.getY(e.noteNumber),width:this.pixelsPerKey,height:this.pixelsPerKey}}getNotePoint(e){return{tick:this.getTick(e.x),noteNumber:this.getNoteNumber(e.y)}}getNotePointFractional(e){return{tick:this.getTick(e.x),noteNumber:this.getNoteNumberFractional(e.y)}}equals(e){return this.pixelsPerKey===e.pixelsPerKey&&this.pixelsPerTick===e.pixelsPerTick&&this.maxNoteNumber===e.maxNoteNumber}get horizontalId(){return this.pixelsPerTick}}},3354:(e,t,n)=>{n.d(t,{T:()=>o});var r=n(2265);let o;var s;(s=o||(o={})).clamp=e=>({tick:Math.max(0,e.tick),noteNumber:r.i.clamp(e.noteNumber)}),s.equals=function(e,t){return e.tick===t.tick&&e.noteNumber===t.noteNumber},s.sub=function(e,t){return{tick:e.tick-t.tick,noteNumber:e.noteNumber-t.noteNumber}},s.add=function(e,t){return{tick:e.tick+t.tick,noteNumber:e.noteNumber+t.noteNumber}}},81220:(e,t,n)=>{n.d(t,{L:()=>r});class r{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:320;this.pixelsPerTick=e,this.height=t,this.maxBPM=n}getX(e){return e*this.pixelsPerTick}getY(e){return(1-e/this.maxBPM)*this.height}getMaxY(){return this.height}getTick(e){return e/this.pixelsPerTick}getBPM(e){return(1-e/this.height)*this.maxBPM}getDeltaBPM(e){return-e/this.height*this.maxBPM}equals(e){return this.pixelsPerTick===e.pixelsPerTick&&this.height===e.height&&this.maxBPM===e.maxBPM}fromPosition(e){return{tick:this.getTick(e.x),bpm:this.getBPM(e.y)}}}},2265:(e,t,n)=>{n.d(t,{i:()=>o});var r=n(92770);let o;var s;(s=o||(o={})).clamp=e=>Math.min(r.a2,Math.max(0,e)),s.isValid=e=>e>=0&&e<=r.a2},52932:(e,t,n)=>{n.d(t,{Cn:()=>u,j2:()=>c,kA:()=>d});var r=n(64913),o=n(17354),s=n(491),i=n(45271);const a={apiKey:"MISSING_ENV_VAR".FIREBASE_API_KEY,authDomain:"MISSING_ENV_VAR".FIREBASE_AUTH_DOMAIN,projectId:"MISSING_ENV_VAR".FIREBASE_PROJECT_ID,storageBucket:"MISSING_ENV_VAR".FIREBASE_STORAGE_BUCKET,messagingSenderId:"MISSING_ENV_VAR".FIREBASE_MESSAGING_SENDER_ID,appId:"MISSING_ENV_VAR".FIREBASE_APP_ID},l=(()=>{try{const e=(0,r.Wp)(a),t=(0,o.xI)(e);return{app:e,auth:t,firestore:(0,s.aU)(e),functions:(0,i.Uz)(e)}}catch(e){console.warn(`Failed to initialize Firebase: ${e}`)}return{app:null,auth:null,firestore:null,functions:null}})(),c=(l.app,l.auth),d=l.firestore,u=l.functions},72343:(e,t,n)=>{n.d(t,{B:()=>r,N:()=>o});const r=e=>{const t=e.rgb().array();return[t[0]/255,t[1]/255,t[2]/255,e.alpha()]},o=(e,t,n)=>t?e.lighten(n):e.darken(n)},80406:(e,t,n)=>{function r(e,t){const n=window.URL.createObjectURL(e);!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"noname";const n=document.createElement("a");n.href=e,n.download=t,n.style.display="none",document.body.appendChild(n),n.click(),n.remove()}(n,t),setTimeout((()=>window.URL.revokeObjectURL(n)),1e3)}n.d(t,{W:()=>r})},20604:(e,t,n)=>{function r(e){return null!==e}function o(e){return void 0!==e}n.d(t,{EA:()=>o,F9:()=>s,Pe:()=>r,Q6:()=>i});const s=(e,t)=>{const n=[];for(let r=0;r<e.length;r++)n.push(e[r]),r<e.length-1&&n.push(t(e[r],e[r+1]));return n},i=(e,t,n)=>{const r=[];for(let o=e;o<=t;o+=n)r.push(o);return r}},26556:(e,t,n)=>{n.d(t,{M:()=>o,bU:()=>i,w4:()=>s});const r=6e7;function o(e){return r/e}function s(e){return r/e}function i(e,t,n){return e/(n/60)/t*1e3}},30013:(e,t,n)=>{n.d(t,{X:()=>i,l:()=>a});var r=n(38257),o=n(17243),s=n(46952);const i=async e=>{const t=new r.x3(e.numberOfChannels,e.sampleRate,128),n=[],[s,i]=[e.getChannelData(0),e.getChannelData(1)],a=new Int16Array(s.length),l=new Int16Array(i.length),c=Math.max((0,o.max)(s.map((e=>Math.abs(e))))??0,(0,o.max)(i.map((e=>Math.abs(e))))??0);for(var d=0;d<s.length;d++)a[d]=s[d]/c*32767.5,l[d]=i[d]/c*32767.5;const u=1152;for(d=0;d<a.length;d+=u){const e=a.subarray(d,d+u),r=l.subarray(d,d+u);(h=t.encodeBuffer(e,r)).length>0&&n.push(h)}var h;return(h=t.flush()).length>0&&n.push(h),function(e){const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);let r=0;for(const t of e)n.set(t,r),r+=t.length;return n}(n)},a=async e=>await(0,s.l)({sampleRate:e.sampleRate,channelData:[e.getChannelData(0),e.getChannelData(1)]})},51046:(e,t,n)=>{n.d(t,{F:()=>o,L:()=>s});var r=n(71229);const o=e=>t=>r.Q.contains(e,t.tick),s=e=>t=>{if("duration"in t&&"number"==typeof t.duration){const n=t.tick+t.duration,o=r.Q.create(t.tick,n);return r.Q.intersects(e,o)}return r.Q.contains(e,t.tick)}},28632:(e,t,n)=>{n.d(t,{L:()=>s});var r=n(50416),o=n(70429);const s=(e,t)=>{const n=r.vt();return r.kN(n,o.fA(e,t,0)),n}},12968:(e,t,n)=>{n.d(t,{i:()=>r});const r=e=>({x:e.clientX,y:e.clientY})},28011:(e,t,n)=>{n.d(t,{C:()=>s,f:()=>o});var r=n(6358);function o(e){const t=[],n=[];return e.forEach((e=>{if("subtype"in e)switch(e.subtype){case"noteOn":t.push(e);break;case"noteOff":{const r=function(e){const n=t.findIndex((t=>t.noteNumber===e.noteNumber));if(n<0)return null;const r=t[n];return t.splice(n,1),r}(e);if(null!=r){const t={...r,subtype:"note",id:-1,tick:r.tick,duration:e.tick-r.tick};n.push(t)}break}default:n.push(e)}else n.push(e)})),n}function s(e){if("subtype"in e&&"note"===e.subtype){const t=e.channel??-1,n=(0,r.d1)(0,t,e.noteNumber,e.velocity),o=(0,r.dG)(0,t,e.noteNumber);return[{...n,tick:e.tick},{...o,tick:e.tick+e.duration}]}return[e]}},44569:(e,t,n)=>{n.d(t,{bF:()=>s,mi:()=>i});var r=n(10962);const o=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function s(e){const t=Math.floor(e/12)-1;return`${o[e%12]}${t}`}function i(e){return r.ZG[e]}},54015:(e,t,n)=>{n.d(t,{R:()=>i,b:()=>s});var r=n(51382),o=n(12968);const s=e=>{let{onMouseMove:t,onMouseUp:n,onClick:r}=e,o=!1;const s=e=>{o=!0,t?.(e)},i=e=>{n?.(e),o||r?.(e),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",i)};document.addEventListener("mousemove",s),document.addEventListener("mouseup",i)},i=(e,t)=>{let{onMouseMove:n,onMouseUp:s,onClick:i}=t,a=!1;const l=(0,o.i)(e),c=e=>{a=!0;const t=(0,o.i)(e),s=r.b.sub(t,l);n?.(e,s)},d=e=>{s?.(e),a||i?.(e),document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",d)};document.addEventListener("mousemove",c),document.addEventListener("mouseup",d)}},92390:(e,t,n)=>{function r(e){return e.split("/").pop()}n.d(t,{P:()=>r})},92234:(e,t,n)=>{function r(){var e=navigator.platform.toLowerCase(),t=null;return e.indexOf("win")>=0?t="Windows":e.indexOf("mac")>=0&&(t="macOS"),t}function o(){return navigator.userAgent.toLowerCase().indexOf(" electron/")>-1}n.d(t,{r:()=>o,u:()=>r})},99119:(e,t,n)=>{n.d(t,{Z:()=>r});const r=(0,n(39013).Ie)((e=>e),(e=>e))},54493:(e,t,n)=>{n.d(t,{R:()=>c,T:()=>a});var r=n(73406),o=n.n(r),s=n(63166),i=n(28011);function a(e){let t=0;return e.sort(((e,t)=>e.tick-t.tick)).map((e=>{const n={...e,deltaTime:Math.round(e.tick)-Math.round(t)};return delete n.tick,t=e.tick,n}))}const l=e=>(0,s.XS)(e)?(0,s.X6)(e):e;function c(e){return a(o()(e.map(l).map(i.C)))}},67200:(e,t,n)=>{n.d(t,{$z:()=>i,TN:()=>u,os:()=>d});var r=n(22095),o=n(63166),s=n(28011);function i(e){let t=0;return e.map((e=>{const{deltaTime:n,...r}=e;return t+=n,{...r,tick:t}}))}const a=e=>{const{channel:t,...n}=e;return n},l=e=>!("meta"===e.type&&"endOfTrack"===e.subtype),c=e=>(0,r.c_)(e)?(0,o.m0)(e):e;function d(e){return(0,s.f)(i(e.filter(l)).map(c)).map(a)}function u(e){return(0,s.f)(e.filter(l).map(c)).map(a)}},25649:(e,t,n)=>{n.d(t,{T:()=>r});const r=e=>{if(!e.shiftKey&&0!==e.deltaX)return!0;if(e.shiftKey&&0!==e.deltaY)return!0;const{wheelDeltaY:t}=e;return Number.isInteger(e.deltaX)&&Number.isInteger(e.deltaY)&&Math.abs(t)%120!=0}},2316:(e,t,n)=>{n.d(t,{R:()=>d});var r=n(20994),o=n(50119),s=n(11735),i=n(13917),a=n(97233),l=n(35521),c=n(59061);const d=()=>{const{songStore:e,rootViewStore:t}=(0,c.g)(),{song:n}=e,d=(0,r.dj)(),u=(0,r.kc)(),h=(0,r.sp)(),{show:m}=(0,r.p1)(),g=(0,a.B2)(),p=(0,o.pC)(),x=(0,o.jX)(),f=(0,o.k9)(),v=(0,i.q5)(),y=(0,s.cx)(),j=(0,s.ps)(),k=async()=>{const{song:t}=e;if(null!==t.cloudSongId){if(0===t.name.length){const e=await u.show({title:g["save-as"]});null!==e&&e.length>0&&(t.name=e)}const e=m(g["song-saving"]);try{await y(t),d.success(g["song-saved"])}catch(e){alert(e.message)}finally{e()}}else{if(0===t.name.length){const e=await u.show({title:g["save-as"]});null!==e&&e.length>0&&(t.name=e)}const e=m(g["song-saving"]);try{await j(t),d.success(g["song-created"])}catch(e){alert(e.message)}finally{e()}}},b=async()=>{const{song:t}=e;if(t.isSaved)return!0;switch(await h.show({title:g["save-changes"],actions:[{title:g.yes,key:"yes"},{title:g.no,key:"no"},{title:g.cancel,key:"cancel"}]})){case"yes":return await k(),!0;case"no":return!0;case"cancel":return!1}};return{async createNewSong(){try{if(!await b())return;const e=(0,l.p)();p(e),await j(e),d.success(g["song-created"])}catch(e){d.error(e.message)}},async openSong(){try{if(!await b())return;t.openCloudFileDialog=!0}catch(e){d.error(e.message)}},async saveSong(){await k()},async saveAsSong(){try{const e=await u.show({title:g["save-as"],initialText:n.name});if(!(null!==e&&e.length>0))return;n.name=e,await j(n),d.success(g["song-saved"])}catch(e){d.error(e.message)}},async renameSong(){try{const e=await u.show({title:g.rename});if(!(null!==e&&e.length>0))return Promise.resolve(!1);n.name=e,null!==n.cloudSongId?await y(n):await j(n),d.success(g["song-saved"])}catch(e){d.error(e.message)}},async importSong(){try{if(!await b())return;await v(),await k()}catch(e){d.error(e.message)}},async importSongLegacy(e){try{await x(e.currentTarget),await k()}catch(e){d.error(e.message)}},async exportSong(){try{i.Ye?await(0,i.c6)(n):f()}catch(e){d.error(e.message)}},async publishSong(){t.openPublishDialog=!0}}}},78439:(e,t,n)=>{n.d(t,{E:()=>o});var r=n(63696);const o=()=>{const[e,t]=(0,r.useState)({mouseX:0,mouseY:0,isOpen:!1});return{onContextMenu:(0,r.useCallback)((e=>{e.preventDefault(),t({mouseX:e.clientX-2,mouseY:e.clientY-4,isOpen:!0})}),[]),menuProps:{handleClose:()=>{t({...e,isOpen:!1})},isOpen:e.isOpen,position:{x:e.mouseX,y:e.mouseY}}}}},53416:(e,t,n)=>{n.d(t,{P:()=>l});var r=n(20994),o=n(50119),s=n(13917),i=n(97233),a=n(59061);const l=()=>{const{song:e}=(0,a.g)(),t=(0,r.dj)(),n=(0,i.B2)(),l=(0,o.ps)(),c=(0,o.jX)(),d=(0,o.k9)(),u=(0,s.q5)();return{async createNewSong(){(e.isSaved||confirm(n["confirm-new"]))&&l()},async openSong(){try{(e.isSaved||confirm(n["confirm-open"]))&&await u()}catch(e){t.error(e.message)}},async openSongLegacy(r){try{(e.isSaved||confirm(n["confirm-new"]))&&await c(r.currentTarget)}catch(r){t.error(r.message)}},async saveSong(){await(0,s.OJ)(e)},async saveAsSong(){await(0,s.c6)(e)},async downloadSong(){d()}}}},59061:(e,t,n)=>{n.d(t,{P:()=>o,g:()=>s});var r=n(63696);const o=(0,r.createContext)(null),s=()=>(0,r.useContext)(o)},9357:(e,t,n)=>{var r=n(66919),o=n(5302),s=n(89193),i=n(7470),a=n(46685),l=n(62540);r.Ts({dsn:"MISSING_ENV_VAR".SENTRY_DSN,environment:"MISSING_ENV_VAR".VERCEL_ENV,integrations:[o.dp()],tracesSampleRate:1}),(0,s.jK)({enforceActions:"never"}),(0,i.H)(document.querySelector("#root")).render((0,l.jsx)(a.q,{})),"serviceWorker"in navigator&&window.addEventListener("load",(()=>{navigator.serviceWorker.register("/service-worker.js",{scope:"/edit"}).then((e=>{console.log("SW registered: ",e)})).catch((e=>{console.log("SW registration failed: ",e)}))}))},69673:(e,t,n)=>{n.d(t,{t:()=>r});const r=(()=>{switch(-1!=navigator.userAgent.indexOf("Mac")?"macOS":"PC"){case"macOS":return{cmdOrCtrl:"Cmd"};case"PC":return{cmdOrCtrl:"Ctrl"}}})()},97233:(e,t,n)=>{n.d(t,{B2:()=>i,Oj:()=>l,f4:()=>a,xt:()=>s});var r=n(64478),o=n(70646);const{LocalizationContext:s,useLocalization:i,useCurrentLanguage:a,Localized:l}=(0,r.o)(o.A,"en",[[/^zh-Hans/,"zh-Hans"],[/^zh-Hant/,"zh-Hant"],[/^zh$/,"zh-Hans"],[/^zh-TW$/,"zh-Hant"],[/^zh-HK$/,"zh-Hant"],[/^zh-MO$/,"zh-Hant"],[/^zh-CN$/,"zh-Hans"],[/^zh-SG$/,"zh-Hans"]])},16053:(e,t,n)=>{n.d(t,{g:()=>o,h:()=>r});const r=e=>Math.floor(e/8),o=["🎹","🔔","🎹","🎸","🎸","🎻","🧑‍🤝‍🧑","🎺","🎷","🍾","🕹️","🔮","⚡","🍛","🥁","🚁"]},6358:(e,t,n)=>{function r(e){return{deltaTime:e,type:"meta",subtype:"endOfTrack"}}function o(e,t){return{deltaTime:e,type:"meta",subtype:"trackName",text:t}}function s(e,t){return{deltaTime:e,type:"meta",subtype:"setTempo",microsecondsPerBeat:t}}function i(e){return{deltaTime:e,type:"meta",subtype:"timeSignature",numerator:arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,denominator:arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,metronome:arguments.length>3&&void 0!==arguments[3]?arguments[3]:24,thirtyseconds:arguments.length>4&&void 0!==arguments[4]?arguments[4]:8}}function a(e,t,n,r){return{deltaTime:e,type:"channel",subtype:"noteOn",channel:t,noteNumber:n,velocity:r}}function l(e,t,n){return{deltaTime:e,type:"channel",subtype:"noteOff",channel:t,noteNumber:n,velocity:arguments.length>3&&void 0!==arguments[3]?arguments[3]:0}}function c(e,t,n){return{deltaTime:e,type:"channel",subtype:"pitchBend",channel:t,value:n}}function d(e,t,n){return{deltaTime:e,type:"channel",subtype:"programChange",channel:t,value:n}}function u(e,t,n,r){return{deltaTime:e,type:"channel",subtype:"controller",channel:t,controllerType:n,value:r}}function h(e,t,n){return u(e,t,1,n)}function m(e,t,n){return u(e,t,7,n)}function g(e,t,n){return u(e,t,10,n)}function p(e,t,n){return u(e,t,11,n)}function x(e,t){return u(e,t,121,0)}function f(e,t,n,r,o,s){const i=[u(e,t,101,n),u(0,t,100,r)],a=[];return void 0!==o&&a.push(u(0,t,6,o)),void 0!==s&&a.push(u(0,t,38,s)),[...i,...a]}function v(e,t){return f(e,t,0,0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:2)}function y(e,t){const n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0)+8192,r=Math.floor(n/128);return f(e,t,0,1,r,n-128*r)}function j(e,t){return f(e,t,0,2,(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0)+64)}n.d(t,{BQ:()=>i,Ch:()=>d,E0:()=>m,Ey:()=>j,F8:()=>s,GF:()=>p,Q9:()=>u,WY:()=>v,d1:()=>a,dG:()=>l,fJ:()=>c,jq:()=>y,ly:()=>r,qL:()=>o,qZ:()=>x,t3:()=>g,ww:()=>h})},96684:(e,t,n)=>{n.d(t,{FI:()=>k,KO:()=>j,fp:()=>v});var r=n(17243),o=n(38750),s=n.n(o),i=n(10962),a=n(89193),l=n(20604),c=n(80406),d=n(54493),u=n(67200),h=n(35521),m=n(22095);const g=e=>{const t=new m.Ay,n=p(e);return void 0!==n&&(t.channel=n),t.addEvents((0,u.os)(e)),t},p=e=>{const t=e.find((e=>"channel"===e.type));if(void 0!==t&&"channel"in t)return t.channel},x=e=>void 0===p(e),f=e=>{switch(e.header.formatType){case 0:return(e=>{const t=(0,u.$z)(e),n=s()(t,(e=>"channel"in e?e.channel+1:0)),r=[];for(const e of Object.keys(n)){const t=n[e],o=parseInt(e);for(;r.length<=o;){const e=new m.Ay;e.channel=o>0?o-1:void 0,r.push(e)}const s=r[o],i=(0,u.TN)(t);s.addEvents(i)}return r})(e.tracks[0]);case 1:return(e=>{let[t,n]=(0,r.partition)(e,x);0===t.length&&t.push([]);const[o,...s]=[...t,...n].map(u.$z),i=s.map((e=>e.map((e=>(e=>"subtype"in e&&("timeSignature"===e.subtype||"setTempo"===e.subtype))(e)?(o.push(e),null):e)).filter(l.Pe)));return[o,...i].map(d.T)})(e.tracks).map(g);default:throw new Error(`Unsupported midi format ${e.header.formatType}`)}};function v(e){const t=new h.A,n=(0,i.LF)(e);if(f(n).forEach((e=>t.addTrack(e))),1===n.header.formatType&&t.tracks.length>0){const e=t.tracks[0].name;void 0!==e&&(t.name=e)}return t.timebase=n.header.ticksPerBeat,t}const y=e=>t=>"channel"===t.type?{...t,channel:e}:t;function j(e){const t=function(e){return(0,a.HO)(e.tracks).map((e=>{const t=[...(0,d.R)(e.events),{deltaTime:0,type:"meta",subtype:"endOfTrack"}];return void 0!==e.channel?t.map(y(e.channel)):t}))}(e);return(0,i.M9)(t,e.timebase)}function k(e){const t=j(e),n=new Blob([t],{type:"application/octet-stream"});(0,c.W)(n,e.filepath.length>0?e.filepath:"no name.mid")}},12320:(e,t,n)=>{n.d(t,{G:()=>d,Z:()=>c});var r=n(76646),o=n(71229),s=n(51046),i=n(6358),a=n(49214),l=n(62405);const c=99999;class d{constructor(e){this.songStore=e}get timebase(){return this.songStore.song.timebase}get endOfSong(){return this.songStore.song.endOfSong}getEvents(e,t){const{song:n}=this.songStore,a=o.Q.create(e,t),l=r.d.createInRange(n.measures,n.timebase,a).filter((0,s.F)(a)).flatMap((e=>function(e){const t=0===e.beat?100:70,n=0===e.beat?76:77;return[{...(0,i.d1)(0,9,n,t),tick:e.tick,trackId:c}]}(e)));return n.allEvents.filter((0,s.F)(a)).concat(l)}getCurrentStateEvents(e){return this.songStore.song.tracks.flatMap((t=>{const n=(0,a._g)(t.events,e);return(0,l.K)(n,t.channel,t.id)}))}}},62405:(e,t,n)=>{n.d(t,{K:()=>o,T:()=>s});var r=n(28011);const o=(e,t,n)=>e.filter((e=>!(!0===e.isRecording))).flatMap((e=>(0,r.C)(e))).map((e=>({...e,channel:t,trackId:n}))),s=e=>e.flatMap((e=>o(e.events,e.channel,e.id)))},65672:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(52188);class o{denominator;songStore;isEnabled=!0;constructor(e,t,n){this.songStore=e,this.denominator=t,this.isEnabled=n}get timebase(){return this.songStore.song.timebase}calc(e,t){if(!this.isEnabled)return Math.round(e);const n=r.t.getMeasureStart(this.songStore.song.measures,e,this.songStore.song.timebase),o=1===this.denominator?n.numerator??4:4,s=this.timebase*o/this.denominator,i=n?.tick??0;return t((e-i)/s)*s+i}round(e){return this.calc(e,Math.round)}ceil(e){return this.calc(e,Math.ceil)}floor(e){return this.calc(e,Math.floor)}get unit(){return 4*this.timebase/this.denominator}}},28091:(e,t,n)=>{n.d(t,{A:()=>r.A});var r=n(65672)},15738:(e,t,n)=>{n.d(t,{A:()=>r});const r=new class{data={};writeText(e){this.data.text=e}readText(){return this.data.text}clear(e){delete this.data[e]}write(e,t){this.data[t]=e}}},26666:(e,t,n)=>{n.d(t,{P:()=>s});var r=n(89193),o=n(12320);class s{outputs=[];isMetronomeEnabled=!1;constructor(e,t){this.trackMute=e,this.metronomeOutput=t,(0,r.Gn)(this,{isMetronomeEnabled:r.sH})}activate(){this.outputs.filter((e=>e.isEnabled)).forEach((e=>e.synth.activate()))}getOutputs(e){return e===o.Z?this.isMetronomeEnabled?[this.metronomeOutput]:[]:void 0===e||null===this.trackMute||this.trackMute.shouldPlayTrack(e)?this.outputs.filter((e=>e.isEnabled)).map((e=>e.synth)):[]}sendEvent(e,t,n,r){this.getOutputs(r).forEach((o=>o.sendEvent(e,t,n,r)))}}},83710:(e,t,n)=>{n.d(t,{X:()=>s});const r="files",o="catalog";class s{db=null;constructor(e,t){this.dbName=e,this.version=t}async init(){this.db=await this.openDatabase()}openDatabase(){return new Promise(((e,t)=>{const n=indexedDB.open(this.dbName,this.version);n.onsuccess=()=>e(n.result),n.onupgradeneeded=e=>{const t=n.result;t.objectStoreNames.contains(r)||t.createObjectStore(r,{autoIncrement:!0}),t.objectStoreNames.contains(o)||t.createObjectStore(o)},n.onerror=()=>t(n.error)}))}async getCatalog(){if(!this.db)throw new Error("Database not initialized");const e=this.db.transaction(o,"readonly").objectStore(o).get(0);return await i(e)??{files:{}}}async setCatalog(e){if(!this.db)throw new Error("Database not initialized");const t=this.db.transaction(o,"readwrite").objectStore(o).put(e,0);await i(t)}async updateCatalog(e){const t=e(await this.getCatalog());await this.setCatalog(t)}async save(e,t){return(await this.saveMany([{data:e,metadata:t}]))[0].id}async saveMany(e){if(!this.db)throw new Error("Database not initialized");const t=this.db.transaction(r,"readwrite").objectStore(r),n=[];for await(const r of e){const e=t.add(r.data),o=await i(e);n.push({id:o,metadata:r.metadata})}return await this.updateCatalog((e=>{for(const{id:t,metadata:r}of n)e.files[t]=r;return e})),n}async load(e){if(!this.db)throw new Error("Database not initialized");const t=this.db.transaction(r,"readonly").objectStore(r).get(e);return await i(t)??null}async delete(e){await this.deleteMany([e])}async deleteMany(e){if(!this.db)throw new Error("Database not initialized");const t=this.db.transaction(r,"readwrite").objectStore(r);for(const n of e)t.delete(n);await this.updateCatalog((t=>{for(const n of e)delete t.files[n];return t}))}async list(){return(await this.getCatalog()).files}}function i(e){return new Promise(((t,n)=>{e.onsuccess=()=>t(e.result),e.onerror=()=>n(e.error)}))}},2463:(e,t,n)=>{n.d(t,{E:()=>s,g:()=>o});var r=n(10962);class o{devices=[];onMessage;removeAllDevices=()=>{this.devices.forEach(this.removeDevice)};removeDevice=e=>{e.removeEventListener("midimessage",this.onMidiMessage),this.devices=this.devices.filter((t=>t.id!==e.id))};addDevice=e=>{e.addEventListener("midimessage",this.onMidiMessage),this.devices.push(e)};onMidiMessage=e=>{this.onMessage?.(e)}}const s=e=>t=>{const{pianoRollStore:n,pianoRollStore:{selectedTrack:o},player:s}=e;if(void 0===o)return;const{channel:i}=o;if(void 0===i)return;const a=new r.Z6(t.data),l=(0,r.ac)(a);"channel"===l.type&&(l.channel=i,s.sendEvent(l),"noteOn"===l.subtype?n.previewingNoteNumbers.add(l.noteNumber):"noteOff"===l.subtype&&n.previewingNoteNumbers.delete(l.noteNumber))}},45322:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(10962);class o{midiOutput;constructor(e){this.midiOutput=e}activate(){this.midiOutput.open()}sendEvent(e,t,n){const o=(0,r.lK)({...e,deltaTime:0},!1),s=1e3*t+n;if("connected"===this.midiOutput.state)try{this.midiOutput.send(o,s)}catch(e){console.warn(e)}}}},79565:(e,t,n)=>{n.d(t,{o:()=>s});var r=n(10962),o=n(89193);class s{recordedNotes=[];player;rootStore;isRecording=!1;constructor(e,t){this.player=e,this.rootStore=t,(0,o.Gn)(this,{isRecording:o.sH}),(0,o.lB)(e,"position",(e=>{if(!this.isRecording)return;const n=t.pianoRollStore.selectedTrack;if(void 0===n)return;const r=e.object.get();this.recordedNotes.forEach((e=>{n.updateEvent(e.id,{duration:Math.max(0,r-e.tick)})}))})),(0,o.lB)(this,"isRecording",(e=>{this.recordedNotes=[],e.newValue||this.rootStore.song.tracks.forEach((e=>{const t=e.events.filter((e=>!0===e.isRecording)).map((e=>({...e,isRecording:!1})));e.updateEvents(t)}))}))}onMessage(e){if(!this.isRecording)return;const t=this.rootStore.pianoRollStore.selectedTrack;if(void 0===t)return;const n=new r.Z6(e.data),o=(0,r.ac)(n);if("channel"!==o.type)return;const s=this.player.position;switch(o.subtype){case"noteOn":{const e=t.addEvent({type:"channel",subtype:"note",noteNumber:o.noteNumber,tick:s,velocity:o.velocity,duration:0,isRecording:!0});this.recordedNotes.push(e);break}case"noteOff":this.recordedNotes.filter((e=>e.noteNumber===o.noteNumber)).forEach((e=>{t.updateEvent(e.id,{duration:Math.max(0,s-e.tick)})})),this.recordedNotes=this.recordedNotes.filter((e=>e.noteNumber!==o.noteNumber));break;default:t.addEvent({...o,tick:s,isRecording:!0})}}}},94398:(e,t,n)=>{async function r(e,t){const n=await e.createWritable();await n.write(t),await n.close()}n.d(t,{_:()=>r})},69340:(e,t,n)=>{n.d(t,{A:()=>d});var r=n(89193),o=n(39013),s=n(52188),i=n(2265),a=n(20604),l=n(62405),c=n(22095);class d{tracks=[];filepath="";timebase=480;name="";fileHandle=null;cloudSongId=null;cloudSongDataId=null;isSaved=!0;lastTrackId=0;constructor(){(0,r.Gn)(this,{addTrack:r.XI,removeTrack:r.XI,insertTrack:r.XI,conductorTrack:r.EW,measures:r.EW,timeSignatures:r.EW,endOfSong:r.EW,allEvents:(0,r.EW)({keepAlive:!0}),tracks:r.sH.shallow,filepath:r.sH,timebase:r.sH,name:r.sH,isSaved:r.sH}),(0,r.mJ)((()=>[this.tracks.map((e=>({channel:e.channel,events:e.events}))),this.name]),(()=>this.isSaved=!1))}generateTrackId(){return this.lastTrackId++}insertTrack(e,t){void 0===e.channel&&this.tracks.length>0&&(e.channel=e.channel||this.tracks.length-1),e.id=this.generateTrackId(),this.tracks.splice(t,0,e)}addTrack(e){this.insertTrack(e,this.tracks.length)}removeTrack(e){this.tracks=this.tracks.filter((t=>t.id!==e))}moveTrack(e,t){const[n]=this.tracks.splice(e,1);this.tracks.splice(t,0,n)}get conductorTrack(){return this.tracks.find((e=>e.isConductorTrack))}getTrack(e){return this.tracks.find((t=>t.id===e))}get measures(){const{timeSignatures:e,timebase:t}=this;return s.t.fromTimeSignatures(e,t)}get timeSignatures(){const{conductorTrack:e}=this;return void 0===e?[]:e.events.filter(c.y5).slice().sort(((e,t)=>e.tick-t.tick))}get endOfSong(){return(Math.max(...this.tracks.map((e=>e.endOfTrack)).filter(a.EA))??0)+14400}get allEvents(){return(0,l.T)(this.tracks)}transposeNotes(e,t){for(const n in t){const r=parseInt(n),o=t[r],s=this.tracks[r];void 0!==s&&s.updateEvents(o.map((t=>{const n=s.getEventById(t);return null!=n&&(0,c.Fb)(n)?{id:t,noteNumber:i.i.clamp(n.noteNumber+e)}:null})).filter(a.Pe))}}}(0,o.PL)(d,{tracks:(0,o.p_)((0,o.Ik)(c.Ay)),filepath:(0,o.MY)(),timebase:(0,o.MY)(),lastTrackId:(0,o.MY)()})},57108:(e,t,n)=>{n.d(t,{p:()=>s});var r=n(22095),o=n(69340);function s(){const e=new o.A;return e.addTrack((0,r.bL)()),e.addTrack((0,r.BQ)(0)),e.isSaved=!0,e}},35521:(e,t,n)=>{n.d(t,{A:()=>r.A,p:()=>o.p});var r=n(69340),o=n(57108)},67498:(e,t,n)=>{n.d(t,{A:()=>p});var r=n(17243),o=n(89193),s=n(92770),i=n(20038),a=n(71229),l=n(20883),c=n(48077),d=n(51046),u=n(28091),h=n(22095),m=n(16541),g=n(11631);class p{rulerStore;tickScrollStore;scaleX=1;scaleY=1;SCALE_Y_MIN=.5;SCALE_Y_MAX=4;selection=null;selectedEventIds={};autoScroll=!0;quantize=1;scrollLeftTicks=0;scrollTop=0;canvasWidth=0;canvasHeight=0;selectedTrackIndex=0;openTransposeDialog=!1;openVelocityDialog=!1;constructor(e){this.rootStore=e,this.rootStore=e,this.rulerStore=new m.A(this,e.songStore),this.tickScrollStore=new g.M(this,.15,15),(0,o.Gn)(this,{scaleX:o.sH,scaleY:o.sH,selection:o.sH.shallow,selectedEventIds:o.sH,autoScroll:o.sH,quantize:o.sH,scrollLeftTicks:o.sH,scrollTop:o.sH,canvasWidth:o.sH,canvasHeight:o.sH,selectedTrackIndex:o.sH,openTransposeDialog:o.sH,openVelocityDialog:o.sH,scrollLeft:o.EW,transform:o.EW,trackTransform:o.EW,notes:o.EW,cursorX:o.EW,trackHeight:o.EW,selectionRect:o.EW,contentWidth:o.EW,contentHeight:o.EW,quantizer:o.EW,selectedTrackId:o.EW,setScrollLeftInPixels:o.XI,setScrollTop:o.XI})}setUpAutorun(){this.tickScrollStore.setUpAutoScroll()}serialize(){return{selection:(0,r.cloneDeep)(this.selection),selectedEventIds:(0,r.cloneDeep)(this.selectedEventIds)}}restore(e){this.selection=e.selection,this.selectedEventIds=e.selectedEventIds}get scrollLeft(){return this.tickScrollStore.scrollLeft}setScrollLeftInPixels(e){this.tickScrollStore.setScrollLeftInPixels(e)}setScrollTop(e){const t=this.contentHeight+s.PE.rulerHeight+i.ZW-this.canvasHeight;this.scrollTop=(0,r.clamp)(e,0,t)}scrollBy(e,t){this.setScrollLeftInPixels(this.scrollLeft-e),this.setScrollTop(this.scrollTop-t)}scaleAroundPointX(e,t){this.tickScrollStore.scaleAroundPointX(e,t)}setScaleY(e){this.scaleY=(0,r.clamp)(e,this.SCALE_Y_MIN,this.SCALE_Y_MAX),this.setScrollTop(this.scrollTop)}resetSelection(){this.selection=null,this.selectedEventIds={}}get contentWidth(){return this.tickScrollStore.contentWidth}get contentHeight(){return this.trackTransform.getY(this.rootStore.song.tracks.length)}get transform(){return new c.a(s.PE.pixelsPerTick*this.scaleX,.5*this.scaleY,127)}get trackTransform(){const{transform:e,trackHeight:t}=this;return new l.w(e,t)}get trackHeight(){const{transform:e}=this;return Math.ceil(e.pixelsPerKey*e.numberOfKeys)+1}get notes(){const{transform:e,trackTransform:t,scrollLeft:n,canvasWidth:r,scaleY:o}=this;return this.rootStore.song.tracks.map(((s,i)=>s.events.filter((0,d.L)(a.Q.fromLength(e.getTick(n),e.getTick(r)))).filter(h.Fb).map((n=>{const r=e.getRect(n);return{...r,height:o,y:t.getY(i)+r.y}})))).flat()}get cursorX(){return this.transform.getX(this.rootStore.player.position)}get selectionRect(){const{selection:e,trackTransform:t}=this;if(null===e)return null;const n=t.getX(e.fromTick),r=t.getX(e.toTick),o=t.getY(e.fromTrackIndex);return{x:n,width:r-n,y:o,height:t.getY(e.toTrackIndex)-o}}get quantizer(){return new u.A(this.rootStore,this.quantize,!0)}get selectedTrackId(){return this.rootStore.song.tracks[this.selectedTrackIndex].id}}},32025:(e,t,n)=>{n.d(t,{a:()=>s});var r=n(89193),o=n(92234);class s{authUser=null;user=null;constructor(e){this.userRepository=e,(0,r.Gn)(this,{authUser:r.sH,user:r.sH});let t=null;try{e.observeAuthUser((async n=>{this.authUser=n,(0,o.r)()&&window.electronAPI.authStateChanged(null!==n),t?.(),null!==n&&(t=e.observeCurrentUser((e=>{this.user=e})),await this.createProfileIfNeeded(n))}))}catch(e){console.warn(e)}}async createProfileIfNeeded(e){if(null===await this.userRepository.getCurrentUser()){const t={name:e.displayName??"",bio:""};await this.userRepository.create(t)}}get isLoggedIn(){return null!==this.authUser}}},1296:(e,t,n)=>{n.d(t,{L:()=>s});var r=n(17243),o=n(89193);class s{isLoading=!1;selectedColumn="date";dateType="created";sortAscending=!1;_files=[];constructor(e,t,n){this.songStore=e,this.cloudSongRepository=t,this.cloudSongDataRepository=n,(0,o.Gn)(this,{isLoading:o.sH,selectedColumn:o.sH,dateType:o.sH,sortAscending:o.sH,_files:o.sH,files:o.EW})}async load(){this.isLoading=!0,this._files=await this.cloudSongRepository.getMySongs(),this.isLoading=!1}get files(){return(0,r.orderBy)(this._files,(e=>{switch(this.selectedColumn){case"name":return e.name;case"date":switch(this.dateType){case"created":return e.createdAt.getTime();case"updated":return e.updatedAt.getTime()}}}),this.sortAscending?"asc":"desc")}async deleteSong(e){await this.cloudSongDataRepository.delete(e.songDataId),await this.cloudSongRepository.delete(e.id),this.songStore.song.cloudSongId===e.id&&(this.songStore.song.cloudSongId=null,this.songStore.song.cloudSongDataId=null),await this.load()}}},60790:(e,t,n)=>{n.d(t,{$e:()=>h,Tk:()=>d,jL:()=>u,qw:()=>c});var r=n(17243),o=n(10962),s=n(89193),i=n(78193),a=n(29909),l=n(22095);const c=e=>{switch(e.type){case"velocity":return"velocity";case"pitchBend":return"pitchBend";case"controller":return`controller-${e.controllerType}`}},d=(e,t)=>{switch(e.type){case"velocity":case"pitchBend":return e.type===t.type;case"controller":switch(t.type){case"velocity":case"pitchBend":return!1;case"controller":return a.a.equals(e,t)}}},u=[{type:"velocity"},{type:"pitchBend"},{type:"controller",controllerType:o.M$.MSB_MAIN_VOLUME},{type:"controller",controllerType:o.M$.MSB_PAN},{type:"controller",controllerType:o.M$.MSB_EXPRESSION},{type:"controller",controllerType:o.M$.SUSTAIN},{type:"controller",controllerType:o.M$.MSB_MODWHEEL}];class h{controlMode={type:"velocity"};selection=null;selectedEventIds=[];controlModes=(()=>u)();constructor(e){this.pianoRollStore=e,(0,s.Gn)(this,{controlMode:s.sH,selection:s.sH,selectedEventIds:s.sH,controlModes:s.sH,scrollLeft:s.EW,cursorX:s.EW,transform:s.EW,rulerStore:s.EW,selectedTrack:s.EW,quantizer:s.EW,mouseMode:s.EW,cursor:s.EW}),(0,i.pu)(this,{name:"ControlStore",properties:["controlModes"],storage:window.localStorage})}serialize(){return{controlModes:(0,r.cloneDeep)(this.controlModes)}}restore(e){this.controlModes=e.controlModes}get controlValueEvents(){const{controlMode:e}=this;switch(e.type){case"velocity":throw new Error("don't use this method for velocity");case"pitchBend":return this.pianoRollStore.filteredEvents(l.Y6);case"controller":return this.pianoRollStore.filteredEvents((0,l.HG)(e.controllerType))}}get scrollLeft(){return this.pianoRollStore.scrollLeft}get cursorX(){return this.pianoRollStore.cursorX}get transform(){return this.pianoRollStore.transform}get rulerStore(){return this.pianoRollStore.rulerStore}get selectedTrack(){return this.pianoRollStore.selectedTrack}get quantizer(){return this.pianoRollStore.quantizer}get mouseMode(){return this.pianoRollStore.mouseMode}get cursor(){return this.pianoRollStore.controlCursor}}},93501:(e,t,n)=>{n.d(t,{u:()=>o});var r=n(89193);class o{openExportDialog=!1;exportMode="WAV";openExportProgressDialog=!1;progress=0;isCanceled=!1;constructor(){(0,r.Gn)(this,{openExportDialog:r.sH,openExportProgressDialog:r.sH,progress:r.sH,exportMode:r.sH})}}},62217:(e,t,n)=>{n.d(t,{A:()=>r});class r{undoHistory=[];redoHistory=[];constructor(e){this.serializable=e}push(){const e=this.serializable.serialize();this.undoHistory.push(e),this.redoHistory=[]}undo(){const e=this.serializable.serialize(),t=this.undoHistory.pop();t&&(this.redoHistory.push(e),this.serializable.restore(t))}redo(){const e=this.serializable.serialize(),t=this.redoHistory.pop();t&&(this.undoHistory.push(e),this.serializable.restore(t))}clear(){this.undoHistory=[],this.redoHistory=[]}}},92198:(e,t,n)=>{n.d(t,{$:()=>s});var r=n(89193),o=n(78193);class s{inputs=[];outputs=[];requestError=null;isLoading=!1;enabledOutputs={};enabledInputs={};isFactorySoundEnabled=!0;constructor(){(0,r.Gn)(this,{inputs:r.sH,outputs:r.sH,requestError:r.sH,isLoading:r.sH,enabledOutputs:r.sH,enabledInputs:r.sH,isFactorySoundEnabled:r.sH,setInputEnable:r.XI,setOutputEnable:r.XI}),(0,o.pu)(this,{name:"MIDIDeviceStore",properties:["isFactorySoundEnabled","enabledOutputs","enabledInputs"],storage:window.localStorage}),this.requestMIDIAccess()}async requestMIDIAccess(){if(this.isLoading=!0,this.inputs=[],this.outputs=[],void 0===navigator.requestMIDIAccess)return this.isLoading=!1,void(this.requestError=new Error("Web MIDI API is not supported by your browser"));try{const e=await navigator.requestMIDIAccess({sysex:!0});this.updatePorts(e),e.onstatechange=()=>{this.updatePorts(e)}}catch(e){this.requestError=e}finally{this.isLoading=!1}}updatePorts(e){this.inputs=Array.from(e.inputs.values()),this.outputs=Array.from(e.outputs.values())}setInputEnable(e,t){this.enabledInputs={...this.enabledInputs,[e]:t}}setOutputEnable(e,t){this.enabledOutputs={...this.enabledOutputs,[e]:t}}}},34755:(e,t,n)=>{n.d(t,{A:()=>v});var r=n(17243),o=n(89193),s=n(92770),i=n(71229),a=n(70480),l=n(52188),c=n(40540),d=n(48077),u=n(3354),h=n(20604),m=n(51046),g=n(28091),p=n(22095),x=n(16541),f=n(11631);class v{rulerStore;tickScrollStore;scrollLeftTicks=0;scrollTopKeys=70;SCALE_Y_MIN=.5;SCALE_Y_MAX=4;notesCursor="auto";mouseMode="pencil";scaleX=1;scaleY=1;autoScroll=!0;quantize=8;isQuantizeEnabled=!0;selectedTrackId=(()=>p.ql)();selection=null;selectedNoteIds=[];lastNoteDuration=null;openInstrumentBrowser=!1;instrumentBrowserSetting={isRhythmTrack:!1,programNumber:0};notGhostTrackIds=(()=>new Set)();canvasWidth=0;canvasHeight=0;showTrackList=!1;showEventList=!1;openTransposeDialog=!1;openVelocityDialog=!1;newNoteVelocity=100;keySignature=null;previewingNoteNumbers=(()=>new Set)();constructor(e){this.rootStore=e,this.rulerStore=new x.A(this,e.songStore),this.tickScrollStore=new f.M(this,.15,15),(0,o.Gn)(this,{scrollLeftTicks:o.sH,scrollTopKeys:o.sH,notesCursor:o.sH,mouseMode:o.sH,scaleX:o.sH,scaleY:o.sH,autoScroll:o.sH,quantize:o.sH,isQuantizeEnabled:o.sH,selectedTrackId:o.sH,selection:o.sH.shallow,selectedNoteIds:o.sH,lastNoteDuration:o.sH,openInstrumentBrowser:o.sH,instrumentBrowserSetting:o.sH,notGhostTrackIds:o.sH,canvasWidth:o.sH,canvasHeight:o.sH,showTrackList:o.sH,showEventList:o.sH,openTransposeDialog:o.sH,openVelocityDialog:o.sH,newNoteVelocity:o.sH,keySignature:o.sH,previewingNoteNumbers:o.sH,contentWidth:o.EW,contentHeight:o.EW,scrollLeft:o.EW,scrollTop:o.EW,transform:o.EW,windowedEvents:o.EW,allNotes:o.EW,notes:o.EW,selectedTrackIndex:o.EW,ghostTrackIds:o.EW,selectionBounds:o.EW,currentVolume:o.EW,currentPan:o.EW,currentTempo:o.EW,currentMBTTime:o.EW,cursorX:o.EW,quantizer:o.EW,controlCursor:o.EW,selectedTrack:o.EW,setScrollLeftInPixels:o.XI,setScrollTopInPixels:o.XI,setScrollLeftInTicks:o.XI,scaleAroundPointX:o.XI,scaleAroundPointY:o.XI,scrollBy:o.XI,toggleTool:o.XI})}setUpAutorun(){this.tickScrollStore.setUpAutoScroll(),(0,o.mJ)((()=>({selectedTrackId:this.selectedTrackId,mouseMode:this.mouseMode})),(()=>{this.resetSelection()}))}serialize(){return{selection:this.selection?{...this.selection}:null,selectedNoteIds:(0,r.cloneDeep)(this.selectedNoteIds),selectedTrackId:this.selectedTrackId}}restore(e){this.selection=e.selection,this.selectedNoteIds=e.selectedNoteIds,this.selectedTrackId=e.selectedTrackId}get contentWidth(){return this.tickScrollStore.contentWidth}get contentHeight(){const{transform:e}=this;return e.getMaxY()}get scrollLeft(){return this.tickScrollStore.scrollLeft}get scrollTop(){return Math.round(this.transform.getY(this.scrollTopKeys))}setScrollLeftInPixels(e){this.tickScrollStore.setScrollLeftInPixels(e)}setScrollTopInPixels(e){const{transform:t,canvasHeight:n}=this,o=t.getMaxY()-n,s=(0,r.clamp)(e,0,o);this.scrollTopKeys=this.transform.getNoteNumberFractional(s)}setScrollLeftInTicks(e){this.tickScrollStore.setScrollLeftInTicks(e)}setScrollTopInKeys(e){this.setScrollTopInPixels(this.transform.getY(e))}scrollBy(e,t){this.setScrollLeftInPixels(this.scrollLeft-e),this.setScrollTopInPixels(this.scrollTop-t)}scaleAroundPointX(e,t){this.tickScrollStore.scaleAroundPointX(e,t)}scaleAroundPointY(e,t){const n=this.transform.getNoteNumberFractional(this.scrollTop+t);this.scaleY=(0,r.clamp)(this.scaleY*(1+e),this.SCALE_Y_MIN,this.SCALE_Y_MAX);const o=this.transform.getNoteNumberFractional(this.scrollTop+t)-n;this.setScrollTopInKeys(this.scrollTopKeys-o)}toggleTool(){this.mouseMode}resetSelection(){this.selection=null,this.selectedNoteIds=[]}get selectedTrackIndex(){return this.rootStore.song.tracks.findIndex((e=>e.id===this.selectedTrackId))}set selectedTrackIndex(e){this.selectedTrackId=this.rootStore.song.tracks[e]?.id}get selectedTrack(){return this.rootStore.song.getTrack(this.selectedTrackId)}get transform(){return new d.a(s.PE.pixelsPerTick*this.scaleX,s.PE.keyHeight*this.scaleY,127)}get windowedEvents(){const{transform:e,scrollLeft:t,canvasWidth:n,selectedTrack:r}=this;return void 0===r?[]:r.events.filter((0,m.L)(i.Q.fromLength(e.getTick(t),e.getTick(n))))}get allNotes(){const{transform:e,selectedTrack:t,selectedNoteIds:n}=this;return void 0===t?[]:t.events.filter(p.Fb).map((r=>{const o=t.isRhythmTrack?e.getDrumRect(r):e.getRect(r),s=n.includes(r.id);return{...o,id:r.id,velocity:r.velocity,isSelected:s}}))}get notes(){const{scrollLeft:e,canvasWidth:t,selectedTrack:n,allNotes:r}=this;if(void 0===n)return[];const o=i.Q.fromLength(e,t);return r.filter((e=>i.Q.intersects(i.Q.fromLength(e.x,e.width),o)))}get ghostTrackIds(){const e=this.rootStore.song,{notGhostTrackIds:t,selectedTrackId:n}=this;return e.tracks.filter((e=>e.id!==n&&!t.has(e.id))).map((e=>e.id))}getNotes(e){return this.notes.filter((t=>a.r.containsPoint(t,e)))}getLocal(e){return{x:e.offsetX+this.scrollLeft,y:e.offsetY+this.scrollTop}}get selectionBounds(){return null!==this.selection?c.L.getBounds(this.selection,this.transform):null}filteredEvents(e){const{windowedEvents:t,scrollLeft:n,canvasWidth:o,transform:s,selectedTrack:i}=this,a=(i?.events??[]).filter(e),l=t.filter(e),c=s.getTick(n),d=s.getTick(n+o);return[(0,r.maxBy)(a.filter((e=>e.tick<c)),(e=>e.tick)),...l,(0,r.minBy)(a.filter((e=>e.tick>d)),(e=>e.tick))].filter(h.EA)}get currentVolume(){return this.selectedTrack?.getVolume(this.rootStore.player.position)}get currentPan(){return this.selectedTrack?.getPan(this.rootStore.player.position)}get currentTempo(){return this.rootStore.song.conductorTrack?.getTempo(this.rootStore.player.position)}get currentMBTTime(){return l.t.getMBTString(this.rootStore.song.measures,this.rootStore.player.position,this.rootStore.song.timebase)}get cursorX(){return this.transform.getX(this.rootStore.player.position)}get quantizer(){return new g.A(this.rootStore,this.quantize,this.isQuantizeEnabled)}get enabledQuantizer(){return new g.A(this.rootStore,this.quantize,!0)}get controlCursor(){return"pencil"===this.mouseMode?'url("./cursor-pencil.svg") 0 20, pointer':"auto"}getDraggablePosition(e){switch(e.type){case"note":const{selectedTrack:t}=this;if(void 0===t)return null;const n=t.getEventById(e.noteId);if(void 0===n||!(0,p.Fb)(n))return null;switch(e.position){case"center":case"left":return n;case"right":return{tick:n.tick+n.duration,noteNumber:n.noteNumber}}case"selection":const{selection:r}=this;if(null===r)return null;switch(e.position){case"center":case"left":return c.L.getFrom(r);case"right":return c.L.getTo(r)}}}updateDraggable(e,t){switch(e.type){case"note":const{selectedTrack:n}=this;if(void 0===n)return;const r=n.getEventById(e.noteId);if(void 0===r||!(0,p.Fb)(r))return;switch(e.position){case"center":n.updateEvent(r.id,t);break;case"left":if(void 0===t.tick)return;n.updateEvent(r.id,{tick:t.tick,duration:r.duration+r.tick-t.tick});break;case"right":if(void 0===t.tick)return;n.updateEvent(r.id,{duration:t.tick-r.tick})}break;case"selection":const{selection:o}=this;if(null===o)return;switch(e.position){case"center":{const e=c.L.getFrom(o),n={...e,...t},r=u.T.sub(n,e);this.selection=c.L.moved(o,r.tick,r.noteNumber);break}case"left":if(void 0===t.tick)return;this.selection={...o,fromTick:t.tick};break;case"right":if(void 0===t.tick)return;this.selection={...o,toTick:t.tick}}}}getDraggableArea(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{selectedTrack:n}=this;if(void 0===n)return null;switch(e.type){case"note":{const o=n.getEventById(e.noteId);if(void 0===o||!(0,p.Fb)(o))return null;const a=this.selectedNoteIds.map((e=>n.getEventById(e))).filter(h.EA).filter(p.Fb),l=(0,r.min)(a.map((e=>e.tick)))??0,c=o.tick-l;switch(e.position){case"center":{const e=(0,r.max)(a.map((e=>e.noteNumber)))??0,t=(0,r.min)(a.map((e=>e.noteNumber)))??0,n=o.noteNumber-t,l=s.a2-(e-o.noteNumber);return{tickRange:i.Q.create(c,1/0),noteNumberRange:i.Q.create(n,l)}}case"left":return{tickRange:i.Q.create(c,o.tick+o.duration-t),noteNumberRange:i.Q.point(o.noteNumber)};case"right":return{tickRange:i.Q.create(o.tick+t,1/0),noteNumberRange:i.Q.point(o.noteNumber)}}}case"selection":{const{selection:o}=this;if(null===o)return null;const a=this.selectedNoteIds.map((e=>n.getEventById(e))).filter(h.EA).filter(p.Fb),l=(0,r.min)(a.map((e=>e.tick)))??0,c=o.fromTick-l;switch(e.position){case"center":const e=o.fromNoteNumber-o.toNoteNumber;return{tickRange:i.Q.create(c,1/0),noteNumberRange:i.Q.create(e-1,s.a2+1)};case"left":{const e=(0,r.max)(a.map((e=>e.duration)))??0,n=o.toTick-t,s=o.fromTick+(e-t);return{tickRange:i.Q.create(c,Math.min(n,s)),noteNumberRange:i.Q.point(o.fromNoteNumber)}}case"right":{const e=(0,r.max)(a.map((e=>e.duration)))??0,n=o.fromTick+t,s=o.toTick-(e-t);return{tickRange:i.Q.create(Math.max(n,s),1/0),noteNumberRange:i.Q.point(o.fromNoteNumber)}}}}}}}},9111:(e,t,n)=>{n.d(t,{A:()=>O});var r=n(69825),o=n(1902),s=n(89193),i=n(39013),a=n(52932),l=n(92234),c=n(12320),d=n(26666),u=n(2463),h=n(79565),m=n(35521),g=n(22095),p=n(74124),x=n(67498),f=n(32025),v=n(1296),y=n(60790),j=n(93501),k=n(62217),b=n(92198),w=n(34755),S=n(61426),C=n(45936),T=n(97829),A=n(98597),E=n(45331),I=n(53603),M=n(55610);class O{song=(()=>(0,m.p)())();cloudSongRepository=(()=>(0,r.XW)(a.kA,a.j2))();cloudSongDataRepository=(()=>(0,r.TA)(a.kA,a.j2))();cloudMidiRepository=(()=>(0,r.n2)(a.kA,a.Cn))();userRepository=(()=>(0,r._x)(a.kA,a.j2))();router=(()=>new T.A)();trackMute=(()=>new p.A)();historyStore=(()=>new k.A(this))();rootViewStore=(()=>new C.A)();pianoRollStore;controlStore;arrangeViewStore=(()=>new x.A(this))();tempoEditorStore=(()=>new I.A(this))();midiDeviceStore=(()=>new b.$)();exportStore=(()=>new j.u)();authStore=(()=>new f.a(this.userRepository))();cloudFileStore=(()=>new v.L(this,this.cloudSongRepository,this.cloudSongDataRepository))();settingStore=(()=>new A.A)();player;synth;metronomeSynth;synthGroup;midiInput=(()=>new u.g)();midiRecorder;soundFontStore;themeStore=(()=>new M.Z)();constructor(){(0,s.Gn)(this,{song:s.sH.ref});const e=new(window.AudioContext||window.webkitAudioContext);this.synth=new o.Fu(e),this.metronomeSynth=new o.Fu(e),this.synthGroup=new d.P(this.trackMute,this.metronomeSynth),this.synthGroup.outputs.push({synth:this.synth,isEnabled:!0});const t=new c.G(this);this.player=new o.ai(this.synthGroup,t),this.midiRecorder=new h.o(this.player,this),this.pianoRollStore=new w.A(this),this.controlStore=new y.$e(this.pianoRollStore),this.soundFontStore=new E.M(this.synth);const n=(0,u.E)(this);this.midiInput.onMidiMessage=e=>{n(e),this.midiRecorder.onMessage(e)},this.pianoRollStore.setUpAutorun(),this.arrangeViewStore.setUpAutorun(),this.tempoEditorStore.setUpAutorun(),(0,S._)(this)}serialize(){return{song:(0,i.lK)(this.song),pianoRollStore:this.pianoRollStore.serialize(),controlStore:this.controlStore.serialize(),arrangeViewStore:this.arrangeViewStore.serialize()}}restore(e){const t=(0,i.iu)(m.A,e.song);this.song=t,this.pianoRollStore.restore(e.pianoRollStore),this.controlStore.restore(e.controlStore),this.arrangeViewStore.restore(e.arrangeViewStore)}async init(){this.pianoRollStore.selectedTrackId=this.song.tracks.find((e=>!e.isConductorTrack))?.id??g.ql,await this.synth.setup(),await this.soundFontStore.init(),this.setupMetronomeSynth()}async setupMetronomeSynth(){const e=await async function(){if((0,l.r)())return await window.electronAPI.readFile("./assets/soundfonts/A320U_drums.sf2");const e=await fetch("https://cdn.jsdelivr.net/gh/ryohey/signal@6959f35/public/A320U_drums.sf2");return await e.arrayBuffer()}();await this.metronomeSynth.loadSoundFont(e)}get pushHistory(){return()=>this.historyStore.push()}get songStore(){return this}}},45936:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(89193);class o{isArrangeViewSelected=!1;openDrawer=!1;openHelp=!1;eventEditorEvents=[];openSignInDialog=!1;openCloudFileDialog=!1;openSettingDialog=!1;openControlSettingDialog=!1;initializeError=null;openInitializeErrorDialog=!1;openPublishDialog=!1;openUserSettingsDialog=!1;openDeleteAccountDialog=!1;constructor(){(0,r.Gn)(this,{isArrangeViewSelected:r.sH,openDrawer:r.sH,openHelp:r.sH,eventEditorEvents:r.sH.shallow,openSignInDialog:r.sH,openCloudFileDialog:r.sH,openSettingDialog:r.sH,openControlSettingDialog:r.sH,initializeError:r.sH,openInitializeErrorDialog:r.sH,openPublishDialog:r.sH,openUserSettingsDialog:r.sH,openDeleteAccountDialog:r.sH})}}},97829:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(89193);class o{path="/track";constructor(){(0,r.Gn)(this,{path:r.sH})}pushArrange(){this.path="/arrange"}pushTrack(){this.path="/track"}}},16541:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(89193),o=n(8660),s=n(71229),i=n(51046);class a{selectedTimeSignatureEventIds=[];constructor(e,t){this.parent=e,this.songStore=t,(0,r.Gn)(this,{selectedTimeSignatureEventIds:r.sH.shallow,beats:r.EW,timeSignatures:r.EW,quantizer:r.EW})}get beats(){const{scrollLeft:e,transform:t,canvasWidth:n}=this.parent,{song:{measures:r,timebase:s}}=this.songStore;return o.B.createInRange(r,t,s,e,n)}get timeSignatures(){const{transform:e,scrollLeft:t,canvasWidth:n}=this.parent,{selectedTimeSignatureEventIds:r}=this,{song:{timeSignatures:o}}=this.songStore;return o.filter((0,i.F)(s.Q.fromLength(e.getTick(t),e.getTick(n)))).map((e=>({...e,isSelected:r.includes(e.id)})))}get quantizer(){return this.parent.quantizer}getTick(e){const{transform:t,scrollLeft:n}=this.parent;return t.getTick(e+n)}getQuantizedTick(e){const{quantizer:t}=this.parent;return t.round(this.getTick(e))}}},98597:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(89193),o=n(78193);class s{language=null;constructor(){(0,r.Gn)(this,{language:r.sH}),(0,o.pu)(this,{name:"SettingStore",properties:["language"],storage:window.localStorage})}}},45331:(e,t,n)=>{n.d(t,{M:()=>c});var r=n(89193),o=n(78193),s=n(92390),i=n(92234),a=n(83710);const l=(0,i.r)()?[{id:-999,type:"file",path:"./assets/soundfonts/A320U.sf2",name:"A320U.sf2 (Signal Factory Sound)"}]:[{id:-999,type:"remote",name:"A320U.sf2 (Signal Factory Sound)",url:"https://cdn.jsdelivr.net/gh/ryohey/signal@4569a31/public/A320U.sf2"}];class c{storage;files=[];selectedSoundFontId=null;scanPaths=[];isLoading=!1;constructor(e){this.synth=e,(0,r.Gn)(this,{files:r.sH,selectedSoundFontId:r.sH,scanPaths:r.sH,isLoading:r.sH}),this.storage=new a.X("soundfonts",1)}async init(){await(0,o.pu)(this,{name:"SoundFontStore",properties:["selectedSoundFontId","scanPaths"],storage:window.localStorage}),await this.storage.init(),await this.updateFileList(),await this.load(this.selectedSoundFontId??l[0].id)}async updateFileList(){const e=await this.storage.list(),t=Object.keys(e).map((t=>({...e[Number(t)],id:Number(t)})));this.files=[...l,...t]}async getSoundFont(e){const t=l.find((t=>t.id===e));return void 0!==t?t:await this.storage.load(e)}async load(e){const t=await this.getSoundFont(e);if(null===t)throw new Error("SoundFont not found");switch(this.isLoading=!0,t.type){case"local":await this.synth.loadSoundFont(t.data);break;case"remote":await this.synth.loadSoundFontFromURL(t.url);break;case"file":const e=await window.electronAPI.readFile(t.path);await this.synth.loadSoundFont(e)}this.selectedSoundFontId=e,this.isLoading=!1}async addSoundFont(e,t){await this.storage.save(e,t),await this.updateFileList()}async removeSoundFont(e){await this.storage.delete(e),await this.updateFileList()}async scanSoundFonts(){if(!(0,i.r)())return;await this.clearScannedSoundFonts();const e=[];for(const t of this.scanPaths){const n=(await window.electronAPI.searchSoundFonts(t)).map((e=>({data:{type:"file",path:e},metadata:{name:(0,s.P)(e),scanPath:t}})));e.push(...n)}await this.storage.saveMany(e),await this.updateFileList()}async clearScannedSoundFonts(){const e=await this.storage.list(),t=Object.entries(e).filter((e=>{let[t,n]=e;return void 0!==n.scanPath&&this.scanPaths.includes(n.scanPath)})).map((e=>{let[t]=e;return Number(t)}));await this.storage.deleteMany(t)}async removeScanPath(e){await this.clearScannedSoundFonts(),this.scanPaths=this.scanPaths.filter((t=>t!==e)),this.scanSoundFonts()}async addScanPath(e){this.scanPaths.includes(e)||(this.scanPaths.push(e),await this.scanSoundFonts())}}},53603:(e,t,n)=>{n.d(t,{A:()=>h,o:()=>m});var r=n(89193),o=n(92770),s=n(61885),i=n(70480),a=n(6463),l=n(81220),c=n(28091),d=n(16541),u=n(11631);class h{rulerStore;tickScrollStore;scrollLeftTicks=0;scaleX=1;autoScroll=!0;canvasWidth=0;canvasHeight=0;quantize=4;isQuantizeEnabled=!0;mouseMode="pencil";selection=null;selectedEventIds=[];constructor(e){this.rootStore=e,this.rulerStore=new d.A(this,e.songStore),this.tickScrollStore=new u.M(this,.15,15),(0,r.Gn)(this,{scrollLeftTicks:r.sH,scaleX:r.sH,autoScroll:r.sH,canvasWidth:r.sH,canvasHeight:r.sH,quantize:r.sH,isQuantizeEnabled:r.sH,mouseMode:r.sH,selection:r.sH,selectedEventIds:r.sH,scrollLeft:r.EW,transform:r.EW,items:r.EW,cursorX:r.EW,contentWidth:r.EW,controlPoints:r.EW,selectionRect:r.EW})}setUpAutorun(){this.tickScrollStore.setUpAutoScroll()}setScrollLeftInPixels(e){this.tickScrollStore.setScrollLeftInPixels(e)}get scrollLeft(){return this.tickScrollStore.scrollLeft}get transform(){const e=o.PE.pixelsPerTick*this.scaleX;return new l.L(e,this.canvasHeight)}get cursorX(){return this.transform.getX(this.rootStore.player.position)}get items(){const{transform:e,canvasWidth:t,scrollLeft:n}=this,r=this.rootStore.song.conductorTrack?.events??[];return(0,s.i)(r,e,t+n)}get contentWidth(){return this.tickScrollStore.contentWidth}get quantizer(){return new c.A(this.rootStore,this.quantize,this.isQuantizeEnabled)}get controlPoints(){const{items:e}=this;return e.map((e=>({...m(e.bounds,4),id:e.id})))}get selectionRect(){const{selection:e,transform:t}=this;return null!=e?a.w.getBounds(e,t):null}hitTest(e){return this.controlPoints.find((t=>i.r.containsPoint(t,e)))?.id}}const m=(e,t)=>({x:e.x-t,y:e.y-t,width:2*t,height:2*t})},55610:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(89193),o=n(78193);class s{themeType="dark";constructor(){(0,r.Gn)(this,{themeType:r.sH}),(0,o.pu)(this,{name:"ThemeStore",properties:["themeType"],storage:window.localStorage})}}},11631:(e,t,n)=>{n.d(t,{M:()=>s});var r=n(17243),o=n(89193);class s{constructor(e,t,n){this.parent=e,this.minScaleX=t,this.maxScaleX=n,(0,o.Gn)(this,{scrollLeft:o.EW,playheadPosition:o.EW,playheadInScrollZone:o.EW})}get scrollLeft(){return Math.round(this.parent.transform.getX(this.parent.scrollLeftTicks))}setUpAutoScroll(){(0,o.fm)((()=>{const{autoScroll:e,rootStore:{player:t}}=this.parent,{isPlaying:n,position:r}=t,{playheadInScrollZone:o}=this;e&&n&&o&&(this.parent.scrollLeftTicks=r)}))}setScrollLeftInPixels(e){const{contentWidth:t}=this,{transform:n,canvasWidth:o}=this.parent,s=t-o,i=(0,r.clamp)(e,0,s);this.parent.scrollLeftTicks=n.getTick(i)}setScrollLeftInTicks(e){this.setScrollLeftInPixels(this.parent.transform.getX(e))}get contentWidth(){const{transform:e,canvasWidth:t}=this.parent,n=this.parent.rootStore.song.endOfSong,r=e.getTick(this.scrollLeft)+e.getTick(t);return e.getX(Math.max(n,r))}scaleAroundPointX(e,t){const{maxScaleX:n,minScaleX:o}=this,s=this.parent.transform.getTick(this.scrollLeft+t);this.parent.scaleX=(0,r.clamp)(this.parent.scaleX*(1+e),o,n);const i=this.parent.transform.getTick(this.scrollLeft+t)-s;this.setScrollLeftInTicks(this.parent.scrollLeftTicks-i)}get playheadPosition(){const{transform:e,scrollLeftTicks:t,rootStore:{player:n}}=this.parent;return e.getX(n.position-t)}get playheadInScrollZone(){const{canvasWidth:e}=this.parent;return this.playheadPosition<0||this.playheadPosition>.7*e}}},61426:(e,t,n)=>{n.d(t,{_:()=>s});var r=n(89193),o=n(45322);const s=e=>{(0,r.lB)(e.midiDeviceStore,"enabledOutputs",i(e)),(0,r.fm)(a(e)),(0,r.fm)(i(e)),(0,r.lB)(e.midiRecorder,"isRecording",l(e)),(0,r.lB)(e.player,"isPlaying",c(e))},i=e=>{let{midiDeviceStore:t,player:n,synth:r,synthGroup:s}=e;return()=>{const{outputs:e,enabledOutputs:i,isFactorySoundEnabled:a}=t;n.allSoundsOff();const l=e.map((e=>({synth:new o.A(e),isEnabled:i[e.id]})));s.outputs=[{synth:r,isEnabled:a},...l]}},a=e=>{let{midiDeviceStore:t,midiInput:n}=e;return()=>{const{inputs:e,enabledInputs:r}=t,o=e.filter((e=>r[e.id]));n.removeAllDevices(),o.forEach(n.addDevice)}},l=e=>{let{player:t,midiRecorder:n}=e;return()=>t.disableSeek=n.isRecording},c=e=>{let{player:t,midiRecorder:n}=e;return()=>{t.isPlaying||(n.isRecording=!1)}}},11051:(e,t,n)=>{n.d(t,{V:()=>r});const r=e=>{let{themeType:t}=e;switch(t){case"dark":return"Dark";case"light":return"Light";default:return"Unknown"}}},21579:(e,t,n)=>{n.d(t,{N:()=>l});var r=n(83785),o=n(69229),s=n(59061),i=n(56416),a=n(62540);const l=(0,o.PA)((e=>{let{children:t}=e;const{themeStore:n}=(0,s.g)();return(0,a.jsx)(r.a,{theme:i.Z[n.themeType],children:t})}))},74124:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(89193);function o(e,t,n){return{...e,[t]:n}}class s{mutes={};solos={};constructor(){(0,r.Gn)(this,{mutes:r.sH,solos:r.sH})}reset(){this.mutes={},this.solos={}}_setMute(e,t){this.isSoloMode()||(this.mutes=o(this.mutes,e,t))}_getMute(e){return this.mutes[e]||!1}_setSolo(e,t){this.solos=o(this.solos,e,t)}_getSolo(e){return this.solos[e]||!1}mute(e){this._setMute(e,!0)}unmute(e){this._setMute(e,!1)}solo(e){this._setSolo(e,!0)}unsolo(e){this._setSolo(e,!1)}isSoloMode(){return Object.values(this.solos).some((e=>e))}shouldPlayTrack(e){return this.isSoloMode()?this._getSolo(e):!this._getMute(e)}isSolo(e){return this.isSoloMode()&&this.solos[e]}isMuted(e){return!this.shouldPlayTrack(e)}}},11864:(e,t,n)=>{n.d(t,{A:()=>v,q:()=>f});var r=n(18264),o=n.n(r),s=n(24319),i=n.n(s),a=n(1883),l=n.n(a),c=n(89193),d=n(39013),u=n(26556),h=n(99119),m=n(6358),g=n(97983),p=n(49214),x=n(63166);n(41357);const f=-1;class v{id=(()=>f)();events=[];channel=void 0;lastEventId=0;getEventById=e=>this.events.find((t=>t.id===e));constructor(){(0,c.Gn)(this,{updateEvent:c.XI,updateEvents:c.XI,removeEvent:c.XI,removeEvents:c.XI,addEvent:c.XI,addEvents:c.XI,sortByTick:c.XI,name:c.EW,endOfTrack:c.EW,programNumber:c.EW,isConductorTrack:c.EW,isRhythmTrack:c.EW,color:c.EW,id:c.sH,events:c.sH.shallow,channel:c.sH})}_updateEvent(e,t){const n=this.events.findIndex((t=>t.id===e));if(n<0)return console.warn(`unknown id: ${e}`),null;const r=this.events[n],s={...r,...t};return o()(s,r)?null:(this.events[n]=s,s)}updateEvent(e,t){const n=this._updateEvent(e,t);return n&&this.sortByTick(),n}updateEvents(e){(0,c.Rn)((()=>{e.forEach((e=>{void 0!==e.id&&this._updateEvent(e.id,e)}))})),this.sortByTick()}removeEvent(e){this.removeEvents([e])}removeEvents(e){this.events=this.events.filter((t=>!e.includes(t.id)))}_addEvent(e){if(!("tick"in e)||isNaN(e.tick))throw new Error("invalid event is added");if("subtype"in e&&"endOfTrack"===e.subtype)throw new Error("endOfTrack event is added");const t={...i()(e,["deltaTime","channel"]),id:this.lastEventId++};return this.events.push(t),t}addEvent(e){const t=this._addEvent(e);return this.didAddEvent(),t}addEvents(e){const t=(0,c.Rn)((()=>{const t=this.isConductorTrack;return e.filter((e=>!t||"channel"!==e.type)).map((e=>this._addEvent(e)))}));return this.didAddEvent(),t}didAddEvent(){this.sortByTick()}sortByTick(){this.events=l()(this.events,"tick")}transaction(e){return(0,c.Rn)((()=>e(this)))}getRedundantEvents(e){return this.events.filter((t=>!(t.type!==e.type||t.tick!==e.tick||"subtype"in t&&"subtype"in e&&t.subtype!==e.subtype||"controllerType"in t&&"controllerType"in e&&t.controllerType!==e.controllerType)))}createOrUpdate(e){const t=this.getRedundantEvents(e);return t.length>0?(this.transaction((n=>{t.forEach((t=>{n.updateEvent(t.id,{...e,id:t.id})}))})),t[0]):this.addEvent(e)}removeRedundantEvents(e){this.removeEvents(this.getRedundantEvents(e).filter((t=>t.id!==e.id)).map((e=>e.id)))}setControllerValue=(e,t,n)=>{const r=(0,p.Ps)(this.events.filter((0,g.HG)(e)).filter((0,p.pD)(t)));void 0!==r?this.updateEvent(r.id,{value:n}):this.addEvent({type:"channel",subtype:"controller",controllerType:e,tick:0,value:n})};get name(){return(0,p.pL)(this.events)?.text}get programNumber(){return(0,p.KW)(this.events)?.value}get endOfTrack(){let e=0;for(const t of this.events){const n=(0,g.Fb)(t)?t.tick+t.duration:t.tick;e=Math.max(e,n)}return e}get color(){return this.events.filter(x.t6)[0]}setColor(e){if(null===e){const e=this.color;return void(void 0!==e&&this.removeEvent(e.id))}const t=this.color;void 0!==t?this.updateEvent(t.id,e):this.addEvent({tick:0,type:"channel",subtype:"signal",signalEventType:"trackColor",...e})}getPan=e=>(0,p.C5)(this.events,e);getVolume=e=>(0,p.v1)(this.events,e);getTempo=e=>(0,p.ge)(this.events,e);getTimeSignatureEvent=e=>(0,p._C)(this.events,e);setVolume=(e,t)=>this.setControllerValue(7,t,e);setPan=(e,t)=>this.setControllerValue(10,t,e);setProgramNumber(e){const t=(0,p.KW)(this.events);void 0!==t?this.updateEvent(t.id,{value:e}):this.addEvent({...(0,m.Ch)(0,0,e),tick:0})}setTempo(e,t){const n=(0,p.uD)(this.events,t),r=Math.floor((0,u.w4)(e));void 0!==n?this.updateEvent(n.id,{microsecondsPerBeat:r}):this.addEvent({...(0,m.F8)(0,r),tick:0})}setName(e){const t=(0,p.pL)(this.events);void 0!==t?this.updateEvent(t.id,{text:e}):this.addEvent({...(0,m.qL)(0,e),tick:0})}get isConductorTrack(){return void 0===this.channel}get isRhythmTrack(){return 9===this.channel}clone(){const e=new v;return e.channel=this.channel,e.addEvents(this.events.map((e=>({...e})))),e}}(0,d.PL)(v,{id:(0,d.MY)(),events:(0,d.p_)(h.Z),lastEventId:(0,d.MY)(),channel:(0,d.MY)()})},30453:(e,t,n)=>{n.d(t,{I:()=>o,g:()=>r});const r=e=>`rgba(${e.red}, ${e.green}, ${e.blue}, ${e.alpha/255})`,o=e=>[e.red/255,e.green/255,e.blue/255,e.alpha/255]},18240:(e,t,n)=>{n.d(t,{BQ:()=>l,bL:()=>i});var r=n(67200),o=n(6358),s=n(11864);function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const t=new s.A,n=(0,r.os)([(0,o.qL)(0,e),(0,o.BQ)(0),(0,o.F8)(0,5e5),(0,o.ly)(0)]);return t.addEvents(n),t}const a=e=>[(0,o.qZ)(0,e),(0,o.qL)(0,""),(0,o.t3)(0,e,64),(0,o.E0)(0,e,100),(0,o.GF)(0,e,127),...(0,o.Ey)(0,e),...(0,o.jq)(0,e),...(0,o.WY)(0,e,12),(0,o.fJ)(0,e,8192),(0,o.ww)(0,e,0),(0,o.Ch)(0,e,0)];function l(e){if(!Number.isInteger(e))throw new Error("channel is not integer");const t=new s.A;t.channel=e;const n=(0,r.os)([...a(e),(0,o.ly)(1)]);return t.addEvents(n),t}},97983:(e,t,n)=>{n.d(t,{D3:()=>u,Fb:()=>r,HG:()=>d,Hq:()=>c,SW:()=>h,XD:()=>o,Xz:()=>s,Y6:()=>i,c_:()=>m,u3:()=>a,y5:()=>l});const r=e=>"subtype"in e&&"note"===e.subtype,o=e=>"subtype"in e&&"trackName"===e.subtype,s=e=>"subtype"in e&&"programChange"===e.subtype,i=e=>"subtype"in e&&"pitchBend"===e.subtype,a=e=>"subtype"in e&&"setTempo"===e.subtype,l=e=>"subtype"in e&&"timeSignature"===e.subtype,c=e=>"subtype"in e&&"controller"===e.subtype,d=e=>t=>c(t)&&t.controllerType===e,u=d(7),h=d(10),m=(d(1),d(11),e=>"subtype"in e&&"sequencerSpecific"===e.subtype)},22095:(e,t,n)=>{n.d(t,{Ay:()=>o.A,BQ:()=>s.BQ,Fb:()=>r.Fb,HG:()=>r.HG,Y6:()=>r.Y6,bL:()=>s.bL,c_:()=>r.c_,ql:()=>o.q,u3:()=>r.u3,y5:()=>r.y5});var r=n(97983),o=n(11864),s=n(18240)},49214:(e,t,n)=>{n.d(t,{C5:()=>u,KW:()=>p,Ps:()=>l,_C:()=>g,_g:()=>f,ge:()=>x,pD:()=>c,pL:()=>h,uD:()=>m,v1:()=>d});var r=n(17243),o=n(13459),s=n.n(o),i=n(20604),a=n(97983);const l=e=>(0,r.maxBy)(e,(e=>e.tick)),c=e=>t=>t.tick<=e,d=(e,t)=>l(e.filter(a.D3).filter(c(t)))?.value,u=(e,t)=>l(e.filter(a.SW).filter(c(t)))?.value,h=e=>l(e.filter(a.XD)),m=(e,t)=>l(e.filter(a.u3).filter(c(t))),g=(e,t)=>l(e.filter(a.y5).filter(c(t))),p=e=>l(e.filter(a.Xz)),x=(e,t)=>{const n=m(e,t);if(void 0!==n)return 6e7/n.microsecondsPerBeat},f=(e,t)=>{const n=e.filter(a.Hq).filter(c(t));return[...s()(n.map((e=>e.controllerType))).map((e=>l(n.filter((0,a.HG)(e))))).filter(i.EA),l(e.filter(a.u3).filter(c(t))),l(e.filter(a.Xz).filter(c(t))),l(e.filter(a.Y6).filter(c(t)))].filter(i.EA)}},63166:(e,t,n)=>{n.d(t,{X6:()=>c,XS:()=>i,m0:()=>l,t6:()=>a});var r=n(17243);const o="Sign".split("").map((e=>e.charCodeAt(0)));var s=function(e){return e[e.preserved=0]="preserved",e[e.trackColor=1]="trackColor",e}(s||{});const i=e=>"subtype"in e&&"signal"===e.subtype,a=e=>i(e)&&"trackColor"===e.signalEventType,l=e=>e.data.length<=5||!(0,r.isEqual)(e.data.slice(0,4),o)?e:e.data[4]===s.trackColor?9!==e.data.length?e:{...e,subtype:"signal",signalEventType:"trackColor",alpha:e.data[5],blue:e.data[6],green:e.data[7],red:e.data[8]}:e,c=e=>{if("trackColor"===e.signalEventType)return{id:e.id,tick:e.tick,type:"meta",subtype:"sequencerSpecific",data:[...o,s.trackColor,e.alpha,e.blue,e.green,e.red]}}},41357:(e,t,n)=>{n(17243)},83537:(e,t,n)=>{n.d(t,{n:()=>s});var r=n(491),o=n(45271);const s=(e,t)=>new i(e,t);class i{firestore;functions;constructor(e,t){this.firestore=e,this.functions=t}async get(e){const t=(0,r.rJ)(this.firestore,"midis"),n=await(0,r.x7)((0,r.H9)(t,e).withConverter(a)),o=n.data()?.data;if(void 0===o)throw new Error("Midi data does not exist");return o.toUint8Array()}async storeMidiFile(e){const t=(0,o.Qg)(this.functions,"storeMidiFile");return(await t({midiFileUrl:e})).data.docId}}const a={fromFirestore:(e,t)=>e.data(t),toFirestore:e=>e}},69345:(e,t,n)=>{n.d(t,{TA:()=>o,es:()=>a});var r=n(491);const o=(e,t)=>new s(e,t);class s{firestore;auth;constructor(e,t){this.firestore=e,this.auth=t}get songDataCollection(){return a(this.firestore)}songDataRef(e){return(0,r.H9)(this.songDataCollection,e)}async create(e){if(null===this.auth.currentUser)throw new Error("You must be logged in to save songs to the cloud");const t=this.auth.currentUser.uid,n=(0,r.H9)(this.songDataCollection);return await(0,r.c4)(this.firestore,(async o=>{o.set(n,{createdAt:(0,r.O5)(),updatedAt:(0,r.O5)(),data:r.Ix.fromUint8Array(e.data),userId:t})})),n.id}async get(e){const t=this.songDataRef(e),n=await(0,r.x7)(t),o=n.data()?.data;if(void 0===o)throw new Error("Song data does not exist");return o.toUint8Array()}async update(e,t){const n=this.songDataRef(e);await(0,r.c4)(this.firestore,(async e=>{e.update(n,{updatedAt:(0,r.O5)(),data:r.Ix.fromUint8Array(t.data)})}))}async publish(e){const t=this.songDataRef(e);await(0,r.c4)(this.firestore,(async e=>{e.update(t,{isPublic:!0})}))}async unpublish(e){const t=this.songDataRef(e);await(0,r.c4)(this.firestore,(async e=>{e.update(t,{isPublic:!1})}))}async delete(e){await(0,r.c4)(this.firestore,(async t=>{t.delete(this.songDataRef(e))}))}}const i={fromFirestore:(e,t)=>e.data(t),toFirestore:e=>e},a=e=>(0,r.rJ)(e,"songData").withConverter(i)},34865:(e,t,n)=>{n.d(t,{X:()=>i});var r=n(491),o=n(69345),s=n(41862);const i=(e,t)=>new a(e,t);class a{firestore;auth;constructor(e,t){this.firestore=e,this.auth=t}get songCollection(){return d(this.firestore)}songRef(e){return(0,r.H9)(this.songCollection,e)}async get(e){const t=await(0,r.x7)(this.songRef(e));return t.exists()?l(t):null}async create(e){if(null===this.auth.currentUser)throw new Error("You must be logged in to save songs to the cloud");const t=this.auth.currentUser.uid,n=(0,r.H9)((0,o.es)(this.firestore),e.songDataId),s=(0,r.H9)(this.songCollection);return await(0,r.c4)(this.firestore,(async o=>{o.set(s,{name:e.name,createdAt:(0,r.O5)(),updatedAt:(0,r.O5)(),dataRef:n,userId:t})})),s.id}async update(e,t){const n=this.songRef(e);await(0,r.c4)(this.firestore,(async e=>{e.update(n,{updatedAt:(0,r.O5)(),name:t.name})}))}async delete(e){await(0,r.c4)(this.firestore,(async t=>{t.delete(this.songRef(e))}))}async publish(e,t){const n=this.songRef(e);await(0,r.c4)(this.firestore,(async e=>{e.update(n,{isPublic:!0,publishedAt:(0,r.O5)(),user:t})}))}async unpublish(e){const t=this.songRef(e);await(0,r.c4)(this.firestore,(async e=>{e.update(t,{isPublic:!1,publishedAt:null})}))}async getMySongs(){if(null===this.auth.currentUser)throw new Error("You must be logged in to get songs from the cloud");return(await(0,r.GG)((0,r.P)(this.songCollection,(0,r._M)("userId","==",this.auth.currentUser.uid),(0,r.My)("updatedAt","desc")))).docs.map(l)}async getPublicSongs(){const e=(0,r.P)(this.songCollection,(0,r._M)("isPublic","==",!0),(0,r.My)("publishedAt","desc"));return(await(0,r.GG)(e)).docs.map(l)}async getPublicSongsByUser(e){const t=(0,r.P)(this.songCollection,(0,r._M)("isPublic","==",!0),(0,r._M)("userId","==",e),(0,r.My)("publishedAt","desc"));return(await(0,r.GG)(t)).docs.map(l)}async incrementPlayCount(e){const t=this.songRef(e);await(0,r.c4)(this.firestore,(async e=>{e.update(t,{playCount:(0,r.GV)(1)})}))}}const l=e=>{const t=e.data();return{...t,id:e.id,songDataId:t.dataRef.id,createdAt:t.createdAt.toDate(),updatedAt:t.updatedAt.toDate(),publishedAt:t.publishedAt?.toDate(),user:t.user&&(0,s.n)(t.userId,t.user)}},c={fromFirestore:(e,t)=>e.data(t),toFirestore:e=>e},d=e=>(0,r.rJ)(e,"songs").withConverter(c)},41862:(e,t,n)=>{n.d(t,{_:()=>s,n:()=>a});var r=n(17354),o=n(491);const s=(e,t)=>new i(e,t);class i{firestore;auth;constructor(e,t){this.firestore=e,this.auth=t}get userCollection(){return(0,o.rJ)(this.firestore,"users").withConverter(c)}get userRef(){if(null===this.auth.currentUser)throw new Error("You must be logged in to get the current user");return(0,o.H9)(this.userCollection,this.auth.currentUser.uid)}async create(e){await(0,o.c4)(this.firestore,(async t=>{t.set(this.userRef,{name:e.name,bio:e.bio,createdAt:o.Dc.now(),updatedAt:o.Dc.now()})}))}async update(e){await(0,o.c4)(this.firestore,(async t=>{t.update(this.userRef,{name:e.name,bio:e.bio,updatedAt:o.Dc.now()})}))}async delete(){if(null===this.auth.currentUser)throw new Error("You must be logged in to delete the current user");await(0,o.c4)(this.firestore,(async e=>{e.delete(this.userRef)})),(0,r.hG)(this.auth.currentUser)}async getCurrentUser(){const e=await(0,o.x7)(this.userRef);return e.exists()?l(e):null}async get(e){const t=await(0,o.x7)((0,o.H9)(this.userCollection,e));return t.exists()?l(t):null}async getByUsername(e){const t=(0,o.P)(this.userCollection,(0,o._M)("name","==",e)),n=await(0,o.GG)(t);if(n.empty)return null;const r=n.docs[0];return l(r)}observeCurrentUser(e){try{return(0,o.aQ)(this.userRef,(t=>{t.exists()?e(l(t)):e(null)}))}catch(e){return console.warn(e),()=>{}}}observeAuthUser(e){return this.auth?.onAuthStateChanged((t=>{e(t)}))}}const a=(e,t)=>({id:e,name:t.name,bio:t.bio,createdAt:t.createdAt.toDate(),updatedAt:t.updatedAt.toDate()}),l=e=>{const t=e.data();return a(e.id,t)},c={fromFirestore:(e,t)=>e.data(t),toFirestore:e=>e}},69825:(e,t,n)=>{n.d(t,{TA:()=>o.TA,XW:()=>s.X,_x:()=>i._,n2:()=>r.n});var r=n(83537),o=n(69345),s=n(34865),i=n(41862)},20994:(e,t,n)=>{n.d(t,{Co:()=>r.Co,MV:()=>r.MV,QI:()=>s.QI,Vx:()=>o.Vx,dj:()=>i.dj,kc:()=>s.kc,p1:()=>o.p1,sk:()=>s.sk,sp:()=>r.sp,tE:()=>i.tE});var r=n(16829),o=n(80302),s=n(16959),i=n(45582)},16829:(e,t,n)=>{n.d(t,{Co:()=>s,MV:()=>i,sp:()=>a});var r=n(62540),o=n(63696);const s=e=>{let{children:t,component:n}=e;const[s,a]=(0,o.useState)(null);return(0,r.jsxs)(i.Provider,{value:{setDialog:a},children:[t,null!==s&&(0,r.jsx)(n,{...s})]})},i=(0,o.createContext)(null),a=()=>{const{setDialog:e}=(0,o.useContext)(i);return{show:async t=>new Promise(((n,r)=>{e({...t,callback:e=>n(e)})}))}}},80302:(e,t,n)=>{n.d(t,{Vx:()=>i,p1:()=>a});var r=n(62540),o=n(63696);const s=(0,o.createContext)(null),i=e=>{let{children:t,component:n}=e;const[i,a]=(0,o.useState)([]);return(0,r.jsxs)(s.Provider,{value:{addMessage:e=>(a((t=>[...t,e])),()=>{return t=e.key,a((e=>e.filter((e=>e.key!==t))));var t})},children:[t,i.map((e=>(0,r.jsx)(n,{open:!0,message:e.message},e.key)))]})},a=()=>{const{addMessage:e}=(0,o.useContext)(s);return{show:t=>e({message:t,key:(new Date).getTime()})}}},16959:(e,t,n)=>{n.d(t,{QI:()=>i,kc:()=>a,sk:()=>s});var r=n(62540),o=n(63696);const s=e=>{let{children:t,component:n}=e;const[s,a]=(0,o.useState)(null);return(0,r.jsxs)(i.Provider,{value:{setPrompt:a},children:[t,null!==s&&(0,r.jsx)(n,{...s})]})},i=(0,o.createContext)(null),a=()=>{const{setPrompt:e}=(0,o.useContext)(i);return{show:async t=>new Promise(((n,r)=>{e({...t,callback:e=>n(e)})}))}}},45582:(e,t,n)=>{n.d(t,{dj:()=>a,tE:()=>i});var r=n(62540),o=n(63696);const s=(0,o.createContext)(null),i=e=>{let{children:t,component:n}=e;const[i,a]=(0,o.useState)([]);return(0,r.jsxs)(s.Provider,{value:{addMessage(e){a((t=>[...t,e]))}},children:[t,i.map((e=>(0,r.jsx)(n,{message:e.message,severity:e.severity,onExited:()=>{return t=e.key,a((e=>e.filter((e=>e.key!==t))));var t}},e.key)))]})},a=()=>{const{addMessage:e}=(0,o.useContext)(s),t=(t,n)=>{e({message:t,...n,key:(new Date).getTime()})};return{show:t,info(e){t(e,{severity:"info"})},success(e){t(e,{severity:"success"})},warning(e){t(e,{severity:"warning"})},error(e){t(e,{severity:"error"})}}}},6205:(e,t,n)=>{n.d(t,{a:()=>o});var r=n(40889);class o{lookAheadTime=100;timebase=480;loop=null;_currentTick=0;_scheduledTick=0;_prevTime=void 0;_getEvents;_createLoopEndEvents;constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:480,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100;this._getEvents=e,this._createLoopEndEvents=t,this._currentTick=n,this._scheduledTick=n,this.timebase=r,this.lookAheadTime=o}get scheduledTick(){return this._scheduledTick}millisecToTick(e,t){return e/1e3*t/60*this.timebase}seek(e){this._currentTick=this._scheduledTick=Math.max(0,e)}readNextEvents(e,t){const n=n=>o=>{const s=o.tick-n;return{event:o,timestamp:t+Math.max(0,(0,r.b)(s,e,this.timebase))}},o=(e,t,r)=>this._getEvents(e,t).map(n(r));void 0===this._prevTime&&(this._prevTime=t);const s=t-this._prevTime,i=Math.max(0,this.millisecToTick(s,e)),a=this._currentTick+i,l=this.millisecToTick(this.lookAheadTime,e),c=this._scheduledTick,d=a+l;if(this._prevTime=t,null!==this.loop&&c<this.loop.end&&d>=this.loop.end){const e=this.loop,t=d-e.end,r=e.begin+t,s=e.begin-(e.end-a);return this._currentTick=s,this._scheduledTick=r,[...o(c,e.end,a),...this._createLoopEndEvents().map((t=>n(s)({...t,tick:e.begin}))),...o(e.begin,r,s)]}return this._currentTick=a,this._scheduledTick=d,o(c,d,a)}}},70467:(e,t,n)=>{function r(e,t,n,r){return{deltaTime:e,type:"channel",subtype:"controller",channel:t,controllerType:n,value:r}}n.d(t,{Q:()=>r})},94801:(e,t,n)=>{n.d(t,{a:()=>d,g:()=>c});var r=n(53649),o=n(32858),s=n(10962),i=n(89193),a=n(6205),l=n(70467);const c=120;class d{output;eventSource;scheduler=null;interval=null;_currentTempo=(()=>c)();_currentTick=0;_isPlaying=!1;disableSeek=!1;loop=null;constructor(e,t){this.output=e,this.eventSource=t,(0,i.Gn)(this,{_currentTick:i.sH,_isPlaying:i.sH,loop:i.sH,position:i.EW,isPlaying:i.EW})}play(){this.isPlaying?console.warn("called play() while playing. aborted."):(this.scheduler=new a.a(((e,t)=>this.eventSource.getEvents(e,t)),(()=>this.allNotesOffEvents()),this._currentTick,this.eventSource.timebase,100),this._isPlaying=!0,this.output.activate(),this.interval=window.setInterval((()=>this._onTimer()),50),this.output.activate())}set position(e){Number.isInteger(e)||console.warn("Player.tick should be an integer",e),this.disableSeek||(e=Math.min(Math.max(Math.floor(e),0),this.eventSource.endOfSong),this.scheduler&&this.scheduler.seek(e),this._currentTick=e,this.isPlaying&&this.allSoundsOff(),this.sendCurrentStateEvents())}get position(){return this._currentTick}get isPlaying(){return this._isPlaying}get numberOfChannels(){return 15}allSoundsOffChannel(e){this.sendEvent((0,l.Q)(0,e,s.M$.ALL_SOUNDS_OFF,0))}allSoundsOff(){for(const e of r(0,this.numberOfChannels))this.allSoundsOffChannel(e)}allSoundsOffExclude(e){for(const t of r(0,this.numberOfChannels))t!==e&&this.allSoundsOffChannel(t)}allNotesOffEvents(){return r(0,this.numberOfChannels).map((e=>({...(0,l.Q)(0,e,s.M$.ALL_NOTES_OFF,0),trackId:-1})))}resetControllers(){for(const e of r(0,this.numberOfChannels))this.sendEvent((0,l.Q)(0,e,s.M$.RESET_CONTROLLERS,127))}stop(){this.scheduler=null,this.allSoundsOff(),this._isPlaying=!1,null!==this.interval&&(clearInterval(this.interval),this.interval=null)}reset(){this.resetControllers(),this.stop(),this._currentTick=0}sendCurrentStateEvents(){this.eventSource.getCurrentStateEvents(this._currentTick).forEach((e=>{this.applyPlayerEvent(e),this.sendEvent(e)}))}get currentTempo(){return this._currentTempo}set currentTempo(e){this._currentTempo=e}sendEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:performance.now(),r=arguments.length>3?arguments[3]:void 0;this.output.sendEvent(e,t,n,r)}syncPosition=(()=>o((()=>{null!==this.scheduler&&(this._currentTick=this.scheduler.scheduledTick)}),50))();applyPlayerEvent(e){"channel"!==e.type&&"subtype"in e&&"setTempo"===e.subtype&&(this._currentTempo=6e7/e.microsecondsPerBeat)}_onTimer(){if(null===this.scheduler)return;const e=performance.now();this.scheduler.loop=null!==this.loop&&this.loop.enabled?this.loop:null,this.scheduler.readNextEvents(this._currentTempo,e).forEach((t=>{let{event:n,timestamp:r}=t;if("channel"===n.type){const t=(r-e)/1e3;this.sendEvent(n,t,e,n.trackId)}else this.applyPlayerEvent(n)})),this.scheduler.scheduledTick>=this.eventSource.endOfSong&&this.stop(),this.syncPosition()}playOrPause(){this.isPlaying?this.stop():this.play()}setLoopBegin(e){this.loop={end:Math.max(e,this.loop?.end??e),enabled:this.loop?.enabled??!1,begin:e}}setLoopEnd(e){this.loop={begin:Math.min(e,this.loop?.begin??e),enabled:this.loop?.enabled??!1,end:e}}toggleEnableLoop(){null!==this.loop&&(this.loop={...this.loop,enabled:!this.loop.enabled})}}},70012:(e,t,n)=>{n.d(t,{F:()=>o});var r=n(15172);class o{context;synth=null;_loadedSoundFontData=null;get loadedSoundFontData(){return this._loadedSoundFontData}get isLoaded(){return null!==this._loadedSoundFontData}sequenceNumber=0;constructor(e){this.context=e}async setup(){const e=new URL(n(55570),n.b);await this.context.audioWorklet.addModule(e)}async loadSoundFontFromURL(e){const t=await fetch(e),n=await t.arrayBuffer();await this.loadSoundFont(n)}async loadSoundFont(e){null!==this.synth&&this.synth.disconnect(),this.synth=new AudioWorkletNode(this.context,"synth-processor",{numberOfInputs:0,outputChannelCount:[2]}),this.synth.connect(this.context.destination),this.sequenceNumber=0;const t=(0,r.AM)(new Uint8Array(e));this._loadedSoundFontData=e;for(const e of t)this.postSynthMessage(e.event,e.transfer)}postSynthMessage(e,t){this.synth?.port.postMessage({...e,sequenceNumber:this.sequenceNumber++},t??[])}sendEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.postSynthMessage({type:"midi",midi:e,delayTime:t*this.context.sampleRate})}activate(){this.context.resume()}}},1902:(e,t,n)=>{n.d(t,{Fu:()=>o.F,ai:()=>r.a,b7:()=>s.b,gg:()=>r.g});var r=n(94801),o=n(70012),s=n(52516)},52516:(e,t,n)=>{n.d(t,{b:()=>s});var r=n(15172),o=n(94726);const s=async(e,t,n,s,i)=>{const a=(0,r.AM)(new Uint8Array(e)),l=(0,o.V)(t,n,s),c=a.map((e=>e.event)),d=await(0,r.b7)(c,l,{sampleRate:s,bufferSize:i.bufferSize,cancel:i.cancel,waitForEventLoop:i.waitForEventLoop,onProgress:i.onProgress});return(0,r.Mf)(d)}},40889:(e,t,n)=>{function r(e,t,n){return e/(n/60)/t*1e3}n.d(t,{b:()=>r})},94726:(e,t,n)=>{n.d(t,{V:()=>o});var r=n(40889);const o=(e,t,n)=>{e=e.sort(((e,t)=>e.tick-t.tick));let o={tick:0,bpm:120,timestamp:0};const s=[];for(const i of e){const e=(0,r.b)(i.tick-o.tick,o.bpm,t)+o.timestamp,a=e/1e3*n;switch(i.type){case"channel":s.push({type:"midi",midi:i,delayTime:a});case"meta":"setTempo"===i.subtype&&(o={tick:i.tick,bpm:6e7/i.microsecondsPerBeat,timestamp:e})}}return s}}},o={};function s(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={id:e,loaded:!1,exports:{}};return r[e].call(n.exports,n,n.exports,s),n.loaded=!0,n.exports}s.m=r,s.amdD=function(){throw new Error("define cannot be used indirect")},e=[],s.O=(t,n,r,o)=>{if(!n){var i=1/0;for(d=0;d<e.length;d++){n=e[d][0],r=e[d][1],o=e[d][2];for(var a=!0,l=0;l<n.length;l++)(!1&o||i>=o)&&Object.keys(s.O).every((e=>s.O[e](n[l])))?n.splice(l--,1):(a=!1,o<i&&(i=o));if(a){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[n,r,o]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var o=Object.create(null);s.r(o);var i={};t=t||[null,n({}),n([]),n(n)];for(var a=2&r&&e;"object"==typeof a&&!~t.indexOf(a);a=n(a))Object.getOwnPropertyNames(a).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,s.d(o,i),o},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{s.b=document.baseURI||self.location.href;var e={154:0};s.O.j=t=>0===e[t];var t=(t,n)=>{var r,o,i=n[0],a=n[1],l=n[2],c=0;if(i.some((t=>0!==e[t]))){for(r in a)s.o(a,r)&&(s.m[r]=a[r]);if(l)var d=l(s)}for(t&&t(n);c<i.length;c++)o=i[c],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(d)},n=self.webpackChunksignal=self.webpackChunksignal||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),s.nc=void 0;var i=s.O(void 0,[422,582,578,595],(()=>s(9357)));i=s.O(i)})();